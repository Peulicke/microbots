(this.webpackJsonpmicrobots=this.webpackJsonpmicrobots||[]).push([[0],{47:function(t,n,e){"use strict";e.r(n);var r={};e.r(r),e.d(r,"newBot",(function(){return y})),e.d(r,"setPos",(function(){return S})),e.d(r,"setWeight",(function(){return A})),e.d(r,"setFixed",(function(){return C}));var o={};e.r(o),e.d(o,"newWorld",(function(){return I})),e.d(o,"setBots",(function(){return N})),e.d(o,"edgeStrength",(function(){return D})),e.d(o,"stiffness",(function(){return W})),e.d(o,"stiffnessDerivative",(function(){return J})),e.d(o,"stiffnessPair",(function(){return R})),e.d(o,"stiffnessPairDerivative",(function(){return T})),e.d(o,"removeFixedFromVector",(function(){return q})),e.d(o,"removeFixedFromMatrix",(function(){return G})),e.d(o,"stiffnessMatrix",(function(){return H})),e.d(o,"forceMatrix",(function(){return X})),e.d(o,"displacement",(function(){return Y})),e.d(o,"compliance",(function(){return K})),e.d(o,"objective",(function(){return L})),e.d(o,"resolveCollisionStep",(function(){return Q})),e.d(o,"resolveCollision",(function(){return U})),e.d(o,"gradient",(function(){return Z})),e.d(o,"optimizeStepNumerical",(function(){return $}));var i=e(4),u=e(0),c=e.n(u),a=e(11),s=e.n(a),f=e(10),l=e(17),b=e(5),d=e(1),p=e(27),m=e(62),v=e(64),j=e(65),h=e(66),x=e(67),w=e(35),g=e(28),O=e(29),y=function(){return{pos:new d.t(0,0,0),weight:1,fixed:!1}},S=function(t){return function(n){return n.pos=t,n}},A=function(t){return function(n){return n.weight=t,n}},C=function(t){return function(n){return n.fixed=t,n}},F=function(){throw new Error("Vectors need to be the same length")},M=function(t,n){t.length!==n.length&&F();for(var e=0,r=0;r<t.length;++r)e+=t[r]*n[r];return e},z=function(t,n){var e=new d.h;return e.elements=t.elements.map((function(t,e){return t+n.elements[e]})),e},E=function(t,n){var e=new d.h;return e.elements=t.elements.map((function(t,e){return t-n.elements[e]})),e},B=function(t,n){return Object(b.a)(Array(t)).map((function(){return Object(b.a)(Array(n)).map((function(){return 0}))}))},k=function(t){var n=Object(b.a)(Array(3*t.length)).map((function(){return 0}));return t.map((function(t,e){for(var r=0;r<3;++r)n[3*e+r]=t.getComponent(r)})),n},P=e(30),I=function(){return{bots:[]}},N=function(t){return function(n){return n.bots=t,n}},V=4,D=function(t){return 2/(1+Math.exp(V*(t-1)))},W=function(t){return(n=t,e=t,n.length!==e.length&&F(),(new d.h).set(n.x*e.x,n.x*e.y,n.x*e.z,n.y*e.x,n.y*e.y,n.y*e.z,n.z*e.x,n.z*e.y,n.z*e.z)).multiplyScalar(-1/t.dot(t));var n,e},J=function(t){return function(n){var e=1e-5,r=n.getComponent(t),o=n.clone().setComponent(t,r+e),i=n.clone().setComponent(t,r-e),u=W(o).multiplyScalar(D(o.length())),c=W(i).multiplyScalar(D(i.length()));return E(u,c).multiplyScalar(1/2e-5)}},R=function(t,n){var e=n.pos.clone().sub(t.pos);return W(e).multiplyScalar(D(e.length()))},T=function(t){return function(n){return function(e,r){if(e!==t&&r!==t)return(new d.h).set(0,0,0,0,0,0,0,0,0);var o=J(n)(r.pos.clone().sub(e.pos));return e===t?o.multiplyScalar(-1):o}}},q=function(t){return function(n){return n.map((function(n,e){return t.bots[e].fixed?new d.t(0,0,0):n}))}},G=function(t){return function(n){return n.map((function(n,e){return n.map((function(n,r){return t.bots[e].fixed||t.bots[r].fixed?(new d.h).multiplyScalar(0):n}))}))}},H=function(t){for(var n=t.bots.map((function(){return t.bots.map((function(){return(new d.h).multiplyScalar(0)}))})),e=0;e<t.bots.length;++e)for(var r=0;r<t.bots.length;++r)if(e!==r){var o=R(t.bots[e],t.bots[r]);n[e][e]=E(n[e][e],o),n[e][r]=z(n[e][r],o)}return G(t)(n)},X=function(t){return q(t)(t.bots.map((function(t){return new d.t(0,-t.weight,0)})))},Y=function(t){var n,e,r=k(X(t)),o=function(t){var n,e=B(3*t.length,3*(null===(n=t[0])||void 0===n?void 0:n.length)||0);return t.map((function(n,r){return n.map((function(n,o){for(var i=0;i<3;++i)for(var u=0;u<3;++u)e[3*r+i][3*o+u]=t[r][o].elements[i+3*u]}))})),e}(H(t));return n=o,e=r,P.solve(n,e)},K=function(t){var n=k(X(t)),e=Y(t);return M(n,e)},L=function(t){return K(t)},Q=function(t){for(var n=0;n<t.bots.length;++n)t.bots[n].fixed||(t.bots[n].pos.y=Math.max(t.bots[n].pos.y,.5));for(var e=0;e<t.bots.length;++e)for(var r=e+1;r<t.bots.length;++r)if(!t.bots[e].fixed||!t.bots[r].fixed){var o=t.bots[e].fixed||t.bots[r].fixed,i=t.bots[r].pos.clone().sub(t.bots[e].pos),u=i.length();if(!(u>1)){var c=i.multiplyScalar((1-u)/(o?1:2)/u);t.bots[e].fixed||(t.bots[e].pos=t.bots[e].pos.clone().sub(c)),t.bots[r].fixed||(t.bots[r].pos=t.bots[r].pos.clone().add(c))}}return t},U=function(t){for(var n=t,e=0;e<10;++e)n=Q(n);return n},Z=function(t){for(var n=Y(t),e=Object(b.a)(Array(t.bots.length)).map((function(){return new d.t(0,0,0)})),r=Object(b.a)(Array(t.bots.length)).map((function(){return[0,1,2].map((function(){return Object(b.a)(Array(t.bots.length)).map((function(){return new d.t(0,0,0)}))}))})),o=0;o<t.bots.length;++o)for(var i=0;i<3;++i)for(var u=0;u<t.bots.length;++u)if(!(o>=u)){var c=T(t.bots[o])(i)(t.bots[o],t.bots[u]),a=Object(l.a)(d.t,Object(b.a)(n.slice(3*o,3*(o+1)))).applyMatrix3(c),s=Object(l.a)(d.t,Object(b.a)(n.slice(3*u,3*(u+1)))).applyMatrix3(c).sub(a);r[o][i][o].add(s),r[o][i][u].sub(s),r[u][i][u].add(s),r[u][i][o].sub(s)}for(var f=0;f<t.bots.length;++f)for(var p=0;p<3;++p){var m=k(q(t)(r[f][p]));e[f].setComponent(p,-M(n,m))}return e},$=function(t){return function(n){V*=1.005,console.log(V);var e=Z(n).map((function(n){return n.multiplyScalar(-t/(1+n.length()))}));return n.bots.map((function(t,n){t.fixed||t.pos.add(e[n])})),U(n)}},_=function(t,n,e){return function(r){var o,i=(new d.t).subVectors(n,t),u=new d.i;return u.lookAt(t,n,(new d.l).up),u.multiply((new d.i).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1)),r.setRotationFromMatrix(u),r.scale.set(e,i.length(),e),(o=r.position).set.apply(o,Object(b.a)(t.clone().add(n).divideScalar(2).toArray())),r}},tt=new O.a(123),nt=Object(m.a)((function(t){return{gridItem:{padding:t.spacing(2),textAlign:"center"}}})),et=[r.setFixed(!0)(r.newBot()),r.setFixed(!0)(r.setPos(new d.t(3,0,0))(r.newBot())),r.setFixed(!0)(r.setPos(new d.t(0,0,2))(r.newBot()))].concat(Object(b.a)(Object(b.a)(Array(97)).map((function(){return r.setPos(Object(l.a)(d.t,Object(b.a)([tt.next(),tt.next(),tt.next()].map((function(t){return 10*t})))))(r.newBot())})))),rt=Object(g.a)(o.newWorld(),o.setBots(et)),ot=et.map((function(t){return function(t,n){var e,r=new d.p(1,16,16);r.computeVertexNormals(),r.faces.forEach((function(t){return t.vertexColors=new Array(3).fill(!0).map((function(){return n}))}));var o=(new d.b).fromGeometry(r);delete o.attributes.uv;var i=new d.j(o,new d.k({color:n}));return i.geometry=o,(e=i.position).set.apply(e,Object(b.a)(t.toArray())),i.scale.set(.5,.5,.5),i}(t.pos,t.fixed?new d.c(0,0,1):new d.c(0,1,0))})),it=et.map((function(t){return et.map((function(n){return function(t,n,e,r){var o=new d.d(1,1,1,8,1),i=new d.j(o,new d.k({color:r}));return _(t,n,e)(i)}(t.pos,n.pos,1,new d.c(1,0,0))}))})),ut=function(){var t=new d.o;t.add(new d.a(16777215,.4));var n=new d.e(16777215,.4);return n.position.set(0,1,0),t.add(n),t}();ot.map((function(t){return ut.add(t)})),it.map((function(t,n){return t.map((function(t,e){n>=e||ut.add(t)}))}));var ct=function(){var t=Object(w.a)(),n=Object(f.a)(t,2),e=n[0],r=n[1],c=.55*e,a=.9*r,s=nt(),l=Object(u.useRef)(null),m=Object(u.useState)(),g=Object(f.a)(m,2),O=g[0],y=g[1],S=Object(u.useState)(),A=Object(f.a)(S,2),C=A[0],F=A[1],M=Object(u.useState)(),z=Object(f.a)(M,2),E=z[0],B=z[1],k=Object(u.useState)(0),P=Object(f.a)(k,2),I=P[0],N=P[1],V=Object(u.useState)(0),D=Object(f.a)(V,2),W=D[0],J=D[1];return Object(u.useEffect)((function(){var t=l.current;if(t){var n=new d.m(75,c/a,.1,1e3);n.position.set(10,10,10),n.lookAt(0,0,0),F(n);var e=new d.u({antialias:!0});e.setClearColor("#000000"),e.setSize(c,a),t.appendChild(e.domElement),B(e);var r=new p.a(n,e.domElement);r.enableDamping=!0,r.dampingFactor=.5,y(r);var o=window.setInterval((function(){return N((function(t){return t+1}))}),1e3/30);return function(){window.clearInterval(o),t.removeChild(e.domElement)}}}),[l,c,a]),Object(u.useEffect)((function(){O&&O.update(),E&&C&&E.render(ut,C)}),[O,E,C,I]),Object(u.useEffect)((function(){if(!(W>=150)){var t=setTimeout((function(){(rt=o.optimizeStepNumerical(.1)(rt)).bots.map((function(t,n){var e;(e=ot[n].position).set.apply(e,Object(b.a)(t.pos.toArray()))})),rt.bots.map((function(t,n){return rt.bots.map((function(e,r){if(!(n>=r)){ut.remove(it[n][r]);var i=o.edgeStrength(e.pos.clone().sub(t.pos).length());i<.01||(ut.add(it[n][r]),_(t.pos,e.pos,.3*Math.sqrt(i))(it[n][r]))}}))})),J(W+1)}),10);return function(){return clearTimeout(t)}}}),[W]),Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)(v.a,{container:!0,item:!0,xs:11,children:[Object(i.jsx)(v.a,{item:!0,xs:4,style:{height:.9*window.innerHeight,overflowX:"hidden",overflowY:"scroll"},children:Object(i.jsx)(v.a,{container:!0,direction:"column",children:Object(i.jsx)(v.a,{item:!0,className:s.gridItem,children:Object(i.jsx)(j.a,{children:Object(i.jsxs)(h.a,{children:[Object(i.jsx)(x.a,{children:Object(i.jsx)("b",{children:"Microbots"})}),Object(i.jsxs)(x.a,{children:[Object(i.jsx)("b",{children:"iterations: "}),W]})]})})})})}),Object(i.jsx)(v.a,{item:!0,xs:5,children:Object(i.jsx)("div",{ref:l})})]})})};s.a.render(Object(i.jsx)(c.a.StrictMode,{children:Object(i.jsx)(ct,{})}),document.getElementById("root"))}},[[47,1,2]]]);
//# sourceMappingURL=main.339a3fc1.chunk.js.map