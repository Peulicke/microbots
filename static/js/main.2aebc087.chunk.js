(this.webpackJsonpmicrobots=this.webpackJsonpmicrobots||[]).push([[0],{46:function(t,n,e){"use strict";e.r(n);var r={};e.r(r),e.d(r,"newBot",(function(){return O})),e.d(r,"setPos",(function(){return y})),e.d(r,"setWeight",(function(){return S})),e.d(r,"setFixed",(function(){return A})),e.d(r,"average",(function(){return M}));var o={};e.r(o),e.d(o,"newWorld",(function(){return V})),e.d(o,"setBots",(function(){return W})),e.d(o,"edgeStrength",(function(){return N})),e.d(o,"stiffness",(function(){return q})),e.d(o,"stiffnessDerivative",(function(){return J})),e.d(o,"stiffnessPair",(function(){return R})),e.d(o,"stiffnessPairDerivative",(function(){return G})),e.d(o,"removeFixedFromVector",(function(){return H})),e.d(o,"removeFixedFromMatrix",(function(){return T})),e.d(o,"stiffnessMatrix",(function(){return X})),e.d(o,"acceleration",(function(){return Y})),e.d(o,"forceMatrix",(function(){return K})),e.d(o,"displacement",(function(){return L})),e.d(o,"resolveCollisionStep",(function(){return Q})),e.d(o,"resolveCollision",(function(){return U})),e.d(o,"gradient",(function(){return Z}));var u={};e.r(u),e.d(u,"optimizeStepNumerical",(function(){return _})),e.d(u,"createAnimation",(function(){return nt}));var a=e(5),i=e(0),c=e.n(i),s=e(11),f=e.n(s),l=e(10),b=e(4),p=e(1),d=e(28),m=e(61),v=e(63),h=e(64),j=e(65),w=e(66),g=e(34),x=e(27),O=function(){return{pos:new p.t(0,0,0),weight:1,fixed:!1}},y=function(t){return function(n){return n.pos=t,n}},S=function(t){return function(n){return n.weight=t,n}},A=function(t){return function(n){return n.fixed=t,n}},M=function(t,n){var e=O();return e.pos=t.pos.clone().add(n.pos).divideScalar(2),e.weight=(t.weight+n.weight)/2,e.fixed=t.fixed||n.fixed,e},C=e(15),B=function(){throw new Error("Vectors need to be the same length")},z=function(t,n){t.length!==n.length&&B();for(var e=0,r=0;r<t.length;++r)e+=t[r]*n[r];return e},E=function(t,n){var e=new p.h;return e.elements=t.elements.map((function(t,e){return t+n.elements[e]})),e},P=function(t,n){var e=new p.h;return e.elements=t.elements.map((function(t,e){return t-n.elements[e]})),e},k=function(t,n){return Object(b.a)(Array(t)).map((function(){return Object(b.a)(Array(n)).map((function(){return 0}))}))},F=function(t){var n=Object(b.a)(Array(3*t.length)).map((function(){return 0}));return t.map((function(t,e){for(var r=0;r<3;++r)n[3*e+r]=t.getComponent(r)})),n},I=e(29),V=function(){return{bots:[]}},W=function(t){return function(n){return n.bots=t,n}},D=.1,N=function(t){return 2/(1+Math.exp(4*(t-1)))},q=function(t){return(n=t,e=t,n.length!==e.length&&B(),(new p.h).set(n.x*e.x,n.x*e.y,n.x*e.z,n.y*e.x,n.y*e.y,n.y*e.z,n.z*e.x,n.z*e.y,n.z*e.z)).multiplyScalar(-1/t.dot(t)).multiplyScalar(N(t.length()));var n,e},J=function(t){return function(n){var e=1e-5,r=n.getComponent(t),o=n.clone().setComponent(t,r+e),u=n.clone().setComponent(t,r-e),a=q(o),i=q(u);return P(a,i).multiplyScalar(1/2e-5)}},R=function(t,n){var e=n.pos.clone().sub(t.pos);return q(e)},G=function(t){return function(n){return function(e,r){if(e!==t&&r!==t)return(new p.h).set(0,0,0,0,0,0,0,0,0);var o=J(n)(r.pos.clone().sub(e.pos));return e===t?o.multiplyScalar(-1):o}}},H=function(t){return function(n){return n.map((function(n,e){return t.bots[e].fixed?new p.t(0,0,0):n}))}},T=function(t){return function(n){return n.map((function(n,e){return n.map((function(n,r){return t.bots[e].fixed||t.bots[r].fixed?(new p.h).multiplyScalar(0):n}))}))}},X=function(t){for(var n=t.bots.map((function(){return t.bots.map((function(){return(new p.h).multiplyScalar(0)}))})),e=0;e<t.bots.length;++e){var r=q(new p.t(t.bots[e].pos.y+.5,0,0)).multiplyScalar(D),o=q(new p.t(0,t.bots[e].pos.y+.5,0)),u=q(new p.t(0,0,t.bots[e].pos.y+.5)).multiplyScalar(D);n[e][e]=P(n[e][e],r),n[e][e]=P(n[e][e],o),n[e][e]=P(n[e][e],u)}for(var a=0;a<t.bots.length;++a)for(var i=0;i<t.bots.length;++i)if(a!==i){var c=R(t.bots[a],t.bots[i]);n[a][a]=P(n[a][a],c),n[a][i]=E(n[a][i],c)}return T(t)(n)},Y=function(t,n,e){return function(r){return r.bots.map((function(o,u){var a=r.bots[u].pos.clone().sub(t.bots[u].pos.clone()).divideScalar(e);return n.bots[u].pos.clone().sub(r.bots[u].pos.clone()).divideScalar(e).sub(a).divideScalar(e)}))}},K=function(t,n,e){return function(r){var o=Y(t,n,e)(r);return H(r)(r.bots.map((function(t,n){return new p.t(0,-1,0).sub(o[n]).multiplyScalar(t.weight)})))}},L=function(t,n,e){return function(r){var o,u,a=F(K(t,n,e)(r)),i=function(t){var n,e=k(3*t.length,3*(null===(n=t[0])||void 0===n?void 0:n.length)||0);return t.map((function(n,r){return n.map((function(n,o){for(var u=0;u<3;++u)for(var a=0;a<3;++a)e[3*r+u][3*o+a]=t[r][o].elements[u+3*a]}))})),e}(X(r));return o=i,u=a,I.solve(o,u)}},Q=function(t){for(var n=0;n<t.bots.length;++n)t.bots[n].fixed||(t.bots[n].pos.y=Math.max(t.bots[n].pos.y,.5));for(var e=0;e<t.bots.length;++e)for(var r=e+1;r<t.bots.length;++r)if(!t.bots[e].fixed||!t.bots[r].fixed){var o=t.bots[e].fixed||t.bots[r].fixed,u=t.bots[r].pos.clone().sub(t.bots[e].pos),a=u.length();if(!(a>1)){var i=u.multiplyScalar((1-a)/(o?1:2)/a);t.bots[e].fixed||(t.bots[e].pos=t.bots[e].pos.clone().sub(i)),t.bots[r].fixed||(t.bots[r].pos=t.bots[r].pos.clone().add(i))}}return t},U=function(t){for(var n=t,e=0;e<10;++e)n=Q(n);return n},Z=function(t,n,e,r,o){return function(u){for(var a=L(n,e,o)(u),i=Object(b.a)(Array(u.bots.length)).map((function(){return new p.t(0,0,0)})),c=Object(b.a)(Array(u.bots.length)).map((function(){return[0,1,2].map((function(){return Object(b.a)(Array(u.bots.length)).map((function(){return new p.t(0,0,0)}))}))})),s=0;s<u.bots.length;++s)for(var f=0;f<3;++f){var l=J(f)(new p.t(u.bots[s].pos.y+.5,0,0)).multiplyScalar(D),d=J(f)(new p.t(0,u.bots[s].pos.y+.5,0)),m=J(f)(new p.t(0,0,u.bots[s].pos.y+.5)).multiplyScalar(D),v=Object(C.a)(p.t,Object(b.a)(a.slice(3*s,3*(s+1)))).applyMatrix3(l);c[s][f][s].sub(v);var h=Object(C.a)(p.t,Object(b.a)(a.slice(3*s,3*(s+1)))).applyMatrix3(d);c[s][f][s].sub(h);var j=Object(C.a)(p.t,Object(b.a)(a.slice(3*s,3*(s+1)))).applyMatrix3(m);c[s][f][s].sub(j);for(var w=0;w<u.bots.length;++w)if(!(s>=w)){var g=G(u.bots[s])(f)(u.bots[s],u.bots[w]),x=Object(C.a)(p.t,Object(b.a)(a.slice(3*s,3*(s+1)))).applyMatrix3(g),O=Object(C.a)(p.t,Object(b.a)(a.slice(3*w,3*(w+1)))).applyMatrix3(g).sub(x);c[s][f][s].add(O),c[s][f][w].sub(O),c[w][f][w].add(O),c[w][f][s].sub(O)}}for(var y=L(t,u,o)(n),S=L(u,r,o)(e),A=0;A<u.bots.length;++A)for(var M=0;M<3;++M){var B=F(H(u)(c[A][M]));i[A].setComponent(M,-z(a,B)+(2*a[A]-y[A]-S[A])/Math.pow(o,2)*2)}return i}},$=function(t,n){var e=V();return e.bots=t.bots.map((function(t,e){return M(t,n.bots[e])})),e},_=function(t){return function(n,e,r,o,u){return function(a){var i=Z(n,e,r,o,u)(a).map((function(n){return n.multiplyScalar(-t/(1+n.length()))}));return a.bots.map((function(t,n){t.fixed||t.pos.add(i[n])})),U(a)}}},tt=function(t){for(var n=Object(b.a)(Array(2*t.length-1)),e=0;e<t.length;++e)n[2*e]=t[e];for(var r=1;r<n.length-1;r+=2)n[r]=$(n[r-1],n[r+1]);return n},nt=function(t,n,e){for(var r=[t,n],o=1e3,u=1,a=0;a<e;++a){o/=2,u/=2,r=tt(r);for(var i=0;i<10;++i){for(var c=1;c<r.length-1;c+=2)_(u)(r[Math.max(c-2,0)],r[c-1],r[c+1],r[Math.min(c+2,r.length-1)],o)(r[c]);for(var s=2;s<r.length-2;s+=2)_(u)(r[s-2],r[s-1],r[s+1],r[s+2],o)(r[s])}}return _(.1)(r[0],r[0],r[2],r[2],o)(r[1]),r},et=function(t,n,e){return function(r){var o,u=(new p.t).subVectors(n,t),a=new p.i;return a.lookAt(t,n,(new p.l).up),a.multiply((new p.i).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1)),r.setRotationFromMatrix(a),r.scale.set(e,u.length(),e),(o=r.position).set.apply(o,Object(b.a)(t.clone().add(n).divideScalar(2).toArray())),r}},rt=function(t,n,e,r){var o=new p.d(1,1,1,8,1),u=new p.j(o,new p.k({color:r}));return et(t,n,e)(u)},ot=Object(m.a)((function(t){return{gridItem:{padding:t.spacing(2),textAlign:"center"}}})),ut=Object(x.a)(o.newWorld(),o.setBots([].concat(Object(b.a)(Object(b.a)(Array(3)).map((function(t,n){return[r.setPos(new p.t(-2,.5+n,0))(r.newBot()),r.setPos(new p.t(2,.5+n,0))(r.newBot())]})).flat()),[r.setPos(new p.t(-2,3.5,0))(r.newBot())]))),at=Object(x.a)(o.newWorld(),o.setBots([].concat(Object(b.a)(Object(b.a)(Array(3)).map((function(t,n){return[r.setPos(new p.t(-2,.5+n,0))(r.newBot()),r.setPos(new p.t(2,.5+n,0))(r.newBot())]})).flat()),[r.setPos(new p.t(2,3.5,0))(r.newBot())]))),it=u.createAnimation(ut,at,8),ct=it[0].bots.map((function(t){return function(t,n){var e,r=new p.p(1,16,16);r.computeVertexNormals(),r.faces.forEach((function(t){return t.vertexColors=new Array(3).fill(!0).map((function(){return n}))}));var o=(new p.b).fromGeometry(r);delete o.attributes.uv;var u=new p.j(o,new p.k({color:n}));return u.geometry=o,(e=u.position).set.apply(e,Object(b.a)(t.toArray())),u.scale.set(.5,.5,.5),u}(t.pos,t.fixed?new p.c(0,0,1):new p.c(0,1,0))})),st=it[0].bots.map((function(t){return rt(t.pos,new p.t(t.pos.x,0,t.pos.z),1,new p.c(1,0,0))})),ft=it[0].bots.map((function(t){return it[0].bots.map((function(n){return rt(t.pos,n.pos,1,new p.c(1,0,0))}))})),lt=function(){var t=new p.o;t.add(new p.a(16777215,.4));var n=new p.e(16777215,.4);return n.position.set(0,1,0),t.add(n),t}();ct.map((function(t){return lt.add(t)})),st.map((function(t){return lt.add(t)})),ft.map((function(t,n){return t.map((function(t,e){n>=e||lt.add(t)}))}));var bt=function(){var t=Object(g.a)(),n=Object(l.a)(t,2),e=n[0],r=n[1],u=.55*e,c=.9*r,s=ot(),f=Object(i.useRef)(null),m=Object(i.useState)(),x=Object(l.a)(m,2),O=x[0],y=x[1],S=Object(i.useState)(),A=Object(l.a)(S,2),M=A[0],C=A[1],B=Object(i.useState)(),z=Object(l.a)(B,2),E=z[0],P=z[1],k=Object(i.useState)(0),F=Object(l.a)(k,2),I=F[0],V=F[1],W=Object(i.useState)(0),D=Object(l.a)(W,2),N=D[0],q=D[1],J=Object(i.useState)(!1),R=Object(l.a)(J,2),G=R[0],H=R[1];return Object(i.useEffect)((function(){var t=f.current;if(t){var n=new p.m(75,u/c,.1,1e3);n.position.set(10,10,10),n.lookAt(0,0,0),C(n);var e=new p.u({antialias:!0});e.setClearColor("#000000"),e.setSize(u,c),t.appendChild(e.domElement),P(e);var r=new d.a(n,e.domElement);r.enableDamping=!0,r.dampingFactor=.5,y(r);var o=window.setInterval((function(){return V((function(t){return t+1}))}),1e3/30);return function(){window.clearInterval(o),t.removeChild(e.domElement)}}}),[f,u,c]),Object(i.useEffect)((function(){O&&O.update(),E&&M&&E.render(lt,M)}),[O,E,M,I]),Object(i.useEffect)((function(){var t=N%(2*it.length);!function(t){it[t].bots.map((function(t,n){var e;(e=ct[n].position).set.apply(e,Object(b.a)(t.pos.toArray()))})),it[t].bots.map((function(t,n){lt.remove(st[n]);var e=o.edgeStrength(t.pos.y+.5);e<.01||(lt.add(st[n]),et(t.pos,new p.t(t.pos.x,0,t.pos.z),.3*Math.sqrt(e))(st[n]))})),it[t].bots.map((function(n,e){return it[t].bots.map((function(t,r){if(!(e>=r)){lt.remove(ft[e][r]);var u=o.edgeStrength(t.pos.clone().sub(n.pos).length());u<.01||(lt.add(ft[e][r]),et(n.pos,t.pos,.3*Math.sqrt(u))(ft[e][r]))}}))}))}(t<it.length?t:2*it.length-t-1)}),[N]),Object(i.useEffect)((function(){if(G){var t=setInterval((function(){return q((function(t){return t+1}))}),10);return function(){return clearInterval(t)}}}),[G]),Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)(v.a,{container:!0,item:!0,xs:11,children:[Object(a.jsx)(v.a,{item:!0,xs:4,style:{height:.9*window.innerHeight,overflowX:"hidden",overflowY:"scroll"},children:Object(a.jsx)(v.a,{container:!0,direction:"column",children:Object(a.jsx)(v.a,{item:!0,className:s.gridItem,children:Object(a.jsx)(h.a,{children:Object(a.jsxs)(j.a,{children:[Object(a.jsx)(w.a,{children:Object(a.jsx)("b",{children:"Microbots"})}),Object(a.jsx)(w.a,{children:Object(a.jsxs)("button",{onClick:function(){return q(N+1)},children:["Time: ",N]})}),Object(a.jsx)(w.a,{children:Object(a.jsxs)("button",{onClick:function(){return H(!G)},children:["Animating: ",G?"true":"false"]})})]})})})})}),Object(a.jsx)(v.a,{item:!0,xs:5,children:Object(a.jsx)("div",{ref:f})})]})})};f.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(bt,{})}),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.2aebc087.chunk.js.map