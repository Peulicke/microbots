{"version":3,"sources":["core/Animation.ts","core/Vec3.ts","core/Mat3.ts","core/utils.ts","core/Bot.ts","core/BoundingBox.ts","core/conjugateGradientSparse.ts","core/delaunay.ts","core/World.ts","core/PriorityQueue.ts","core/aStar.ts","core/resolveOverlap.ts","Gui/Dynamic.tsx","assets/grass.jpg","Gui/draw.ts","Gui/Canvas.tsx","examples/arc.ts","Gui/Scene.tsx","examples/utils/index.ts","examples/bigArc.ts","examples/brachiation.ts","examples/bigCube.ts","examples/box.ts","examples/crane.ts","examples/floorTransport.ts","examples/frameTransport.ts","examples/platform.ts","examples/platforms.ts","examples/platformsTall.ts","examples/transport.ts","examples/index.ts","examples/rollingBox.ts","examples/stack.ts","examples/towers.ts","examples/transformer.ts","examples/verticalTransport.ts","examples/wall.ts","Gui/SelectExample.tsx","Gui/Static.tsx","Gui/index.tsx","index.tsx"],"names":["ContractionType","newVec3","x","y","z","clone","a","add","b","addEq","sub","subEq","multiplyScalar","s","dot","length","Math","sqrt","dist","normalize","dir","min","max","i","j","apply","result","outerProduct","Vec3","bot","pos","fixed","interpolate","t","dt","p1","p2","p4","p5","v1","v2","v4","v5","t3","epsilon","t12","time","t13","t23","t24","t34","t35","t1213","t1323","t2324","t2434","t3435","t3545","c","w1","w2","w4","w5","q1","q2","q4","q5","minAcc","boundingBox","r","merge","addVecMultNum","matMultVec","A","v","conditionVector","sum","floor","ldiv","bCopy","Array","fill","preconditioner","conditionMatrix","Ap","p","pOld","rsold","alpha","rsnew","cg","orient","m","Simplex","vertices","adjacent","boundary","lastVisited","this","u","GlueFacet","cell","index","Triangulation","simplices","interior","tuple","filter","point","n","verts","toVisit","pop","undefined","cellAdj","neighbor","nv","vv","o","push","initIndex","cellVerts","prev","tovisit","indexOf","glueFacets","indexOfN","indexOfNeg1","na","vverts","slice","vadj","ncell","opposite","flip","uu","nface","nptr","k","sort","l1","m1","d","l0","m0","compareCells","ai","bi","walk","handleBoundaryDegeneracy","addPeaks","cells","nc","bcell","cv","ptr","parity","LiftedPoint","triangulate","points","lifted","upper","l","dpoints","dindex","h","hull","Error","initialSimplex","initialCoords","initialCell","list","adj","triangles","insert","incrementalConvexHull","newWorld","bots","world","map","Bot","edgeStrength","offset","slack","stiffness","stiffnessGround","Mat3","edgeStrengthGround","stiffnessDerivative","dim","val","dPlus","dMinus","plus","stiffnessMatrix","friction","neigh","sx","sy","sz","forEach","stiffnessPair","displacement","before","after","g","f","_","acc","forceMatrix","neighbors","neighborRadius","con","gradient","overlapPenalty","uBefore","uAfter","beforeBefore","afterAfter","udku","vi","stiffnessPairDerivative","vj","svisvj","diff","dest","connections","positions","rng","Prando","tri","Object","keys","key","Number","delaunay","next","BoundingBox","PriorityQueue","comparator","elements","first","peek","last","size","current","largest","left","right","compare","swap","element","parent","aux","backtrack","halfDist","prevCell","d1","w","round","grid","start","end","e","exactMidpoint","checked","check","distEstimate","iter","midpoint","equals","addToGrid","dx","dy","dz","removeFromGrid","average","anyObstacles","some","World","aStar","avg","optimize","animation","iterations","vel","grad","displacements","contract","type","validConnections","Delaunay","Mst","shift","isValidConnection","dLength","minimizeAcceleration","createAnimation","config","range","botsToGrid","tooFast","now","maxAcc","resultPrev","tf","console","log","ro","prevPos","resolveOverlap","contractIterations","contractionType","gravity","botMass","optimizeIterations","minimizeAccelerationIterations","subdivideIterations","Dynamic","props","useState","pause","setPause","path","setPath","step","worldPrev","worldEnd","reduce","value","Animation","setWorldPrev","setWorld","useEffect","setInterval","clearInterval","worldStart","List","ListItem","Button","variant","onClick","update","$set","newScene","scene","Scene","geo","PlaneBufferGeometry","textureGrass","TextureLoader","load","grass","wrapS","RepeatWrapping","wrapT","repeat","set","mat","MeshPhongMaterial","plane","Mesh","rotateX","PI","castShadow","receiveShadow","AmbientLight","light","DirectionalLight","position","shadowCameraRight","shadowCameraLeft","shadowCameraTop","shadowCameraBottom","shadowMapWidth","shadowMapHeight","screenshotRenderer","WebGLRenderer","antialias","setClearColor","setSize","shadowMapEnabled","shadowMapType","PCFSoftShadowMap","Canvas","useWindowSize","windowWidth","windowHeight","width","height","fov","setFov","mount","useRef","controls","setControls","camera","setCamera","renderer","setRenderer","zoom","setZoom","saveScreenshots","setSaveScreenshots","align","setAlign","saveImage","cam","aspect","updateProjectionMatrix","document","createElement","render","href","domElement","toDataURL","replace","download","click","mc","PerspectiveCamera","lookAt","ren","appendChild","ctrls","OrbitControls","enableDamping","dampingFactor","removeChild","window","ref","center","target","object","TextField","label","onChange","zoomNew","parseFloat","fovNew","Select","MenuItem","join","FormControlLabel","control","Switch","setScene","botMeshes","setBotMeshes","renderedWorld","setRenderedWorld","color","geom","SphereGeometry","computeVertexNormals","faces","face","vertexColors","bg","BufferGeometry","fromGeometry","attributes","uv","mesh","geometry","scale","newSphere","Color","scn","createBots","coords","createWorld","createExample","title","fixedBots","startBots","endBots","arc","angle","cos","sin","flat","pillar","barZ","platform","bar","h1","h2","abs","frame","examples","bigArc","bigCube","box","brachiation","crane","floorTransport","frameTransport","platforms","space","SelectExample","selectedExample","setSelectedExample","exampleButton","example","loadExample","ws","we","rand","onSelect","examplesNoFixed","examplesFixed","Static","setTime","setAnimation","pauseFrames","Date","useStyles","makeStyles","theme","gridItem","padding","spacing","textAlign","App","classes","setWorldStart","setWorldEnd","dynamic","setDynamic","Fibers","setConfig","worldCenter","Grid","container","item","xs","style","overflowX","overflowY","direction","fontSize","className","entries","isNaN","ReactDOM","StrictMode","Gui","getElementById"],"mappings":"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","file":"static/js/main.eae11d04.chunk.js","sourcesContent":["import * as Bot from \"./Bot\";\nimport * as Vec3 from \"./Vec3\";\nimport * as World from \"./World\";\n\nimport aStar, { Grid, botsToGrid } from \"./aStar\";\nimport resolveOverlap from \"./resolveOverlap\";\n\nconst average = (grid: Grid, start: World.World, end: World.World): World.World => {\n    const anyObstacles = start.bots.some(bot => bot.fixed);\n    const avg = (a: Bot.Bot, b: Bot.Bot): Bot.Bot => {\n        const result = Bot.clone(a);\n        if (anyObstacles) result.pos = aStar(grid, a.pos, b.pos);\n        else result.pos = Vec3.multiplyScalar(Vec3.add(a.pos, b.pos), 0.5);\n        return result;\n    };\n    const result = World.newWorld();\n    result.bots = start.bots.map((b, i) => avg(b, end.bots[i]));\n    return result;\n};\n\nconst gradient = (\n    offset: number,\n    slack: number,\n    friction: number,\n    overlapPenalty: number,\n    animation: World.World[],\n    dt: number,\n    g: number,\n    m: number,\n    neighbors: number[][][]\n): Vec3.Vec3[][] => {\n    const result = [...Array(animation.length)].map(() =>\n        [...Array(animation[0].bots.length)].map(() => Vec3.newVec3(0, 0, 0))\n    );\n    const displacements = animation.map(() => [...Array(3 * animation[0].bots.length)].map(() => 0));\n    for (let i = 0; i < animation.length; ++i) {\n        const before = animation[Math.max(i - 1, 0)];\n        const after = animation[Math.min(i + 1, animation.length - 1)];\n        displacements[i] = World.displacement(\n            offset,\n            slack,\n            friction,\n            before,\n            after,\n            dt,\n            g,\n            m,\n            animation[i],\n            neighbors[i]\n        );\n    }\n    for (let i = 1; i < animation.length; ++i) {\n        const beforeBefore = animation[Math.max(i - 2, 0)];\n        const before = animation[i - 1];\n        const after = animation[Math.min(i + 1, animation.length - 1)];\n        const afterAfter = animation[Math.min(i + 2, animation.length - 1)];\n        result[i] = World.gradient(\n            offset,\n            slack,\n            friction,\n            overlapPenalty,\n            displacements[i - 1],\n            displacements[i],\n            displacements[Math.min(i + 1, animation.length - 1)],\n            beforeBefore,\n            before,\n            after,\n            afterAfter,\n            dt,\n            animation[i],\n            neighbors[i],\n            i / (animation.length - 1)\n        );\n    }\n    return result;\n};\n\nconst optimize = (\n    offset: number,\n    slack: number,\n    friction: number,\n    overlapPenalty: number,\n    animation: World.World[],\n    dt: number,\n    g: number,\n    m: number,\n    iterations: number\n): void => {\n    const acc = 0.2 / animation.length;\n    const vel = animation.map(world => world.bots.map(() => Vec3.newVec3(0, 0, 0)));\n    const connections = animation.map(world => World.connections(world.bots.map(bot => bot.pos)));\n    const neighbors = animation.map((world, i) =>\n        world.bots.map((_, j) => World.neighbors(offset + slack / 2, world, connections[i], j))\n    );\n    for (let iter = 0; iter < iterations; ++iter) {\n        let grad = gradient(offset, slack, friction, overlapPenalty, animation, dt, g, m, neighbors);\n        grad = grad.map(world => world.map(v => Vec3.multiplyScalar(v, -acc / (1e-4 + Vec3.length(v)))));\n        animation.forEach((world, i) => {\n            if (i <= 1 || i >= animation.length - 2) return;\n            world.bots.forEach((bot, j) => {\n                vel[i][j] = Vec3.add(vel[i][j], grad[i][j]);\n                vel[i][j] = Vec3.multiplyScalar(vel[i][j], 0.9);\n                bot.pos = Vec3.add(bot.pos, vel[i][j]);\n            });\n        });\n    }\n};\n\nconst dist = (a: Bot.Bot, b: Bot.Bot): number => Vec3.length(Vec3.sub(b.pos, a.pos));\n\nexport enum ContractionType {\n    Mst,\n    Fibers,\n    Delaunay\n}\n\nconst isValidConnection = (\n    world: World.World,\n    connections: number[][],\n    i: number,\n    j: number,\n    type: ContractionType\n): boolean => {\n    if (type === ContractionType.Delaunay) return true;\n    if (type === ContractionType.Mst) {\n        if (j === -1) {\n            const d = world.bots[i].pos[1] + 0.5;\n            const checked = [...Array(world.bots.length)].map(() => false);\n            const check: number[] = [];\n            for (let k = 0; k < world.bots.length; ++k) {\n                if (world.bots[k].pos[1] + 0.5 < d) check.push(k);\n            }\n            while (check.length > 0) {\n                const k = check.shift();\n                if (k === undefined) break;\n                if (checked[k]) continue;\n                checked[k] = true;\n                for (let c = 0; c < connections[k].length; ++c) {\n                    const l = connections[k][c];\n                    if (l === -1) continue;\n                    if (Vec3.dist(world.bots[k].pos, world.bots[l].pos) < d) check.push(l);\n                }\n            }\n            return !checked[i];\n        }\n        const d = Vec3.dist(world.bots[i].pos, world.bots[j].pos);\n        const checked = [...Array(world.bots.length)].map(() => false);\n        const check: number[] = [];\n        for (let k = 0; k < world.bots.length; ++k) {\n            if (world.bots[k].pos[1] + 0.5 < d) check.push(k);\n        }\n        while (check.length > 0) {\n            const k = check.shift();\n            if (k === undefined) break;\n            if (checked[k]) continue;\n            checked[k] = true;\n            for (let c = 0; c < connections[k].length; ++c) {\n                const l = connections[k][c];\n                if (l === -1) continue;\n                if (Vec3.dist(world.bots[k].pos, world.bots[l].pos) < d) check.push(l);\n            }\n        }\n        return !(checked[i] && checked[j]);\n    }\n    if (j === -1) {\n        const a = world.bots[i];\n        return !world.bots.some((b, k) => {\n            if (i === k) return false;\n            return (\n                Vec3.dist(b.pos, [a.pos[0], -0.5, b.pos[2]]) < a.pos[1] + 0.5 &&\n                Vec3.dist(a.pos, b.pos) < a.pos[1] + 0.5\n            );\n        });\n    }\n    for (let k = 0; k < world.bots.length; ++k) {\n        if (k === i) continue;\n        if (k === j) continue;\n        if (\n            dist(world.bots[i], world.bots[j]) > world.bots[i].pos[1] + 0.5 &&\n            dist(world.bots[i], world.bots[j]) > world.bots[j].pos[1] + 0.5\n        )\n            return false;\n        if (\n            dist(world.bots[i], world.bots[j]) > dist(world.bots[i], world.bots[k]) &&\n            dist(world.bots[i], world.bots[j]) > dist(world.bots[k], world.bots[j])\n        )\n            return false;\n        if (\n            dist(world.bots[i], world.bots[j]) > dist(world.bots[j], world.bots[k]) &&\n            dist(world.bots[i], world.bots[j]) > dist(world.bots[i], world.bots[k])\n        )\n            return false;\n    }\n    return true;\n};\n\nconst contract = (world: World.World, iterations: number, type: ContractionType): void => {\n    const frac = 0.2;\n    for (let iter = 0; iter < iterations; ++iter) {\n        const connections = World.connections(world.bots.map(bot => bot.pos));\n        const validConnections: [number, number][] = [];\n        connections.forEach((list, i) => {\n            list.forEach(j => {\n                if (j !== -1 && i >= j) return;\n                if (!isValidConnection(world, connections, i, j, type)) return;\n                validConnections.push([i, j]);\n            });\n        });\n        validConnections.forEach(([i, j]) => {\n            if (j === -1) {\n                world.bots[i].pos[1] += frac * (0.5 - world.bots[i].pos[1]);\n                return;\n            }\n            const d = Vec3.sub(world.bots[j].pos, world.bots[i].pos);\n            const dLength = Vec3.length(d);\n            if (dLength < 1) return;\n            const n = Vec3.multiplyScalar(d, frac * ((1 - dLength) / dLength / 2));\n            Vec3.subEq(world.bots[i].pos, n);\n            Vec3.addEq(world.bots[j].pos, n);\n        });\n    }\n};\n\nconst minimizeAcceleration = (animation: World.World[], dt: number): void => {\n    const frac = 0.5;\n    for (let i = 2; i < animation.length - 2; ++i) {\n        animation[i].bots.forEach((bot, j) => {\n            const p = Bot.interpolate(\n                (i - 1) / (animation.length - 3),\n                dt,\n                animation[i - 2].bots[j].pos,\n                animation[i - 1].bots[j].pos,\n                animation[i + 1].bots[j].pos,\n                animation[i + 2].bots[j].pos\n            );\n            bot.pos = Vec3.add(Vec3.multiplyScalar(bot.pos, 1 - frac), Vec3.multiplyScalar(p, frac));\n        });\n    }\n};\n\nconst maxAcc = (prev: World.World, now: World.World, next: World.World, dt: number): number => {\n    let result = 0;\n    for (let i = 0; i < now.bots.length; ++i) {\n        const v1 = Vec3.multiplyScalar(Vec3.sub(now.bots[i].pos, prev.bots[i].pos), 1 / dt);\n        const v2 = Vec3.multiplyScalar(Vec3.sub(next.bots[i].pos, now.bots[i].pos), 1 / dt);\n        const a = Vec3.multiplyScalar(Vec3.sub(v2, v1), 1 / dt);\n        result = Math.max(result, Vec3.length(a));\n    }\n    return result;\n};\n\nexport type Config = {\n    subdivideIterations: number;\n    optimizeIterations: number;\n    contractionType: ContractionType;\n    contractIterations: number;\n    minimizeAccelerationIterations: number;\n    offset: number;\n    slack: number;\n    friction: number;\n    overlapPenalty: number;\n    gravity: number;\n    botMass: number;\n    dt: number;\n};\n\nexport const createAnimation = (\n    beforeBefore: World.World,\n    before: World.World,\n    after: World.World,\n    afterAfter: World.World,\n    config: Config\n): World.World[] => {\n    let result = [World.clone(beforeBefore), World.clone(before), World.clone(after), World.clone(afterAfter)];\n    const maxAccLimit = 0.2;\n    const fixed = before.bots.filter(bot => bot.fixed);\n    const grid = botsToGrid(fixed);\n    for (let iter = 0; iter < config.subdivideIterations; ++iter) {\n        const tooFast = result.map((world, i) => {\n            if (i <= 1 || i >= result.length - 1) return false;\n            return maxAcc(result[i - 1], world, result[i + 1], config.dt) > maxAccLimit;\n        });\n        if (!tooFast.some(x => x)) break;\n        const resultPrev = [...result];\n        result = [result[0]];\n        tooFast.forEach((tf, i) => {\n            if (i === 0) return;\n            if (tf) result.push(average(grid, result[result.length - 1], resultPrev[i]));\n            result.push(resultPrev[i]);\n        });\n        console.log(iter, result.length);\n        const ro = result.map(world => resolveOverlap(world.bots));\n        for (let j = 0; j < config.contractIterations; ++j) {\n            for (let i = 2; i < result.length - 2; ++i) contract(result[i], 1, config.contractionType);\n            result.map((_, k) => ro[k]());\n        }\n        optimize(\n            config.offset,\n            config.slack,\n            config.friction,\n            config.overlapPenalty,\n            result,\n            config.dt,\n            config.gravity,\n            config.botMass,\n            config.optimizeIterations\n        );\n        if (iter > 3)\n            for (let i = 0; i < config.minimizeAccelerationIterations; ++i) {\n                minimizeAcceleration(result, config.dt);\n                result.map((_, k) => ro[k]());\n            }\n        result.forEach(world =>\n            world.bots.forEach((bot, i) => {\n                if (bot.fixed) bot.pos = Vec3.clone(before.bots[i].pos);\n            })\n        );\n    }\n    console.log(\"done\");\n    return result.slice(1, result.length - 1);\n};\n","export type Vec3 = [number, number, number];\n\nexport const newVec3 = (x: number, y: number, z: number): Vec3 => [x, y, z];\n\nexport const clone = (a: Vec3): Vec3 => [a[0], a[1], a[2]];\n\nexport const add = (a: Vec3, b: Vec3): Vec3 => [a[0] + b[0], a[1] + b[1], a[2] + b[2]];\n\nexport const addEq = (a: Vec3, b: Vec3): void => {\n    a[0] += b[0];\n    a[1] += b[1];\n    a[2] += b[2];\n};\n\nexport const sub = (a: Vec3, b: Vec3): Vec3 => [a[0] - b[0], a[1] - b[1], a[2] - b[2]];\n\nexport const subEq = (a: Vec3, b: Vec3): void => {\n    a[0] -= b[0];\n    a[1] -= b[1];\n    a[2] -= b[2];\n};\n\nexport const multiplyScalar = (a: Vec3, s: number): Vec3 => [a[0] * s, a[1] * s, a[2] * s];\n\nexport const dot = (a: Vec3, b: Vec3): number => a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n\nexport const length = (a: Vec3): number => Math.sqrt(dot(a, a));\n\nexport const dist = (a: Vec3, b: Vec3): number => length(sub(a, b));\n\nexport const normalize = (a: Vec3): Vec3 => multiplyScalar(a, 1 / length(a));\n\nexport const dir = (a: Vec3, b: Vec3): Vec3 => normalize(sub(a, b));\n\nexport const min = (a: Vec3, b: Vec3): Vec3 => [Math.min(a[0], b[0]), Math.min(a[1], b[1]), Math.min(a[2], b[2])];\n\nexport const max = (a: Vec3, b: Vec3): Vec3 => [Math.max(a[0], b[0]), Math.max(a[1], b[1]), Math.max(a[2], b[2])];\n","import * as Vec3 from \"./Vec3\";\n\nexport type Mat3 = [Vec3.Vec3, Vec3.Vec3, Vec3.Vec3];\n\nexport const newMat3 = (x: Vec3.Vec3, y: Vec3.Vec3, z: Vec3.Vec3): Mat3 => [x, y, z];\n\nexport const add = (a: Mat3, b: Mat3): void => {\n    for (let i = 0; i < 3; ++i) {\n        for (let j = 0; j < 3; ++j) {\n            a[i][j] += b[i][j];\n        }\n    }\n};\n\nexport const sub = (a: Mat3, b: Mat3): void => {\n    for (let i = 0; i < 3; ++i) {\n        for (let j = 0; j < 3; ++j) {\n            a[i][j] -= b[i][j];\n        }\n    }\n};\n\nexport const multiplyScalar = (a: Mat3, s: number): void => {\n    for (let i = 0; i < 3; ++i) {\n        for (let j = 0; j < 3; ++j) {\n            a[i][j] *= s;\n        }\n    }\n};\n\nexport const apply = (a: Mat3, b: Vec3.Vec3): Vec3.Vec3 => {\n    const result: Vec3.Vec3 = [0, 0, 0];\n    for (let i = 0; i < 3; ++i) {\n        for (let j = 0; j < 3; ++j) {\n            result[i] += a[i][j] * b[j];\n        }\n    }\n    return result;\n};\n","import * as Mat3 from \"./Mat3\";\nimport * as Vec3 from \"./Vec3\";\n\ntype Spacetime = {\n    pos: Vec3.Vec3;\n    time: number;\n};\n\nexport const outerProduct = (a: Vec3.Vec3, b: Vec3.Vec3): Mat3.Mat3 =>\n    Mat3.newMat3(\n        Vec3.newVec3(a[0] * b[0], a[0] * b[1], a[0] * b[2]),\n        Vec3.newVec3(a[1] * b[0], a[1] * b[1], a[1] * b[2]),\n        Vec3.newVec3(a[2] * b[0], a[2] * b[1], a[2] * b[2])\n    );\n\nexport const minAcc = (v1: Spacetime, v2: Spacetime, v4: Spacetime, v5: Spacetime, t3: number): Vec3.Vec3 => {\n    const epsilon = 1e-10;\n    const t12 = v2.time - v1.time;\n    const t13 = t3 - v1.time;\n    const t23 = t3 - v2.time;\n    const t24 = v4.time - v2.time;\n    const t34 = v4.time - t3;\n    const t35 = v5.time - t3;\n    const t45 = v5.time - v4.time;\n    const t1213 = t12 * t13 + epsilon;\n    const t1323 = t13 * t23 + epsilon;\n    const t2324 = t23 * t24 + epsilon;\n    const t2434 = t24 * t34 + epsilon;\n    const t3435 = t34 * t35 + epsilon;\n    const t3545 = t35 * t45 + epsilon;\n    const c = 1 / (t2434 * t2324);\n    const a = c + 1 / t1323 ** 2 + 1 / t2324 ** 2;\n    const b = c + 1 / t2434 ** 2 + 1 / t3435 ** 2;\n    const w1 = -1 / (t1213 * t1323 * (a + b));\n    const w2 = (a + 1 / (t1213 * t1323)) / (a + b);\n    const w4 = (b + 1 / (t3435 * t3545)) / (a + b);\n    const w5 = -1 / (t3435 * t3545 * (a + b));\n    const q1 = Vec3.multiplyScalar(v1.pos, w1);\n    const q2 = Vec3.multiplyScalar(v2.pos, w2);\n    const q4 = Vec3.multiplyScalar(v4.pos, w4);\n    const q5 = Vec3.multiplyScalar(v5.pos, w5);\n    const p3 = Vec3.add(Vec3.add(Vec3.add(q1, q2), q4), q5);\n    return p3;\n};\n","import * as BoundingBox from \"./BoundingBox\";\nimport * as Vec3 from \"./Vec3\";\n\nimport { minAcc } from \"./utils\";\n\nexport type Bot = {\n    pos: Vec3.Vec3;\n    fixed: boolean;\n};\n\nexport const clone = (bot: Bot): Bot => ({ pos: Vec3.clone(bot.pos), fixed: bot.fixed });\n\nexport const interpolate = (\n    t: number,\n    dt: number,\n    p1: Vec3.Vec3,\n    p2: Vec3.Vec3,\n    p4: Vec3.Vec3,\n    p5: Vec3.Vec3\n): Vec3.Vec3 =>\n    minAcc(\n        { pos: p1, time: t - 2 * dt },\n        { pos: p2, time: t - dt },\n        { pos: p4, time: t + dt },\n        { pos: p5, time: t + 2 * dt },\n        t\n    );\n\nexport const boundingBox = (bot: Bot): BoundingBox.BoundingBox => {\n    const r: Vec3.Vec3 = [0.5, 0.5, 0.5];\n    return {\n        min: Vec3.sub(bot.pos, r),\n        max: Vec3.add(bot.pos, r)\n    };\n};\n","import * as Vec3 from \"./Vec3\";\n\nexport type BoundingBox = {\n    min: Vec3.Vec3;\n    max: Vec3.Vec3;\n};\n\nexport const merge = (a: BoundingBox, b: BoundingBox): BoundingBox => ({\n    min: Vec3.min(a.min, b.min),\n    max: Vec3.max(a.max, b.max)\n});\n","export type SparseSymmetric = [number, number][][];\n\nconst clone = (a: number[], result: number[]): void => {\n    for (let i = 0; i < a.length; ++i) result[i] = a[i];\n};\n\nconst dot = (a: number[], b: number[]): number => {\n    let result = 0;\n    for (let i = 0; i < a.length; ++i) {\n        result += a[i] * b[i];\n    }\n    return result;\n};\n\nconst addVecMultNum = (a: number[], b: number[], c: number): void => {\n    for (let i = 0; i < a.length; ++i) a[i] += b[i] * c;\n};\n\nconst matMultVec = (A: SparseSymmetric, b: number[], result: number[]): void => {\n    for (let i = 0; i < result.length; ++i) result[i] = 0;\n    for (let i = 0; i < A.length; ++i) {\n        for (let c = 0; c < A[i].length; ++c) {\n            const j = A[i][c][0];\n            const v = A[i][c][1];\n            result[i] += v * b[j];\n            if (i === j) continue;\n            result[j] += v * b[i];\n        }\n    }\n};\n\nconst cg = (A: SparseSymmetric, b: number[]): number[] => {\n    const x = Array(b.length).fill(0);\n    const r = Array(b.length);\n    clone(b, r);\n    const Ap = Array(b.length);\n    matMultVec(A, x, Ap);\n    addVecMultNum(r, Ap, -1);\n    const p = Array(r.length);\n    const pOld = Array(p.length);\n    clone(r, p);\n    let rsold = dot(r, r);\n    for (let i = 0; i < 20; ++i) {\n        matMultVec(A, p, Ap);\n        const alpha = rsold / dot(p, Ap);\n        addVecMultNum(x, p, alpha);\n        addVecMultNum(r, Ap, -alpha);\n        const rsnew = dot(r, r);\n        clone(p, pOld);\n        clone(r, p);\n        addVecMultNum(p, pOld, rsnew / rsold);\n        rsold = rsnew;\n    }\n    return x;\n};\n\nconst preconditioner = (A: SparseSymmetric, b: number[]): number[] => {\n    const sum = Array(b.length / 3).fill(0);\n    for (let i = 0; i < A.length; ++i) {\n        for (let c = 0; c < A[i].length; ++c) {\n            const [j, v] = A[i][c];\n            if (Math.floor(i / 3) !== Math.floor(j / 3)) continue;\n            sum[Math.floor(i / 3)] += v;\n            if (i === j) continue;\n            sum[Math.floor(j / 3)] += v;\n        }\n    }\n    for (let i = 0; i < sum.length; ++i) sum[i] = Math.sqrt(Math.sqrt(3 / sum[i]));\n    return sum;\n};\n\nconst conditionMatrix = (sum: number[], A: SparseSymmetric): void => {\n    for (let i = 0; i < A.length; ++i) {\n        for (let c = 0; c < A[i].length; ++c) {\n            const j = A[i][c][0];\n            A[i][c][1] *= sum[Math.floor(i / 3)];\n            A[i][c][1] *= sum[Math.floor(j / 3)];\n        }\n    }\n};\n\nconst conditionVector = (sum: number[], b: number[]): void => {\n    for (let i = 0; i < b.length; ++i) {\n        b[i] *= sum[Math.floor(i / 3)];\n    }\n};\n\nexport const ldiv = (A: SparseSymmetric, b: number[]): number[] => {\n    const bCopy = Array(b.length);\n    clone(b, bCopy);\n    const sum = preconditioner(A, bCopy);\n    conditionMatrix(sum, A);\n    conditionVector(sum, bCopy);\n    const x = cg(A, bCopy);\n    conditionVector(sum, x);\n    return x;\n};\n","const orient = (m: number[][]) =>\n    ((m[3][1] * m[4][0] - m[4][1] * m[3][0]) * m[2][2] +\n        (m[2][1] * m[4][0] - m[4][1] * m[2][0]) * -m[3][2] +\n        (m[2][1] * m[3][0] - m[3][1] * m[2][0]) * m[4][2]) *\n        m[1][3] +\n    ((m[3][1] * m[4][0] - m[4][1] * m[3][0]) * m[1][2] +\n        (m[1][1] * m[4][0] - m[4][1] * m[1][0]) * -m[3][2] +\n        (m[1][1] * m[3][0] - m[3][1] * m[1][0]) * m[4][2]) *\n        -m[2][3] +\n    ((m[2][1] * m[4][0] - m[4][1] * m[2][0]) * m[1][2] +\n        (m[1][1] * m[4][0] - m[4][1] * m[1][0]) * -m[2][2] +\n        (m[1][1] * m[2][0] - m[2][1] * m[1][0]) * m[4][2]) *\n        m[3][3] +\n    ((m[2][1] * m[3][0] - m[3][1] * m[2][0]) * m[1][2] +\n        (m[1][1] * m[3][0] - m[3][1] * m[1][0]) * -m[2][2] +\n        (m[1][1] * m[2][0] - m[2][1] * m[1][0]) * m[3][2]) *\n        -m[4][3] +\n    ((m[3][1] * m[4][0] - m[4][1] * m[3][0]) * m[1][2] +\n        (m[1][1] * m[4][0] - m[4][1] * m[1][0]) * -m[3][2] +\n        (m[1][1] * m[3][0] - m[3][1] * m[1][0]) * m[4][2]) *\n        m[0][3] +\n    ((m[3][1] * m[4][0] - m[4][1] * m[3][0]) * m[0][2] +\n        (m[0][1] * m[4][0] - m[4][1] * m[0][0]) * -m[3][2] +\n        (m[0][1] * m[3][0] - m[3][1] * m[0][0]) * m[4][2]) *\n        -m[1][3] +\n    (((m[1][1] * m[4][0] - m[4][1] * m[1][0]) * m[0][2] +\n        (m[0][1] * m[4][0] - m[4][1] * m[0][0]) * -m[1][2] +\n        (m[0][1] * m[1][0] - m[1][1] * m[0][0]) * m[4][2]) *\n        m[3][3] +\n        ((m[1][1] * m[3][0] - m[3][1] * m[1][0]) * m[0][2] +\n            (m[0][1] * m[3][0] - m[3][1] * m[0][0]) * -m[1][2] +\n            (m[0][1] * m[1][0] - m[1][1] * m[0][0]) * m[3][2]) *\n            -m[4][3] +\n        ((m[2][1] * m[3][0] - m[3][1] * m[2][0]) * m[1][2] +\n            (m[1][1] * m[3][0] - m[3][1] * m[1][0]) * -m[2][2] +\n            (m[1][1] * m[2][0] - m[2][1] * m[1][0]) * m[3][2]) *\n            m[0][3] +\n        ((m[2][1] * m[3][0] - m[3][1] * m[2][0]) * m[0][2] +\n            (m[0][1] * m[3][0] - m[3][1] * m[0][0]) * -m[2][2] +\n            (m[0][1] * m[2][0] - m[2][1] * m[0][0]) * m[3][2]) *\n            -m[1][3] +\n        ((m[1][1] * m[3][0] - m[3][1] * m[1][0]) * m[0][2] +\n            (m[0][1] * m[3][0] - m[3][1] * m[0][0]) * -m[1][2] +\n            (m[0][1] * m[1][0] - m[1][1] * m[0][0]) * m[3][2]) *\n            m[2][3] +\n        ((m[1][1] * m[2][0] - m[2][1] * m[1][0]) * m[0][2] +\n            (m[0][1] * m[2][0] - m[2][1] * m[0][0]) * -m[1][2] +\n            (m[0][1] * m[1][0] - m[1][1] * m[0][0]) * m[2][2]) *\n            -m[3][3]) -\n    (((m[3][1] * m[4][0] - m[4][1] * m[3][0]) * m[2][2] +\n        (m[2][1] * m[4][0] - m[4][1] * m[2][0]) * -m[3][2] +\n        (m[2][1] * m[3][0] - m[3][1] * m[2][0]) * m[4][2]) *\n        m[0][3] +\n        ((m[3][1] * m[4][0] - m[4][1] * m[3][0]) * m[0][2] +\n            (m[0][1] * m[4][0] - m[4][1] * m[0][0]) * -m[3][2] +\n            (m[0][1] * m[3][0] - m[3][1] * m[0][0]) * m[4][2]) *\n            -m[2][3] +\n        (((m[2][1] * m[4][0] - m[4][1] * m[2][0]) * m[0][2] +\n            (m[0][1] * m[4][0] - m[4][1] * m[0][0]) * -m[2][2] +\n            (m[0][1] * m[2][0] - m[2][1] * m[0][0]) * m[4][2]) *\n            m[3][3] +\n            ((m[2][1] * m[3][0] - m[3][1] * m[2][0]) * m[0][2] +\n                (m[0][1] * m[3][0] - m[3][1] * m[0][0]) * -m[2][2] +\n                (m[0][1] * m[2][0] - m[2][1] * m[0][0]) * m[3][2]) *\n                -m[4][3]) +\n        (((m[2][1] * m[4][0] - m[4][1] * m[2][0]) * m[1][2] +\n            (m[1][1] * m[4][0] - m[4][1] * m[1][0]) * -m[2][2] +\n            (m[1][1] * m[2][0] - m[2][1] * m[1][0]) * m[4][2]) *\n            m[0][3] +\n            ((m[2][1] * m[4][0] - m[4][1] * m[2][0]) * m[0][2] +\n                (m[0][1] * m[4][0] - m[4][1] * m[0][0]) * -m[2][2] +\n                (m[0][1] * m[2][0] - m[2][1] * m[0][0]) * m[4][2]) *\n                -m[1][3] +\n            (((m[1][1] * m[4][0] - m[4][1] * m[1][0]) * m[0][2] +\n                (m[0][1] * m[4][0] - m[4][1] * m[0][0]) * -m[1][2] +\n                (m[0][1] * m[1][0] - m[1][1] * m[0][0]) * m[4][2]) *\n                m[2][3] +\n                ((m[1][1] * m[2][0] - m[2][1] * m[1][0]) * m[0][2] +\n                    (m[0][1] * m[2][0] - m[2][1] * m[0][0]) * -m[1][2] +\n                    (m[0][1] * m[1][0] - m[1][1] * m[0][0]) * m[2][2]) *\n                    -m[4][3])));\n\n//Ranks a pair of cells up to permutation\nconst compareCells = (a: number[], b: number[]) => {\n    const l1 = a[0] + a[1];\n    const m1 = b[0] + b[1];\n    let d = l1 + a[2] - (m1 + b[2]);\n    if (d) return d;\n    const l0 = Math.min(a[0], a[1]);\n    const m0 = Math.min(b[0], b[1]);\n    d = Math.min(l0, a[2]) - Math.min(m0, b[2]);\n    if (d) return d;\n    return Math.min(l0 + a[2], l1) - Math.min(m0 + b[2], m1);\n};\n\nclass Simplex {\n    vertices: number[];\n    adjacent: Simplex[];\n    boundary: boolean;\n    lastVisited: number;\n    constructor(vertices: number[], adjacent: Simplex[], boundary: boolean) {\n        this.vertices = vertices;\n        this.adjacent = adjacent;\n        this.boundary = boundary;\n        this.lastVisited = -1;\n    }\n    flip() {\n        const t = this.vertices[0];\n        this.vertices[0] = this.vertices[1];\n        this.vertices[1] = t;\n        const u = this.adjacent[0];\n        this.adjacent[0] = this.adjacent[1];\n        this.adjacent[1] = u;\n    }\n}\n\nclass GlueFacet {\n    vertices: number[];\n    cell: Simplex;\n    index: number;\n    constructor(vertices: number[], cell: Simplex, index: number) {\n        this.vertices = vertices;\n        this.cell = cell;\n        this.index = index;\n    }\n}\n\nclass Triangulation {\n    vertices: number[][];\n    simplices: Simplex[];\n    interior: Simplex[];\n    tuple: number[][];\n    orient: () => number;\n    constructor(vertices: number[][], simplices: Simplex[]) {\n        this.vertices = vertices;\n        this.simplices = simplices;\n        this.interior = simplices.filter(c => !c.boundary);\n        this.tuple = [...this.vertices];\n        this.orient = () => orient(this.tuple);\n    }\n    handleBoundaryDegeneracy(cell: Simplex, point: number[]) {\n        const d = 4;\n        const n = this.vertices.length - 1;\n        const tuple = this.tuple;\n        const verts = this.vertices;\n        const toVisit = [cell];\n        cell.lastVisited = -n;\n        while (toVisit.length > 0) {\n            const c = toVisit.pop();\n            if (c === undefined) break;\n            const cellAdj = c.adjacent;\n            for (let i = 0; i <= d; ++i) {\n                const neighbor = cellAdj[i];\n                if (!neighbor.boundary || neighbor.lastVisited <= -n) continue;\n                const nv = neighbor.vertices;\n                for (let j = 0; j <= d; ++j) {\n                    const vv = nv[j];\n                    if (vv < 0) tuple[j] = point;\n                    else tuple[j] = verts[vv];\n                }\n                const o = this.orient();\n                if (o > 0) return neighbor;\n                neighbor.lastVisited = -n;\n                if (o === 0) toVisit.push(neighbor);\n            }\n        }\n        return null;\n    }\n    walk(point: number[]) {\n        //Alias local properties\n        const n = this.vertices.length - 1;\n        const verts = this.vertices;\n        const tuple = this.tuple;\n\n        //Compute initial jump cell\n        const initIndex = this.interior.length - 1;\n        let cell = this.interior[initIndex];\n\n        //Start walking\n        while (!cell.boundary) {\n            const cellVerts = cell.vertices;\n            const cellAdj = cell.adjacent;\n\n            for (let i = 0; i <= 4; ++i) {\n                tuple[i] = verts[cellVerts[i]];\n            }\n            cell.lastVisited = n;\n\n            //Find farthest adjacent cell\n            for (let i = 0; i <= 4; ++i) {\n                const neighbor = cellAdj[i];\n                if (neighbor.lastVisited >= n) continue;\n                const prev = tuple[i];\n                tuple[i] = point;\n                const o = this.orient();\n                tuple[i] = prev;\n                if (o < 0) {\n                    cell = neighbor;\n                    break;\n                }\n                if (neighbor.boundary) neighbor.lastVisited = -n;\n                else neighbor.lastVisited = n;\n            }\n        }\n\n        return cell;\n    }\n    addPeaks(point: number[], cell: Simplex) {\n        const n = this.vertices.length - 1;\n        const verts = this.vertices;\n        const tuple = this.tuple;\n        const interior = this.interior;\n        const simplices = this.simplices;\n\n        //Walking finished at boundary, time to add peaks\n        const tovisit = [cell];\n\n        //Stretch initial boundary cell into a peak\n        cell.lastVisited = n;\n        cell.vertices[cell.vertices.indexOf(-1)] = n;\n        cell.boundary = false;\n        interior.push(cell);\n\n        //Record a list of all new boundaries created by added peaks so we can glue them together when we are all done\n        const glueFacets = [];\n\n        //Do a traversal of the boundary walking outward from starting peak\n        while (tovisit.length > 0) {\n            const c = tovisit.pop();\n            if (c === undefined) break;\n            //Pop off peak and walk over adjacent cells\n            const cellVerts = c.vertices;\n            const cellAdj = c.adjacent;\n            const indexOfN = cellVerts.indexOf(n);\n            if (indexOfN < 0) continue;\n\n            for (let i = 0; i <= 4; ++i) {\n                if (i === indexOfN) continue;\n\n                //For each boundary neighbor of the cell\n                const neighbor = cellAdj[i];\n                if (!neighbor.boundary || neighbor.lastVisited >= n) continue;\n\n                const nv = neighbor.vertices;\n\n                //Test if neighbor is a peak\n                if (neighbor.lastVisited !== -n) {\n                    //Compute orientation of p relative to each boundary peak\n                    let indexOfNeg1 = 0;\n                    for (let j = 0; j <= 4; ++j) {\n                        if (nv[j] < 0) {\n                            indexOfNeg1 = j;\n                            tuple[j] = point;\n                        } else tuple[j] = verts[nv[j]];\n                    }\n                    const o = this.orient();\n\n                    //Test if neighbor cell is also a peak\n                    if (o > 0) {\n                        nv[indexOfNeg1] = n;\n                        neighbor.boundary = false;\n                        interior.push(neighbor);\n                        tovisit.push(neighbor);\n                        neighbor.lastVisited = n;\n                        continue;\n                    }\n                    neighbor.lastVisited = -n;\n                }\n\n                const na = neighbor.adjacent;\n\n                //Otherwise, replace neighbor with new face\n                const vverts = cellVerts.slice();\n                const vadj = cellAdj.slice();\n                const ncell = new Simplex(vverts, vadj, true);\n                simplices.push(ncell);\n\n                //Connect to neighbor\n                const opposite = na.indexOf(c);\n                if (opposite < 0) continue;\n\n                na[opposite] = ncell;\n                vadj[indexOfN] = neighbor;\n\n                //Connect to cell\n                vverts[i] = -1;\n                vadj[i] = c;\n                cellAdj[i] = ncell;\n\n                //Flip facet\n                ncell.flip();\n\n                //Add to glue list\n                for (let j = 0; j <= 4; ++j) {\n                    const uu = vverts[j];\n                    if (uu < 0 || uu === n) continue;\n                    const nface = new Array(3);\n                    let nptr = 0;\n                    for (let k = 0; k <= 4; ++k) {\n                        const vv = vverts[k];\n                        if (vv < 0 || k === j) continue;\n                        nface[nptr++] = vv;\n                    }\n                    glueFacets.push(new GlueFacet(nface, ncell, j));\n                }\n            }\n        }\n\n        //Glue boundary facets together\n        glueFacets.sort((a, b) => compareCells(a.vertices, b.vertices));\n\n        for (let i = 0; i + 1 < glueFacets.length; i += 2) {\n            const a = glueFacets[i];\n            const b = glueFacets[i + 1];\n            const ai = a.index;\n            const bi = b.index;\n            if (ai < 0 || bi < 0) continue;\n            a.cell.adjacent[a.index] = b.cell;\n            b.cell.adjacent[b.index] = a.cell;\n        }\n    }\n    insert(point: number[]) {\n        //Add point\n        const verts = this.vertices;\n        verts.push(point);\n\n        let cell = this.walk(point);\n        if (!cell) return;\n\n        //Alias local properties\n        const tuple = this.tuple;\n\n        //Degenerate case: If point is coplanar to cell, then walk until we find a non-degenerate boundary\n        for (let i = 0; i <= 4; ++i) {\n            const vv = cell.vertices[i];\n            if (vv < 0) tuple[i] = point;\n            else tuple[i] = verts[vv];\n        }\n        const o = this.orient();\n        if (o < 0) return;\n        if (o === 0) {\n            const c = this.handleBoundaryDegeneracy(cell, point);\n            if (!c) return;\n            cell = c;\n        }\n\n        //Add peaks\n        this.addPeaks(point, cell);\n    }\n    boundary() {\n        const d = 4;\n        const boundary = [];\n        const cells = this.simplices;\n        const nc = cells.length;\n        for (let i = 0; i < nc; ++i) {\n            const c = cells[i];\n            if (c.boundary) {\n                const bcell = new Array(d);\n                const cv = c.vertices;\n                let ptr = 0;\n                let parity = 0;\n                for (let j = 0; j <= d; ++j) {\n                    if (cv[j] >= 0) {\n                        bcell[ptr++] = cv[j];\n                    } else {\n                        parity = j && 1;\n                    }\n                }\n                if (parity === (d && 1)) {\n                    const t = bcell[0];\n                    bcell[0] = bcell[1];\n                    bcell[1] = t;\n                }\n                boundary.push(bcell);\n            }\n        }\n        return boundary;\n    }\n}\n\nconst incrementalConvexHull = (points: number[][]) => {\n    const n = points.length;\n    if (n === 0) {\n        throw new Error(\"Must have at least d+1 points\");\n    }\n    const d = points[0].length;\n    if (n <= d) {\n        throw new Error(\"Must input at least d+1 points\");\n    }\n\n    const initialSimplex = points.slice(0, d + 1);\n\n    //Make sure initial simplex is positively oriented\n    const o = orient(initialSimplex);\n    if (o === 0) {\n        throw new Error(\"Input not in general position\");\n    }\n    const initialCoords = new Array(d + 1);\n    for (let i = 0; i <= d; ++i) {\n        initialCoords[i] = i;\n    }\n    if (o < 0) {\n        initialCoords[0] = 1;\n        initialCoords[1] = 0;\n    }\n\n    //Create initial topological index, glue pointers together (kind of messy)\n    const initialCell = new Simplex(initialCoords, new Array(d + 1), false);\n    const boundary = initialCell.adjacent;\n    const list = new Array(d + 2);\n    for (let i = 0; i <= d; ++i) {\n        const verts = initialCoords.slice();\n        for (let j = 0; j <= d; ++j) {\n            if (j === i) verts[j] = -1;\n        }\n        const t = verts[0];\n        verts[0] = verts[1];\n        verts[1] = t;\n        const cell = new Simplex(verts, new Array(d + 1), true);\n        boundary[i] = cell;\n        list[i] = cell;\n    }\n    list[d + 1] = initialCell;\n    for (let i = 0; i <= d; ++i) {\n        const verts = boundary[i].vertices;\n        const adj = boundary[i].adjacent;\n        for (let j = 0; j <= d; ++j) {\n            const v = verts[j];\n            if (v < 0) {\n                adj[j] = initialCell;\n                continue;\n            }\n            for (let k = 0; k <= d; ++k) {\n                if (boundary[k].vertices.indexOf(v) < 0) {\n                    adj[j] = boundary[k];\n                }\n            }\n        }\n    }\n\n    //Initialize triangles\n    const triangles = new Triangulation(initialSimplex, list);\n\n    //Insert remaining points\n    for (let i = d + 1; i < n; ++i) {\n        triangles.insert(points[i]);\n    }\n\n    //Extract boundary cells\n    return triangles.boundary();\n};\n\nclass LiftedPoint {\n    point: number[];\n    index: number;\n    constructor(p: number[], i: number) {\n        this.point = p;\n        this.index = i;\n    }\n}\n\nconst triangulate = (points: number[][]) => {\n    let n = points.length;\n    if (n === 0) return [];\n\n    //Lift points, sort\n    const lifted = new Array(n);\n    let upper = 1.0;\n    for (let i = 0; i < n; ++i) {\n        const p = points[i];\n        const x = new Array(3 + 1);\n        let l = 0.0;\n        for (let j = 0; j < 3; ++j) {\n            const v = p[j];\n            x[j] = v;\n            l += v * v;\n        }\n        x[3] = l;\n        lifted[i] = new LiftedPoint(x, i);\n        upper = Math.max(l, upper);\n    }\n    lifted.sort((a, b) => {\n        for (let i = 0; i < 5; ++i) {\n            const s = b.point[i] - a.point[i];\n            if (s) return s;\n        }\n        return 0;\n    });\n\n    //Double points\n    n = lifted.length;\n\n    //Create new list of points\n    const dpoints = new Array(n + 3 + 1);\n    const dindex = new Array(n + 3 + 1);\n\n    //Add steiner points at top\n    const u = (3 + 1) * (3 + 1) * upper;\n    const y = new Array(3 + 1);\n    for (let i = 0; i <= 3; ++i) {\n        y[i] = 0.0;\n    }\n    y[3] = u;\n\n    dpoints[0] = y.slice();\n    dindex[0] = -1;\n\n    for (let i = 0; i <= 3; ++i) {\n        const x = y.slice();\n        x[i] = 1;\n        dpoints[i + 1] = x;\n        dindex[i + 1] = -1;\n    }\n\n    //Copy rest of the points over\n    for (let i = 0; i < n; ++i) {\n        const h = lifted[i];\n        dpoints[i + 3 + 1] = h.point;\n        dindex[i + 3 + 1] = h.index;\n    }\n\n    //Construct convex hull\n    let hull = incrementalConvexHull(dpoints);\n    hull = hull.filter(cell => {\n        for (let i = 0; i <= 3; ++i) {\n            const v = dindex[cell[i]];\n            if (v < 0) {\n                return false;\n            }\n            cell[i] = v;\n        }\n        return true;\n    });\n\n    for (let i = 0; i < hull.length; ++i) {\n        const h = hull[i];\n        const x = h[0];\n        h[0] = h[1];\n        h[1] = x;\n    }\n\n    return hull;\n};\n\ntype Connection = {\n    [key: number]: boolean;\n};\n\nexport default (points: number[][]): number[][] => {\n    const tri = triangulate(points);\n    const connections: Connection[] = points.map(() => ({}));\n    tri.forEach(t => {\n        for (let i = 0; i < 4; ++i) {\n            for (let j = i + 1; j < 4; ++j) {\n                connections[t[i]][t[j]] = true;\n                connections[t[j]][t[i]] = true;\n            }\n        }\n    });\n    return connections.map(con => Object.keys(con).map(key => Number(key)));\n};\n","import * as Bot from \"./Bot\";\nimport * as BoundingBox from \"./BoundingBox\";\nimport * as Mat3 from \"./Mat3\";\nimport * as Vec3 from \"./Vec3\";\n\nimport { SparseSymmetric, ldiv } from \"./conjugateGradientSparse\";\n\nimport Prando from \"prando\";\nimport delaunay from \"./delaunay\";\nimport { outerProduct } from \"./utils\";\n\nexport type World = { bots: Bot.Bot[] };\n\nexport const newWorld = (): World => ({ bots: [] });\n\nexport const clone = (world: World): World => ({ bots: world.bots.map(bot => Bot.clone(bot)) });\n\nconst edgeStrength = (offset: number, slack: number, d: number): number => {\n    if (d < offset - slack / 2) return 1;\n    if (d > offset + slack / 2) return 0;\n    return (2 * (d + slack - offset) * (offset + slack / 2 - d) ** 2) / slack ** 3;\n};\n\nconst edgeStrengthGround = (offset: number, slack: number, d: number): number => edgeStrength(offset, slack, d) + 1e-4;\n\nconst stiffness = (offset: number, slack: number, d: Vec3.Vec3): Mat3.Mat3 => {\n    const l = Vec3.length(d);\n    const s = Vec3.multiplyScalar(d, Math.sqrt(edgeStrength(offset, slack, l)) / l);\n    return outerProduct(s, s);\n};\n\nconst stiffnessGround = (offset: number, slack: number, d: Vec3.Vec3): Mat3.Mat3 => {\n    const result = outerProduct(d, d);\n    Mat3.multiplyScalar(result, edgeStrengthGround(offset, slack, Vec3.length(d)) / Vec3.dot(d, d));\n    return result;\n};\n\nconst stiffnessDerivative = (offset: number, slack: number, dim: number, d: Vec3.Vec3): Mat3.Mat3 => {\n    const epsilon = 0.00001;\n    const val = d[dim];\n    const dPlus = Vec3.clone(d);\n    dPlus[dim] = val + epsilon;\n    const dMinus = Vec3.clone(d);\n    dMinus[dim] = val - epsilon;\n    const plus = stiffness(offset, slack, dPlus);\n    const minus = stiffness(offset, slack, dMinus);\n    Mat3.sub(plus, minus);\n    Mat3.multiplyScalar(plus, 1 / (2 * epsilon));\n    return plus;\n};\n\nconst stiffnessPair = (offset: number, slack: number, a: Bot.Bot, b: Bot.Bot): Mat3.Mat3 => {\n    const d = Vec3.sub(b.pos, a.pos);\n    return stiffness(offset, slack, d);\n};\n\nconst stiffnessPairDerivative = (offset: number, slack: number, a: Bot.Bot, dim: number, b: Bot.Bot): Mat3.Mat3 =>\n    stiffnessDerivative(offset, slack, dim, Vec3.sub(a.pos, b.pos));\n\nconst stiffnessMatrix = (\n    offset: number,\n    slack: number,\n    friction: number,\n    world: World,\n    neigh: number[][]\n): SparseSymmetric => {\n    const result: SparseSymmetric = [...Array(world.bots.length * 3)].map(() => []);\n    for (let i = 0; i < world.bots.length; ++i) {\n        const sx = stiffnessGround(offset, slack, Vec3.newVec3(world.bots[i].pos[1] + 0.5, 0, 0));\n        const sy = stiffnessGround(offset, slack, Vec3.newVec3(0, world.bots[i].pos[1] + 0.5, 0));\n        const sz = stiffnessGround(offset, slack, Vec3.newVec3(0, 0, world.bots[i].pos[1] + 0.5));\n        for (let k = 0; k < 3; ++k) {\n            for (let l = k; l < 3; ++l) {\n                result[3 * i + k].push([3 * i + l, (sx[k][l] + sz[k][l]) * friction + sy[k][l]]);\n            }\n        }\n    }\n    for (let i = 0; i < world.bots.length; ++i) {\n        neigh[i].forEach(j => {\n            const s = stiffnessPair(offset, slack, world.bots[i], world.bots[j]);\n            for (let k = 0; k < 3; ++k) {\n                for (let l = 0; l < 3; ++l) {\n                    result[3 * i + k].push([3 * j + l, -s[k][l]]);\n                    if (k > l) continue;\n                    result[3 * i + k][l - k][1] += s[k][l];\n                    result[3 * j + k][l - k][1] += s[k][l];\n                }\n            }\n        });\n    }\n    return result;\n};\n\nconst forceMatrix = (before: World, after: World, dt: number, g: number, m: number, world: World): number[] => {\n    const result = [...Array(world.bots.length * 3)].map(() => 0);\n    world.bots.forEach((_, i) => {\n        for (let j = 0; j < 3; ++j) {\n            const v1 = (world.bots[i].pos[j] - before.bots[i].pos[j]) / dt;\n            const v2 = (after.bots[i].pos[j] - world.bots[i].pos[j]) / dt;\n            const acc = (v2 - v1) / dt;\n            result[3 * i + j] = ((j === 1 ? -1 : 0) - acc) * g * m;\n        }\n    });\n    return result;\n};\n\nexport const displacement = (\n    offset: number,\n    slack: number,\n    friction: number,\n    before: World,\n    after: World,\n    dt: number,\n    g: number,\n    m: number,\n    world: World,\n    neigh: number[][]\n): number[] => {\n    const f = forceMatrix(before, after, dt, g, m, world);\n    const k = stiffnessMatrix(offset, slack, friction, world, neigh);\n    return ldiv(k, f);\n};\n\nexport const neighbors = (neighborRadius: number, world: World, con: number[][], n: number): number[] =>\n    con[n]\n        .filter(i => i > n)\n        .filter(i => {\n            const d = Vec3.dist(world.bots[n].pos, world.bots[i].pos);\n            return d < neighborRadius;\n        });\n\nexport const gradient = (\n    offset: number,\n    slack: number,\n    friction: number,\n    overlapPenalty: number,\n    uBefore: number[],\n    u: number[],\n    uAfter: number[],\n    beforeBefore: World,\n    before: World,\n    after: World,\n    afterAfter: World,\n    dt: number,\n    world: World,\n    neigh: number[][],\n    t: number\n): Vec3.Vec3[] => {\n    const udku = [...Array(world.bots.length)].map(() => [0, 1, 2].map(() => 0));\n    for (let i = 0; i < world.bots.length; ++i) {\n        for (let dim = 0; dim < 3; ++dim) {\n            const sx = stiffnessDerivative(offset, slack, dim, Vec3.newVec3(world.bots[i].pos[1] + 0.5, 0, 0));\n            Mat3.multiplyScalar(sx, friction);\n            const sy = stiffnessDerivative(offset, slack, dim, Vec3.newVec3(0, world.bots[i].pos[1] + 0.5, 0));\n            const sz = stiffnessDerivative(offset, slack, dim, Vec3.newVec3(0, 0, world.bots[i].pos[1] + 0.5));\n            Mat3.multiplyScalar(sz, friction);\n            const vi = Vec3.newVec3(u[3 * i], u[3 * i + 1], u[3 * i + 2]);\n            Mat3.add(sx, sy);\n            Mat3.add(sx, sz);\n            const d = Vec3.dot(vi, Mat3.apply(sx, vi));\n            udku[i][dim] += d;\n            neigh[i].forEach(j => {\n                const s = stiffnessPairDerivative(offset, slack, world.bots[i], dim, world.bots[j]);\n                const vj = Vec3.newVec3(u[3 * j], u[3 * j + 1], u[3 * j + 2]);\n                Vec3.subEq(vj, vi);\n                const svisvj = Mat3.apply(s, vj);\n                const diff = Vec3.dot(vj, svisvj);\n                udku[i][dim] += diff;\n                udku[j][dim] -= diff;\n            });\n        }\n    }\n    const result = [...Array(world.bots.length)].map(() => Vec3.newVec3(0, 0, 0));\n    for (let i = 0; i < world.bots.length; ++i) {\n        for (let dim = 0; dim < 3; ++dim) {\n            result[i][dim] =\n                -udku[i][dim] + 2 * ((-uBefore[3 * i + dim] + 2 * u[3 * i + dim] - uAfter[3 * i + dim]) / dt ** 2);\n        }\n    }\n    for (let i = 0; i < world.bots.length; ++i) {\n        if (world.bots[i].pos[1] > 0.5) continue;\n        const l = world.bots[i].pos[1] + 0.5;\n        result[i][1] += 2 * overlapPenalty * (2 * (l - 2));\n    }\n    for (let i = 0; i < world.bots.length; ++i) {\n        neigh[i].forEach(j => {\n            let d = Vec3.sub(world.bots[j].pos, world.bots[i].pos);\n            const l = Vec3.length(d);\n            if (l > 1) return;\n            d = Vec3.multiplyScalar(d, overlapPenalty * ((2 * (l - 2)) / l));\n            Vec3.subEq(result[i], d);\n            Vec3.addEq(result[j], d);\n        });\n    }\n    for (let i = 0; i < world.bots.length; ++i) {\n        const dest = Bot.interpolate(\n            t,\n            dt,\n            beforeBefore.bots[i].pos,\n            before.bots[i].pos,\n            after.bots[i].pos,\n            afterAfter.bots[i].pos\n        );\n        const d = Vec3.sub(dest, world.bots[i].pos);\n        Vec3.addEq(result[i], Vec3.multiplyScalar(d, -0.1));\n    }\n    return result;\n};\n\nexport const connections = (positions: Vec3.Vec3[]): number[][] => {\n    const rng = new Prando(123);\n    const rand = () => Vec3.multiplyScalar(Vec3.newVec3(rng.next() - 0.5, rng.next() - 0.5, rng.next() - 0.5), 0.1);\n    return delaunay(\n        [...positions, ...positions.map((pos): Vec3.Vec3 => [pos[0], -0.5, pos[2]])].map(pos => Vec3.add(pos, rand()))\n    )\n        .map(con => con.map(c => (c >= positions.length ? -1 : c)))\n        .slice(0, positions.length);\n};\n\nexport const boundingBox = (world: World): BoundingBox.BoundingBox => {\n    if (world.bots.length === 0)\n        return {\n            min: [0, 0, 0],\n            max: [0, 0, 0]\n        };\n    let result = Bot.boundingBox(world.bots[0]);\n    world.bots.forEach(bot => {\n        result = BoundingBox.merge(result, Bot.boundingBox(bot));\n    });\n    return result;\n};\n","type Element<Type> = Type;\n\ntype Compare<Type> = (a: Element<Type>, b: Element<Type>) => number;\n\nclass PriorityQueue<Type> {\n    comparator: Compare<Type>;\n    elements: Element<Type>[];\n    constructor(comparator: Compare<Type>) {\n        this.comparator = comparator;\n        this.elements = [];\n    }\n\n    peek(): Element<Type> | undefined {\n        return this.elements[0];\n    }\n\n    pop(): Element<Type> | undefined {\n        const first = this.peek();\n        if (first === undefined) return undefined;\n        const last = this.elements.pop();\n        if (last === undefined) return undefined;\n        const size = this.size();\n\n        if (size === 0) return first;\n\n        this.elements[0] = last;\n        let current = 0;\n\n        while (current < size) {\n            let largest = current;\n            const left = 2 * current + 1;\n            const right = 2 * current + 2;\n\n            if (left < size && this.compare(left, largest) >= 0) {\n                largest = left;\n            }\n\n            if (right < size && this.compare(right, largest) >= 0) {\n                largest = right;\n            }\n\n            if (largest === current) break;\n\n            this.swap(largest, current);\n            current = largest;\n        }\n\n        return first;\n    }\n\n    push(element: Element<Type>): void {\n        const size = this.elements.push(element);\n        let current = size - 1;\n\n        while (current > 0) {\n            const parent = Math.floor((current - 1) / 2);\n\n            if (this.compare(current, parent) <= 0) break;\n\n            this.swap(parent, current);\n            current = parent;\n        }\n    }\n\n    size(): number {\n        return this.elements.length;\n    }\n\n    compare(a: number, b: number): number {\n        return this.comparator(this.elements[a], this.elements[b]);\n    }\n\n    swap(a: number, b: number): void {\n        const aux = this.elements[a];\n        this.elements[a] = this.elements[b];\n        this.elements[b] = aux;\n    }\n}\n\nexport default PriorityQueue;\n","import { Vec3, add, length, multiplyScalar, sub } from \"./Vec3\";\n\nimport { Bot } from \"./Bot\";\nimport PriorityQueue from \"./PriorityQueue\";\n\nexport type Grid = {\n    [i: number]: {\n        [j: number]: {\n            [k: number]: boolean;\n        };\n    };\n};\n\ntype Cell = {\n    dist: number;\n    distEstimate: number;\n    pos: Vec3;\n    prev: Cell | undefined;\n};\n\ntype Solution = {\n    [i: number]: {\n        [j: number]: {\n            [k: number]: Cell;\n        };\n    };\n};\n\nconst equals = (a: Vec3, b: Vec3): boolean => a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n\nconst backtrack = (c: Cell): Vec3 => {\n    const halfDist = c.dist / 2;\n    let cell: Cell = c;\n    for (; cell.prev !== undefined && cell.prev.dist > halfDist; cell = cell.prev);\n    if (cell.prev === undefined) return cell.pos;\n    const prevCell = cell.prev;\n    const d1 = halfDist - prevCell.dist;\n    const d2 = cell.dist - halfDist;\n    const w = d1 / (d1 + d2);\n    return add(multiplyScalar(prevCell.pos, 1 - w), multiplyScalar(cell.pos, w));\n};\n\nconst round = (v: Vec3): Vec3 => [Math.round(v[0]), Math.round(v[1]), Math.round(v[2])];\n\nconst resolution = 3;\n\nconst midpoint = (grid: Grid, s: Vec3, e: Vec3): Vec3 => {\n    const exactMidpoint = multiplyScalar(add(s, e), 0.5);\n    if (length(sub(e, s)) < 1) return exactMidpoint;\n    const start = round(s);\n    const end = round(e);\n    const checked: Solution = {};\n    const check = new PriorityQueue<Cell>((a: Cell, b: Cell): number => b.distEstimate - a.distEstimate);\n    check.push({ dist: 0, distEstimate: 0, pos: start, prev: undefined });\n    let iter = 0;\n    for (; iter < 10000; ) {\n        const c = check.pop();\n        if (c === undefined) break;\n        const [x, y, z] = c.pos;\n        if (y < 0.5 * resolution) continue;\n        if (((grid[x] || {})[y] || {})[z] === true) continue;\n        if (((checked[x] || {})[y] || {})[z] !== undefined) continue;\n        if (checked[x] === undefined) checked[x] = {};\n        if (checked[x][y] === undefined) checked[x][y] = {};\n        checked[x][y][z] = c;\n        if (equals(c.pos, end)) return backtrack(c);\n        ++iter;\n        for (let i = -1; i <= 1; ++i) {\n            for (let j = -1; j <= 1; ++j) {\n                for (let k = -1; k <= 1; ++k) {\n                    if (i === 0 && j === 0 && k === 0) continue;\n                    const p: Vec3 = [i, j, k];\n                    const pos = add(c.pos, p);\n                    const dist = c.dist + length(p);\n                    check.push({\n                        dist,\n                        distEstimate: dist + length(sub(end, pos)),\n                        pos,\n                        prev: c\n                    });\n                }\n            }\n        }\n    }\n    return exactMidpoint;\n};\n\nexport const botsToGrid = (bots: Bot[]): Grid => {\n    const range = [...Array(2 * resolution + 1)].map((_, i) => (i / resolution - 1) * resolution * 0.5);\n    const result: Grid = {};\n    bots.forEach(bot => {\n        range.forEach(a => {\n            range.forEach(b => {\n                range.forEach(c => {\n                    const [i, j, k] = round(add(multiplyScalar(bot.pos, resolution), [a, b, c]));\n                    if (result[i] === undefined) result[i] = {};\n                    if (result[i][j] === undefined) result[i][j] = {};\n                    result[i][j][k] = true;\n                });\n            });\n        });\n    });\n    return result;\n};\n\nexport default (grid: Grid, start: Vec3, end: Vec3): Vec3 =>\n    multiplyScalar(midpoint(grid, multiplyScalar(start, resolution), multiplyScalar(end, resolution)), 1 / resolution);\n","import { Vec3, addEq, clone, length, multiplyScalar, sub, subEq } from \"./Vec3\";\n\nimport { Bot } from \"./Bot\";\n\ntype Grid = {\n    [i: number]: {\n        [j: number]: {\n            [k: number]: {\n                [l: number]: boolean;\n            };\n        };\n    };\n};\n\nconst equals = (a: Vec3, b: Vec3): boolean => a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n\nconst round = (v: Vec3): Vec3 => [Math.round(v[0]), Math.round(v[1]), Math.round(v[2])];\n\nconst addToGrid = (grid: Grid, pos: Vec3, i: number): void => {\n    const [x, y, z] = round(pos);\n    for (let dx = -1; dx <= 1; ++dx) {\n        for (let dy = -1; dy <= 1; ++dy) {\n            for (let dz = -1; dz <= 1; ++dz) {\n                const a = x + dx;\n                const b = y + dy;\n                const c = z + dz;\n                if (grid[a] === undefined) grid[a] = {};\n                if (grid[a][b] === undefined) grid[a][b] = {};\n                if (grid[a][b][c] === undefined) grid[a][b][c] = [];\n                grid[a][b][c][i] = true;\n            }\n        }\n    }\n};\n\nconst removeFromGrid = (grid: Grid, pos: Vec3, i: number): void => {\n    const [x, y, z] = round(pos);\n    for (let dx = -1; dx <= 1; ++dx) {\n        for (let dy = -1; dy <= 1; ++dy) {\n            for (let dz = -1; dz <= 1; ++dz) {\n                const a = x + dx;\n                const b = y + dy;\n                const c = z + dz;\n                delete grid[a][b][c][i];\n            }\n        }\n    }\n};\n\nexport default (bots: Bot[]): (() => void) => {\n    const prevPos = bots.map(bot => clone(bot.pos));\n    const grid: Grid = {};\n    for (let i = 0; i < bots.length; ++i) {\n        addToGrid(grid, bots[i].pos, i);\n    }\n    return () => {\n        for (let i = 0; i < bots.length; ++i) {\n            if (equals(prevPos[i], bots[i].pos)) continue;\n            removeFromGrid(grid, prevPos[i], i);\n            addToGrid(grid, bots[i].pos, i);\n        }\n        for (let i = 0; i < bots.length; ++i) {\n            const [x, y, z] = round(prevPos[i]);\n            const list = Object.keys(grid[x][y][z]).map(key => Number(key));\n            for (let l = 0; l < list.length; ++l) {\n                const j = list[l];\n                const b = bots[j];\n                if (bots[i] === b) continue;\n                const d = sub(b.pos, bots[i].pos);\n                const dLength = length(d);\n                if (dLength > 1) continue;\n                const n = multiplyScalar(d, (1 - dLength) / dLength / 2);\n                subEq(bots[i].pos, n);\n                addEq(b.pos, n);\n            }\n        }\n        for (let i = 0; i < bots.length; ++i) {\n            bots[i].pos[1] = Math.max(bots[i].pos[1], 0.5);\n        }\n    };\n};\n","import { Animation, Vec3, World } from \"../core\";\nimport { Button, List, ListItem } from \"@material-ui/core\";\nimport React, { FC, useEffect, useState } from \"react\";\n\nimport Prando from \"prando\";\nimport update from \"immutability-helper\";\n\nconst rng = new Prando(123);\n\nconst rand = () => Vec3.multiplyScalar(Vec3.newVec3(rng.next() - 0.5, rng.next() - 0.5, rng.next() - 0.5), 2);\n\ntype Props = {\n    worldStart: World.World | undefined;\n    world: World.World | undefined;\n    worldPrev: World.World | undefined;\n    setWorld: (world: World.World) => void;\n    setWorldPrev: (world: World.World) => void;\n    worldEnd: World.World | undefined;\n    config: Animation.Config;\n};\n\nconst Dynamic: FC<Props> = props => {\n    const [pause, setPause] = useState(true);\n    const [path, setPath] = useState<World.World[]>([]);\n\n    const step = () => {\n        if (props.world === undefined || props.worldPrev === undefined || props.worldEnd === undefined) return;\n        if (\n            path.length === 0 ||\n            props.world.bots\n                .map((bot, i) => Vec3.sub(bot.pos, path[0].bots[i].pos))\n                .map(v => Vec3.dot(v, v))\n                .reduce((sum, value) => sum + value, 0) > 0.00001\n        ) {\n            setPath(\n                Animation.createAnimation(props.worldPrev, props.world, props.worldEnd, props.worldEnd, props.config)\n            );\n            return;\n        }\n        let p = path;\n        if (p.length > 1) p = p.slice(1);\n        props.setWorldPrev(props.world);\n        props.setWorld(p[0]);\n        setPath(p);\n    };\n\n    useEffect(() => {\n        if (pause) return undefined;\n        const i = setInterval(step, 1000 / 30);\n        return () => clearInterval(i);\n    }, [props, pause, path]);\n\n    useEffect(() => {\n        setPause(true);\n        if (props.worldStart === undefined) return;\n        props.setWorld(props.worldStart);\n        setPath([]);\n    }, [props.worldStart]);\n\n    return (\n        <List>\n            <ListItem>\n                <Button\n                    variant=\"contained\"\n                    onClick={() => {\n                        setPause(!pause);\n                    }}>\n                    paused: {pause ? \"yes\" : \"no\"}\n                </Button>\n            </ListItem>\n            <ListItem>\n                <Button\n                    variant=\"contained\"\n                    onClick={() => {\n                        if (props.world === undefined) return;\n                        props.setWorld(\n                            update(props.world, {\n                                bots: {\n                                    $set: props.world.bots.map(bot =>\n                                        update(bot, { pos: { $set: Vec3.add(bot.pos, rand()) } })\n                                    )\n                                }\n                            })\n                        );\n                    }}>\n                    Disturb\n                </Button>\n            </ListItem>\n        </List>\n    );\n};\n\nexport default Dynamic;\n","export default __webpack_public_path__ + \"static/media/grass.75422b3f.jpg\";","import * as Vec3 from \"../core/Vec3\";\n\nimport {\n    AmbientLight,\n    BufferGeometry,\n    Color,\n    DirectionalLight,\n    Mesh,\n    MeshPhongMaterial,\n    PlaneBufferGeometry,\n    RepeatWrapping,\n    Scene,\n    SphereGeometry,\n    TextureLoader\n} from \"three\";\n\nimport grass from \"../assets/grass.jpg\";\n\nexport const newScene = (): Scene => {\n    const scene = new Scene();\n\n    const geo = new PlaneBufferGeometry(2000, 2000, 8, 8);\n    const textureGrass = new TextureLoader().load(grass);\n    textureGrass.wrapS = RepeatWrapping;\n    textureGrass.wrapT = RepeatWrapping;\n    textureGrass.repeat.set(100, 100);\n    const mat = new MeshPhongMaterial({ map: textureGrass });\n    const plane = new Mesh(geo, mat);\n    plane.rotateX(-Math.PI / 2);\n    plane.castShadow = false;\n    plane.receiveShadow = true;\n    scene.add(plane);\n\n    scene.add(new AmbientLight(0xffffff, 0.4));\n    const light = new DirectionalLight(0xffffff, 0.4);\n    light.position.set(10, 50, 10);\n    light.castShadow = true;\n    light.shadowCameraRight = 50;\n    light.shadowCameraLeft = -50;\n    light.shadowCameraTop = 50;\n    light.shadowCameraBottom = -50;\n    light.shadowMapWidth = 1024;\n    light.shadowMapHeight = 1024;\n    scene.add(light);\n\n    return scene;\n};\n\nexport const newSphere = (pos: Vec3.Vec3, color: Color): Mesh => {\n    const geom = new SphereGeometry(1, 16, 16);\n    geom.computeVertexNormals();\n    geom.faces.forEach(face => (face.vertexColors = new Array(3).fill(true).map(() => color)));\n    const bg = new BufferGeometry().fromGeometry(geom);\n    delete bg.attributes.uv;\n    const mesh = new Mesh(bg, new MeshPhongMaterial({ color }));\n    mesh.geometry = bg;\n    mesh.position.set(...pos);\n    mesh.scale.set(0.5, 0.5, 0.5);\n    mesh.castShadow = true;\n    mesh.receiveShadow = true;\n    return mesh;\n};\n","import { Button, FormControlLabel, MenuItem, Select, Switch, TextField } from \"@material-ui/core\";\nimport { PCFSoftShadowMap, PerspectiveCamera, Scene, WebGLRenderer } from \"three\";\nimport React, { FC, useEffect, useRef, useState } from \"react\";\nimport { Vec3, World } from \"../core\";\n\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\nimport update from \"immutability-helper\";\nimport { useWindowSize } from \"@react-hook/window-size\";\n\ntype Props = {\n    scene: Scene;\n    center: Vec3.Vec3;\n    world: World.World | undefined;\n};\n\nconst screenshotWidth = 1920;\nconst screenshotHeight = 1080;\nconst screenshotRenderer = new WebGLRenderer({ antialias: true });\nscreenshotRenderer.setClearColor(\"#87ceeb\");\nscreenshotRenderer.setSize(screenshotWidth, screenshotHeight);\nscreenshotRenderer.shadowMapEnabled = true;\nscreenshotRenderer.shadowMapType = PCFSoftShadowMap;\n\nconst Canvas: FC<Props> = props => {\n    const [windowWidth, windowHeight] = useWindowSize();\n    const width = windowWidth * 0.55;\n    const height = windowHeight * 0.8;\n    const [fov, setFov] = useState(30);\n    const mount = useRef<HTMLDivElement>(null);\n    const [controls, setControls] = useState<OrbitControls>();\n    const [camera, setCamera] = useState<PerspectiveCamera>();\n    const [renderer, setRenderer] = useState<WebGLRenderer>();\n    const [zoom, setZoom] = useState(10);\n    const [saveScreenshots, setSaveScreenshots] = useState(false);\n\n    const [align, setAlign] = useState<Vec3.Vec3>([0, 0, 1]);\n\n    const saveImage = () => {\n        if (camera === undefined) return;\n        const cam = camera.clone();\n        cam.aspect = screenshotWidth / screenshotHeight;\n        cam.updateProjectionMatrix();\n        const a = document.createElement(\"a\");\n        screenshotRenderer.render(props.scene, cam);\n        a.href = screenshotRenderer.domElement.toDataURL().replace(\"image/png\", \"image/octet-stream\");\n        a.download = \"image.png\";\n        a.click();\n    };\n\n    useEffect(() => {\n        const mc = mount.current;\n        if (!mc) return undefined;\n        // Camera\n        const cam = new PerspectiveCamera(fov, width / height, 0.1, 1000);\n        cam.position.set(10, 10, 10);\n        cam.lookAt(0, 0, 0);\n        setCamera(cam);\n        // Renderer\n        const ren = new WebGLRenderer({ antialias: true });\n        ren.setClearColor(\"#87ceeb\");\n        ren.setSize(width, height);\n        ren.shadowMapEnabled = true;\n        ren.shadowMapType = PCFSoftShadowMap;\n        mc.appendChild(ren.domElement);\n        setRenderer(ren);\n        // Controls\n        const ctrls = new OrbitControls(cam, ren.domElement);\n        ctrls.enableDamping = true;\n        ctrls.dampingFactor = 0.5;\n        setControls(ctrls);\n\n        return () => {\n            mc.removeChild(ren.domElement);\n        };\n    }, [mount]);\n\n    useEffect(() => {\n        if (camera === undefined) return;\n        if (renderer === undefined) return;\n        camera.aspect = width / height;\n        camera.updateProjectionMatrix();\n        renderer.setSize(width, height);\n    }, [camera, renderer, width, height]);\n\n    useEffect(() => {\n        if (!controls || !renderer || !camera || !props.scene) return undefined;\n        const i = window.setInterval(() => {\n            controls.update();\n            renderer.render(props.scene, camera);\n        }, 1000 / 30);\n        return () => {\n            window.clearInterval(i);\n        };\n    }, [controls, renderer, camera, props.scene]);\n\n    useEffect(() => {\n        if (saveScreenshots) saveImage();\n    }, [props.world]);\n\n    return (\n        <>\n            <div ref={mount} />\n            <Button\n                variant=\"contained\"\n                onClick={() => {\n                    if (controls === undefined) return;\n                    const dx = props.center[0] - controls.target.x;\n                    const dy = props.center[1] - controls.target.y;\n                    const dz = props.center[2] - controls.target.z;\n                    controls.object.position.set(\n                        controls.object.position.x + dx,\n                        controls.object.position.y + dy,\n                        controls.object.position.z + dz\n                    );\n                    controls.target.set(props.center[0], props.center[1], props.center[2]);\n                }}>\n                Center camera\n            </Button>\n            <br />\n            <TextField\n                type=\"number\"\n                label=\"Camera distance\"\n                value={zoom}\n                onChange={e => {\n                    const zoomNew = Math.max(parseFloat(e.target.value), 1);\n                    setZoom(zoomNew);\n                    if (camera === undefined) return;\n                    if (controls === undefined) return;\n                    const p: Vec3.Vec3 = [\n                        controls.object.position.x,\n                        controls.object.position.y,\n                        controls.object.position.z\n                    ];\n                    const t: Vec3.Vec3 = [controls.target.x, controls.target.y, controls.target.z];\n                    const d = Vec3.sub(p, t);\n                    const n = Vec3.normalize(d);\n                    const m = Vec3.multiplyScalar(n, zoomNew);\n                    const pos = Vec3.add(t, m);\n                    controls.object.position.set(pos[0], pos[1], pos[2]);\n                    camera.updateProjectionMatrix();\n                }}\n            />\n            <TextField\n                type=\"number\"\n                label=\"FOV\"\n                value={fov}\n                onChange={e => {\n                    const fovNew = Math.min(Math.max(parseFloat(e.target.value), 1), 179);\n                    setFov(fovNew);\n                    if (camera !== undefined) {\n                        camera.fov = fovNew;\n                        camera.updateProjectionMatrix();\n                    }\n                }}\n            />\n            {align.map((value, i) => (\n                <Select\n                    key={i}\n                    value={value}\n                    onChange={e => {\n                        setAlign(update(align, { [i]: { $set: parseFloat(e.target.value as string) } }));\n                    }}>\n                    {[-1, 0, 1].map(v => (\n                        <MenuItem key={v} value={v}>\n                            {v}\n                        </MenuItem>\n                    ))}\n                </Select>\n            ))}\n            <Button\n                variant=\"contained\"\n                onClick={() => {\n                    if (controls === undefined) return;\n                    const t: Vec3.Vec3 = [controls.target.x, controls.target.y, controls.target.z];\n                    const d = Vec3.multiplyScalar(align, zoom);\n                    const pos = Vec3.add(t, d);\n                    controls.object.position.set(pos[0], pos[1], pos[2]);\n                }}>\n                Align ({align.join(\",\")})\n            </Button>\n            <br />\n            <FormControlLabel\n                control={<Switch checked={saveScreenshots} onChange={e => setSaveScreenshots(e.target.checked)} />}\n                label=\"Save screenshot on every frame\"\n            />\n            {!saveScreenshots && (\n                <Button variant=\"contained\" onClick={saveImage}>\n                    Save screenshot for this frame\n                </Button>\n            )}\n        </>\n    );\n};\n\nexport default Canvas;\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst n = 10;\n\nconst arc = [Vec3.newVec3(0, 0, 0)];\n\nfor (let i = 0; i < n; ++i) {\n    const angle = (Math.PI / 2) * (i / n);\n    arc.push(Vec3.newVec3(arc[i][0] + Math.cos(angle), arc[i][1] - Math.sin(angle), 0));\n}\n\nfor (let i = 1; i < n + 1; ++i) {\n    arc.push(Vec3.newVec3(-arc[i][0], arc[i][1], 0));\n}\n\nconst m = Math.min(...arc.map(p => p[1]));\n\narc.forEach((_, i) => (arc[i][1] = arc[i][1] - m + 0.5));\n\nconst s = [\n    ...[...Array(n + 1)].map((_, i) => Vec3.newVec3(i, 0.5, 0)),\n    ...[...Array(n)].map((_, i) => Vec3.newVec3(-i - 1, 0.5, 0))\n];\n\nexport default createExample(\"Arc\", [], s, arc);\n","import { Color, Mesh } from \"three\";\nimport React, { FC, useEffect, useState } from \"react\";\nimport { Vec3, World } from \"../core\";\nimport { newScene, newSphere } from \"./draw\";\n\nimport Canvas from \"./Canvas\";\n\ntype Props = {\n    worldStart: World.World | undefined;\n    world: World.World | undefined;\n    center: Vec3.Vec3;\n};\n\nconst Scene: FC<Props> = props => {\n    const [scene, setScene] = useState(newScene());\n    const [botMeshes, setBotMeshes] = useState<Mesh[]>([]);\n    const [renderedWorld, setRenderedWorld] = useState<World.World | undefined>();\n\n    useEffect(() => {\n        const w = props.world;\n        if (w === undefined) return;\n        if (botMeshes.length !== w.bots.length) return;\n        w.bots.forEach((bot, i) => {\n            botMeshes[i].position.set(...bot.pos);\n        });\n        setRenderedWorld(props.world);\n    }, [props.world, botMeshes]);\n\n    useEffect(() => {\n        const w = props.worldStart;\n        if (w === undefined) return;\n        setBotMeshes(w.bots.map(bot => newSphere(bot.pos, new Color(bot.fixed ? \"#808080\" : \"#fa8072\"))));\n    }, [props.worldStart]);\n\n    useEffect(() => {\n        const scn = newScene();\n        botMeshes.forEach(mesh => scn.add(mesh));\n        setScene(scn);\n    }, [botMeshes]);\n\n    return <Canvas scene={scene} center={props.center} world={renderedWorld} />;\n};\n\nexport default Scene;\n","import { Bot, Vec3, World } from \"../../core\";\n\nexport type Example = {\n    title: string;\n    start: World.World;\n    end: World.World;\n};\n\nconst createBots = (coords: Vec3.Vec3[], fixed: boolean): Bot.Bot[] =>\n    coords.map(\n        (pos): Bot.Bot => ({\n            pos,\n            fixed\n        })\n    );\n\nconst createWorld = (bots: Bot.Bot[]): World.World => ({ bots });\n\nexport const coordsToWorld = (coords: Vec3.Vec3[], fixed: boolean): World.World =>\n    createWorld(createBots(coords, fixed));\n\nexport const createExample = (title: string, fixed: Vec3.Vec3[], start: Vec3.Vec3[], end: Vec3.Vec3[]): Example => {\n    const fixedBots = createBots(fixed, true);\n    const startBots = createBots(start, false);\n    const endBots = createBots(end, false);\n    return {\n        title,\n        start: createWorld([...fixedBots, ...startBots]),\n        end: createWorld([...fixedBots, ...endBots])\n    };\n};\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst n = 20;\n\nconst arc = [Vec3.newVec3(0, 0, 0)];\n\nfor (let i = 0; i < n; ++i) {\n    const angle = (Math.PI / 2) * (i / n);\n    arc.push(Vec3.newVec3(arc[i][0] + Math.cos(angle), arc[i][1] - Math.sin(angle), 0));\n}\n\nfor (let i = 1; i < n + 1; ++i) {\n    arc.push(Vec3.newVec3(-arc[i][0], arc[i][1], 0));\n}\n\nconst m = Math.min(...arc.map(p => p[1]));\n\narc.forEach((_, i) => (arc[i][1] = arc[i][1] - m + 0.5));\n\nconst s = [\n    ...[...Array(n + 1)].map((_, i) => Vec3.newVec3(i + 15, 0.5, 0)),\n    ...[...Array(n)].map((_, i) => Vec3.newVec3(-i - 1 - 15, 0.5, 0))\n];\n\nexport default createExample(\"Big arc\", [], s, arc);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst r = 10;\nconst h1 = 7;\nconst h2 = 12;\n\nconst pillar = (pos: Vec3.Vec3, height: number): Vec3.Vec3[] =>\n    [...Array(height)].map((_, i) => Vec3.add(pos, [0, i, 0]));\n\nconst bar = (pos: Vec3.Vec3, width: number): Vec3.Vec3[] => [...Array(width)].map((_, i) => Vec3.add(pos, [i, 0, 0]));\n\nconst barZ = (pos: Vec3.Vec3, width: number): Vec3.Vec3[] => [...Array(width)].map((_, i) => Vec3.add(pos, [0, 0, i]));\n\nconst platform = (pos: Vec3.Vec3, w: number, h: number): Vec3.Vec3[] => [\n    ...pillar(Vec3.add(pos, [-w, 0, 0]), h),\n    ...pillar(Vec3.add(pos, [w, 0, 0]), h),\n    ...bar(Vec3.add(pos, [-w + 1, h - 1, 0]), 2 * w - 1)\n];\n\nconst platformZ = (pos: Vec3.Vec3, w: number, h: number): Vec3.Vec3[] => [\n    ...pillar(Vec3.add(pos, [0, 0, -w]), h),\n    ...pillar(Vec3.add(pos, [0, 0, w]), h),\n    ...barZ(Vec3.add(pos, [0, h - 1, -w + 1]), w - 1),\n    ...barZ(Vec3.add(pos, [0, h - 1, 1]), w - 1)\n];\n\nconst f: Vec3.Vec3[] = [\n    ...platform([-r, 0.5, 0], 1, h1),\n    ...platform([r, 0.5, 0], 1, h1),\n    ...platform([0, h1 + 0.5, 0], r + 1, h2 - h1),\n    ...platformZ([0, 0.5, 0], 2, h2)\n];\n\nconst s: Vec3.Vec3[] = pillar([-r, h1 + 0.5, 0], h2 - h1 - 2);\nconst e: Vec3.Vec3[] = pillar([r, h1 + 0.5, 0], h2 - h1 - 2);\n\nexport default createExample(\"Brachiation\", f, s, e);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst s = [...Array(8)].map((_, i) => [...Array(8)].map((_, j) => Vec3.newVec3(i - 3.5, 0.5, j - 3.5))).flat();\nconst e = [...Array(4)]\n    .map((_, i) => [...Array(4)].map((_, j) => [...Array(4)].map((_, k) => Vec3.newVec3(i - 1.5, k + 0.5, j - 1.5))))\n    .flat()\n    .flat();\n\nexport default createExample(\"Big cube\", [], s, e);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst s: Vec3.Vec3[] = [\n    [-1.5, 0.5, -1.5],\n    [-0.5, 0.5, -1.5],\n    [0.5, 0.5, -1.5],\n    [1.5, 0.5, -1.5],\n    [-1.5, 0.5, -0.5],\n    [-0.5, 0.5, -0.5],\n    [0.5, 0.5, -0.5],\n    [1.5, 0.5, -0.5],\n    [-1.5, 0.5, 0.5],\n    [-0.5, 0.5, 0.5],\n    [0.5, 0.5, 0.5],\n    [1.5, 0.5, 0.5],\n    [-1.5, 0.5, 1.5],\n    [-0.5, 0.5, 1.5],\n    [0.5, 0.5, 1.5],\n    [1.5, 0.5, 1.5]\n];\n\nconst e: Vec3.Vec3[] = [\n    [-0.5, 0.5, -0.5],\n    [0.5, 0.5, -0.5],\n    [0.5, 0.5, 0.5],\n    [-0.5, 0.5, 0.5],\n    [-0.5, 1.5, -0.5],\n    [0.5, 1.5, -0.5],\n    [0.5, 1.5, 0.5],\n    [-0.5, 1.5, 0.5],\n    [-0.5, 2.5, -0.5],\n    [0.5, 2.5, -0.5],\n    [0.5, 2.5, 0.5],\n    [-0.5, 2.5, 0.5],\n    [-0.5, 3.5, -0.5],\n    [0.5, 3.5, -0.5],\n    [0.5, 3.5, 0.5],\n    [-0.5, 3.5, 0.5]\n];\n\nexport default createExample(\"Box\", [], s, e);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst s: Vec3.Vec3[] = [\n    [1, 0.5, 0],\n    [0, 0.5, 0],\n    [-1, 0.5, 0],\n    [0, 1.5, 0],\n    [0, 2.5, 0],\n    [0, 3.5, 0],\n    [1, 3.5, 0],\n    [2, 3.5, 0],\n    [3, 3.5, 0],\n    [3, 0.5, 0]\n];\nconst e: Vec3.Vec3[] = [\n    [1, 0.5, 0],\n    [0, 0.5, 0],\n    [-1, 0.5, 0],\n    [0, 1.5, 0],\n    [0, 2.5, 0],\n    [0, 3.5, 0],\n    [1, 3.5, 0],\n    [2, 3.5, 0],\n    [3, 3.5, 0],\n    [3, 2.5, 0]\n];\n\nexport default createExample(\"Crane\", [], s, e);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst r = 6;\nconst h = 3;\nconst w = 2;\n\nconst floor = () =>\n    [...Array(2 * r + 1)]\n        .map((_, i) => [...Array(2 * r + 1)].map((_, j): [number, number, number] => [i - r, 0.5, j - r]))\n        .flat()\n        .filter(p => Math.abs(p[0] + p[2]) < w);\n\nconst s: Vec3.Vec3[] = [\n    ...floor(),\n    ...[...Array(h)].map((_, i): [number, number, number] => [-r, i + 1.5, r]),\n    ...[...Array(h)].map((_, i): [number, number, number] => [r, i + 1.5, -r]),\n    [-r, h + 1.5, r]\n];\n\nconst e: Vec3.Vec3[] = [\n    ...floor(),\n    ...[...Array(h)].map((_, i): [number, number, number] => [-r, i + 1.5, r]),\n    ...[...Array(h)].map((_, i): [number, number, number] => [r, i + 1.5, -r]),\n    [r, h + 1.5, -r]\n];\n\nexport default createExample(\"Floor transport\", [], s, e);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst r = 1;\nconst d = 5;\n\nconst frame = (pos: Vec3.Vec3) =>\n    [...Array(2 * r + 1)]\n        .map((_, i) =>\n            [...Array(2 * r + 1)].map((_, j) =>\n                [...Array(2 * r + 1)].map((_, k): [number, number, number] => [i - r, j - r, k - r])\n            )\n        )\n        .flat()\n        .flat()\n        .filter(\n            p => (Math.abs(p[0]) === r ? 1 : 0) + (Math.abs(p[1]) === r ? 1 : 0) + (Math.abs(p[2]) === r ? 1 : 0) >= 2\n        )\n        .map(p => Vec3.newVec3(p[0], p[1] + 0.5 + r, p[2]))\n        .map(p => Vec3.add(p, pos));\n\nconst s: Vec3.Vec3[] = [\n    ...frame([0, 0, d]),\n    ...frame([0, 2 * r + 1, d]),\n    ...frame([-d, 0, d]),\n    ...frame([d, 0, -d]),\n    ...frame([-d, 2 * r + 1, d])\n];\n\nconst e: Vec3.Vec3[] = [\n    ...frame([0, 0, d]),\n    ...frame([0, 2 * r + 1, d]),\n    ...frame([-d, 0, -d]),\n    ...frame([d, 0, d]),\n    ...frame([d, 2 * r + 1, d])\n];\n\nexport default createExample(\"Frame transport\", [], s, e);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst h = 4;\n\nconst pillar = (pos: Vec3.Vec3, height: number): Vec3.Vec3[] =>\n    [...Array(height)].map((_, i) => Vec3.add(pos, [0, i + 0.5, 0]));\n\nconst p = (pos: Vec3.Vec3): Vec3.Vec3[] => {\n    const coords: Vec3.Vec3[] = [\n        [0, 0.5, 1],\n        [0, 0.5, 0],\n        [0, 0.5, -1],\n        [1, 0.5, 1],\n        [1, 0.5, 0],\n        [1, 0.5, -1],\n        [-1, 0.5, 1],\n        [-1, 0.5, 0],\n        [-1, 0.5, -1]\n    ];\n    return coords.map(v => Vec3.add(v, pos));\n};\n\nconst c = (pos: Vec3.Vec3, height: number): Vec3.Vec3[] => [\n    ...pillar(Vec3.add(pos, [1, 0, 1]), height),\n    ...pillar(Vec3.add(pos, [1, 0, -1]), height),\n    ...pillar(Vec3.add(pos, [-1, 0, -1]), height),\n    ...pillar(Vec3.add(pos, [-1, 0, 1]), height)\n];\n\nconst platform = (pos: Vec3.Vec3): Vec3.Vec3[] => [...c(pos, h), ...p(Vec3.add(pos, [0, h, 0]))];\n\nconst f: Vec3.Vec3[] = [...platform([0, 0, 0])];\n\nconst s: Vec3.Vec3[] = pillar([0, 0, 0], h);\nconst e: Vec3.Vec3[] = pillar([0, h + 1, 0], h);\n\nexport default createExample(\"Platform\", f, s, e);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst r = 6;\nconst h = 5;\n\nconst pillar = (pos: Vec3.Vec3, height: number): Vec3.Vec3[] =>\n    [...Array(height)].map((_, i) => Vec3.add(pos, [0, i, 0]));\n\nconst p = (pos: Vec3.Vec3): Vec3.Vec3[] => {\n    const coords: Vec3.Vec3[] = [\n        [0, 0.5, 1],\n        [0, 0.5, 0],\n        [0, 0.5, -1],\n        [1, 0.5, 1],\n        [1, 0.5, 0],\n        [1, 0.5, -1],\n        [-1, 0.5, 1],\n        [-1, 0.5, 0],\n        [-1, 0.5, -1]\n    ];\n    return coords.map(v => Vec3.add(v, pos));\n};\n\nconst c = (pos: Vec3.Vec3): Vec3.Vec3[] => {\n    const coords: Vec3.Vec3[] = [\n        [1, 0.5, 1],\n        [1, 0.5, -1],\n        [-1, 0.5, 1],\n        [-1, 0.5, -1]\n    ];\n    return coords.map(v => Vec3.add(v, pos));\n};\n\nconst platform = (pos: Vec3.Vec3): Vec3.Vec3[] => [\n    ...c(pos),\n    ...c(Vec3.add(pos, [0, 1, 0])),\n    ...p(Vec3.add(pos, [0, 2, 0]))\n];\n\nconst f: Vec3.Vec3[] = [...platform([-r, 0, 0]), ...platform([r, 0, 0])];\n\nconst s: Vec3.Vec3[] = pillar([-r, 3.5, 0], h);\nconst e: Vec3.Vec3[] = pillar([r, 3.5, 0], h);\n\nexport default createExample(\"Platforms\", f, s, e);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst r = 6;\nconst h = 5;\n\nconst pillar = (pos: Vec3.Vec3, height: number): Vec3.Vec3[] =>\n    [...Array(height)].map((_, i) => Vec3.add(pos, [0, i, 0]));\n\nconst p = (pos: Vec3.Vec3): Vec3.Vec3[] => {\n    const coords: Vec3.Vec3[] = [\n        [0, 0.5, 1],\n        [0, 0.5, 0],\n        [0, 0.5, -1],\n        [1, 0.5, 1],\n        [1, 0.5, 0],\n        [1, 0.5, -1],\n        [-1, 0.5, 1],\n        [-1, 0.5, 0],\n        [-1, 0.5, -1]\n    ];\n    return coords.map(v => Vec3.add(v, pos));\n};\n\nconst c = (pos: Vec3.Vec3): Vec3.Vec3[] => {\n    const coords: Vec3.Vec3[] = [\n        [1, 0.5, 1],\n        [1, 0.5, -1],\n        [-1, 0.5, 1],\n        [-1, 0.5, -1]\n    ];\n    return coords.map(v => Vec3.add(v, pos));\n};\n\nconst platform = (pos: Vec3.Vec3): Vec3.Vec3[] => [\n    ...c(pos),\n    ...c(Vec3.add(pos, [0, 1, 0])),\n    ...c(Vec3.add(pos, [0, 2, 0])),\n    ...c(Vec3.add(pos, [0, 3, 0])),\n    ...c(Vec3.add(pos, [0, 4, 0])),\n    ...p(Vec3.add(pos, [0, 5, 0]))\n];\n\nconst f: Vec3.Vec3[] = [...platform([-r, 0, 0]), ...platform([r, 0, 0])];\n\nconst s: Vec3.Vec3[] = pillar([-r, 6.5, 0], h);\nconst e: Vec3.Vec3[] = pillar([r, 6.5, 0], h);\n\nexport default createExample(\"Tall platforms\", f, s, e);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst pillar = (pos: Vec3.Vec3) => {\n    const list: Vec3.Vec3[] = [\n        [0, 0, 0],\n        [1, 0, 0],\n        [-1, 0, 0],\n        [0, 0, 1],\n        [0, 0, -1],\n        [0, 1, 0],\n        [0, 2, 0],\n        [0, 3, 0]\n    ];\n    return list.map((p: Vec3.Vec3) => Vec3.add(p, pos));\n};\n\nconst space = 3;\n\nconst s: Vec3.Vec3[] = [\n    ...pillar([space * 2, 0.5, -space * 2]),\n    ...pillar([space, 0.5, -space]),\n    ...pillar([0, 0.5, 0]),\n    ...pillar([-space, 0.5, space]),\n    ...pillar([-space * 2, 0.5, space * 2]),\n    [-space * 2, 4.5, space * 2]\n];\n\nconst e: Vec3.Vec3[] = [\n    ...pillar([space * 2, 0.5, -space * 2]),\n    ...pillar([space, 0.5, -space]),\n    ...pillar([0, 0.5, 0]),\n    ...pillar([-space, 0.5, space]),\n    ...pillar([-space * 2, 0.5, space * 2]),\n    [space * 2, 4.5, -space * 2]\n];\n\nexport default createExample(\"Transport\", [], s, e);\n","import { Example as ExampleType } from \"./utils\";\nimport { World } from \"../core\";\nimport arc from \"./arc\";\nimport bigArc from \"./bigArc\";\nimport bigCube from \"./bigCube\";\nimport box from \"./box\";\nimport brachiation from \"./brachiation\";\nimport crane from \"./crane\";\nimport floorTransport from \"./floorTransport\";\nimport frameTransport from \"./frameTransport\";\nimport platform from \"./platform\";\nimport platforms from \"./platforms\";\nimport platformsTall from \"./platformsTall\";\nimport rollingBox from \"./rollingBox\";\nimport stack from \"./stack\";\nimport towers from \"./towers\";\nimport transformer from \"./transformer\";\nimport transport from \"./transport\";\nimport verticalTransport from \"./verticalTransport\";\nimport wall from \"./wall\";\nexport type Example = ExampleType;\n\nexport const examples = [\n    arc,\n    bigArc,\n    bigCube,\n    box,\n    brachiation,\n    crane,\n    floorTransport,\n    frameTransport,\n    platform,\n    platforms,\n    platformsTall,\n    rollingBox,\n    stack,\n    towers,\n    transformer,\n    transport,\n    verticalTransport,\n    wall\n].sort((a, b) => {\n    const d = a.start.bots.length - b.start.bots.length;\n    if (d === 0) return a.title > b.title ? 1 : -1;\n    return d;\n});\n\nexport default (example: Example): [World.World, World.World] => [World.clone(example.start), World.clone(example.end)];\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst s: Vec3.Vec3[] = [\n    [0, 0, 0],\n    [0, 1, 0],\n    [0, 2, 0],\n    [0, 0, 1],\n    [0, 1, 1],\n    [0, 2, 1],\n    [-1, 0, 0],\n    [-1, 1, 0],\n    [-1, 2, 0],\n    [-1, 0, 1],\n    [-1, 1, 1],\n    [-1, 2, 1]\n];\n\nconst e: Vec3.Vec3[] = [\n    [0, 0, 0],\n    [1, 0, 0],\n    [2, 0, 0],\n    [0, 0, 1],\n    [1, 0, 1],\n    [2, 0, 1],\n    [0, 1, 0],\n    [1, 1, 0],\n    [2, 1, 0],\n    [0, 1, 1],\n    [1, 1, 1],\n    [2, 1, 1]\n];\n\nexport default createExample(\n    \"Rolling box\",\n    [],\n    s.map(v => Vec3.add(v, [0, 0.5, 0])),\n    e.map(v => Vec3.add(v, [0, 0.5, 0]))\n);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst s = [...[...Array(5)].map((_, i): Vec3.Vec3 => [i, 0.5, 0])];\n\nconst e = [...[...Array(5)].map((_, i): Vec3.Vec3 => [0, 0.5 + i, 0])];\n\nexport default createExample(\"Stack\", [], s, e);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst s: Vec3.Vec3[] = [\n    [2, 0.5, 0],\n    [2, 1.5, 0],\n    [2, 2.5, 0],\n    [2, 3.5, 0],\n    [2, 4.5, 0],\n    [-2, 0.5, 0],\n    [-2, 1.5, 0],\n    [-2, 2.5, 0],\n    [-2, 3.5, 0],\n    [-2, 4.5, 0],\n    [2, 5.5, 0]\n];\nconst e: Vec3.Vec3[] = [\n    [2, 0.5, 0],\n    [2, 1.5, 0],\n    [2, 2.5, 0],\n    [2, 3.5, 0],\n    [2, 4.5, 0],\n    [-2, 0.5, 0],\n    [-2, 1.5, 0],\n    [-2, 2.5, 0],\n    [-2, 3.5, 0],\n    [-2, 4.5, 0],\n    [-2, 5.5, 0]\n];\n\nexport default createExample(\"Towers\", [], s, e);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst s: Vec3.Vec3[] = [\n    [0, 0.5, 1],\n    [0, 0.5, -1],\n\n    [0, 1.5, 1],\n    [0, 1.5, 0],\n    [0, 1.5, -1],\n\n    [1, 1.5, 1],\n    [1, 1.5, 0],\n    [1, 1.5, -1],\n\n    [2, 1.5, 1],\n    [2, 1.5, 0],\n    [2, 1.5, -1],\n\n    [3, 1.5, 1],\n    [3, 1.5, 0],\n    [3, 1.5, -1],\n\n    [3, 0.5, 1],\n    [3, 0.5, -1]\n];\n\nconst e: Vec3.Vec3[] = [\n    [0, 0.5, 1],\n    [0, 0.5, -1],\n\n    [0, 1.5, 0.8],\n    [0, 3.5, 0],\n    [0, 1.5, -0.8],\n\n    [0, 2.5, 0.6],\n    [0, 4.5, 0],\n    [0, 2.5, -0.6],\n\n    [0, 5.5, 1],\n    [0, 5.5, 0],\n    [0, 5.5, -1],\n\n    [0, 4.7, 1.6],\n    [0, 6.5, 0],\n    [0, 4.7, -1.6],\n\n    [0, 3.7, 2],\n    [0, 3.7, -2]\n];\n\nexport default createExample(\"Transformer\", [], s, e);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst s: Vec3.Vec3[] = [\n    [-3, 0.5, 0],\n    [-3, 1.5, 0],\n    [-3, 2.5, 0],\n    [-2, 2.5, 0],\n    [-1, 2.5, 0],\n    [-3, 3.5, 0],\n    [-3, 4.5, 0],\n    [-3, 5.5, 0],\n    [-3, 6.5, 0],\n    [-2, 6.5, 0],\n    [-1, 6.5, 0],\n    [-3, 7.5, 0],\n    [-3, 8.5, 0],\n    [-3, 9.5, 0],\n    [-3, 10.5, 0],\n    [-2, 10.5, 0],\n    [-1, 10.5, 0],\n\n    [3, 0.5, 0],\n    [3, 1.5, 0],\n    [3, 2.5, 0],\n    [3, 3.5, 0],\n    [3, 4.5, 0],\n    [2, 4.5, 0],\n    [1, 4.5, 0],\n    [3, 5.5, 0],\n    [3, 6.5, 0],\n    [3, 7.5, 0],\n    [3, 8.5, 0],\n    [2, 8.5, 0],\n    [1, 8.5, 0],\n    [3, 9.5, 0],\n    [3, 10.5, 0],\n    [3, 11.5, 0],\n    [3, 12.5, 0],\n    [3, 13.5, 0],\n    [2, 13.5, 0],\n    [1, 13.5, 0],\n    [0, 13.5, 0],\n    [-1, 13.5, 0],\n    [-2, 13.5, 0],\n    [-3, 13.5, 0],\n    [-3, 12.5, 0],\n    [-3, 11.5, 0],\n\n    [0, 0.5, 0]\n];\n\nconst e: Vec3.Vec3[] = [\n    [-3, 0.5, 0],\n    [-3, 1.5, 0],\n    [-3, 2.5, 0],\n    [-2, 2.5, 0],\n    [-1, 2.5, 0],\n    [-3, 3.5, 0],\n    [-3, 4.5, 0],\n    [-3, 5.5, 0],\n    [-3, 6.5, 0],\n    [-2, 6.5, 0],\n    [-1, 6.5, 0],\n    [-3, 7.5, 0],\n    [-3, 8.5, 0],\n    [-3, 9.5, 0],\n    [-3, 10.5, 0],\n    [-2, 10.5, 0],\n    [-1, 10.5, 0],\n\n    [3, 0.5, 0],\n    [3, 1.5, 0],\n    [3, 2.5, 0],\n    [3, 3.5, 0],\n    [3, 4.5, 0],\n    [2, 4.5, 0],\n    [1, 4.5, 0],\n    [3, 5.5, 0],\n    [3, 6.5, 0],\n    [3, 7.5, 0],\n    [3, 8.5, 0],\n    [2, 8.5, 0],\n    [1, 8.5, 0],\n    [3, 9.5, 0],\n    [3, 10.5, 0],\n    [3, 11.5, 0],\n    [3, 12.5, 0],\n    [3, 13.5, 0],\n    [2, 13.5, 0],\n    [1, 13.5, 0],\n    [0, 13.5, 0],\n    [-1, 13.5, 0],\n    [-2, 13.5, 0],\n    [-3, 13.5, 0],\n    [-3, 12.5, 0],\n    [-3, 11.5, 0],\n\n    [0, 12.5, 0]\n];\n\nexport default createExample(\"Vertical transport\", [], s, e);\n","import { Vec3 } from \"../core\";\nimport { createExample } from \"./utils\";\n\nconst f: Vec3.Vec3[] = [\n    [0, 0.5, 1],\n    [0, 0.5, 0],\n    [0, 0.5, -1],\n    [0, 1.5, 1],\n    [0, 1.5, 0],\n    [0, 1.5, -1],\n    [0, 2.5, 1],\n    [0, 2.5, 0],\n    [0, 2.5, -1]\n];\n\nconst s: Vec3.Vec3[] = [[2, 0.5, 0]];\n\nconst e: Vec3.Vec3[] = [[-2, 0.5, 0]];\n\nexport default createExample(\"Wall\", f, s, e);\n","import React, { FC, useState } from \"react\";\nimport { Vec3, World } from \"../core\";\nimport loadExample, { Example, examples } from \"../examples\";\n\nimport { Button } from \"@material-ui/core\";\nimport Prando from \"prando\";\n\ntype Props = { onSelect: (worldStart: World.World, worldEnd: World.World) => void };\n\nconst SelectExample: FC<Props> = props => {\n    const [selectedExample, setSelectedExample] = useState<number | undefined>(undefined);\n\n    const exampleButton = (example: Example, i: number) => (\n        <Button\n            key={i}\n            variant=\"contained\"\n            color={selectedExample === i ? \"primary\" : \"default\"}\n            onClick={() => {\n                const rng = new Prando(123);\n                const [ws, we] = loadExample(example);\n                console.log(ws, we);\n                const rand = () =>\n                    Vec3.multiplyScalar(Vec3.newVec3(rng.next() - 0.5, rng.next() - 0.5, rng.next() - 0.5), 0.1);\n                ws.bots.map(bot => (bot.pos = Vec3.add(bot.pos, rand())));\n                we.bots.map(bot => (bot.pos = Vec3.add(bot.pos, rand())));\n                props.onSelect(ws, we);\n                setSelectedExample(i);\n            }}>\n            {example.title} ({example.start.bots.length} bots)\n        </Button>\n    );\n\n    const examplesNoFixed = examples.filter(e => !e.start.bots.some(bot => bot.fixed));\n\n    const examplesFixed = examples.filter(e => e.start.bots.some(bot => bot.fixed));\n\n    return (\n        <>\n            <b>Select an example</b>\n            <br />\n            <br />\n            No obstacles\n            <br />\n            <br />\n            {examplesNoFixed.map(exampleButton)}\n            <br />\n            <br />\n            Obstacles\n            <br />\n            <br />\n            {examplesFixed.map((e, i) => exampleButton(e, i + examplesNoFixed.length))}\n        </>\n    );\n};\n\nexport default SelectExample;\n","import { Animation, World } from \"../core\";\nimport { Button, List, ListItem } from \"@material-ui/core\";\nimport React, { FC, useEffect, useState } from \"react\";\n\ntype Props = {\n    worldStart: World.World | undefined;\n    worldEnd: World.World | undefined;\n    setWorld: (world: World.World) => void;\n    config: Animation.Config;\n};\n\nconst Static: FC<Props> = props => {\n    const [time, setTime] = useState(0);\n    const [pause, setPause] = useState(true);\n    const [animation, setAnimation] = useState<World.World[]>([]);\n\n    useEffect(() => {\n        if (animation.length === 0) return;\n        const pauseFrac = 0.1;\n        const pauseFrames = Math.round(pauseFrac * animation.length);\n        let t = time % (2 * (animation.length + pauseFrames));\n        if (t < pauseFrames) {\n            props.setWorld(animation[0]);\n            return;\n        }\n        t -= pauseFrames;\n        if (t < animation.length) {\n            props.setWorld(animation[t]);\n            return;\n        }\n        t -= animation.length;\n        if (t < pauseFrames) {\n            props.setWorld(animation[animation.length - 1]);\n            return;\n        }\n        t -= pauseFrames;\n        props.setWorld(animation[animation.length - 1 - t]);\n    }, [animation, time]);\n\n    useEffect(() => {\n        if (pause) return undefined;\n        const i = setInterval(() => setTime(t => t + 1), 1000 / 30);\n        return () => clearInterval(i);\n    }, [pause]);\n\n    useEffect(() => {\n        setPause(true);\n        if (props.worldStart === undefined) return;\n        props.setWorld(props.worldStart);\n    }, [props.worldStart]);\n\n    return (\n        <List>\n            <ListItem>\n                <Button\n                    variant=\"contained\"\n                    onClick={() => {\n                        if (props.worldStart === undefined || props.worldEnd === undefined) return;\n                        const t = Date.now();\n                        setAnimation(\n                            Animation.createAnimation(\n                                props.worldStart,\n                                props.worldStart,\n                                props.worldEnd,\n                                props.worldEnd,\n                                props.config\n                            )\n                        );\n                        console.log((Date.now() - t) / 1000);\n                        setPause(false);\n                    }}>\n                    Generate animation\n                </Button>\n            </ListItem>\n            <ListItem>\n                <Button variant=\"contained\" onClick={() => setPause(!pause)}>\n                    paused: {pause ? \"yes\" : \"no\"}\n                </Button>\n                {pause && (\n                    <Button variant=\"contained\" onClick={() => setTime(time + 1)}>\n                        Step\n                    </Button>\n                )}\n            </ListItem>\n        </List>\n    );\n};\n\nexport default Static;\n","import { Animation, BoundingBox, Vec3, World } from \"../core\";\nimport {\n    FormControlLabel,\n    Grid,\n    List,\n    ListItem,\n    MenuItem,\n    Select,\n    Switch,\n    TextField,\n    makeStyles\n} from \"@material-ui/core\";\nimport React, { FC, useState } from \"react\";\n\nimport Dynamic from \"./Dynamic\";\nimport Scene from \"./Scene\";\nimport SelectExample from \"./SelectExample\";\nimport Static from \"./Static\";\nimport update from \"immutability-helper\";\n\nconst useStyles = makeStyles(theme => ({\n    gridItem: {\n        padding: theme.spacing(2),\n        textAlign: \"center\"\n    }\n}));\n\nconst worldCenter = (worldStart: World.World, worldEnd: World.World): Vec3.Vec3 => {\n    const boundingBox = BoundingBox.merge(World.boundingBox(worldStart), World.boundingBox(worldEnd));\n    return Vec3.multiplyScalar(Vec3.add(boundingBox.min, boundingBox.max), 0.5);\n};\n\nconst App: FC = () => {\n    const classes = useStyles();\n    const [worldStart, setWorldStart] = useState<World.World | undefined>(undefined);\n    const [worldEnd, setWorldEnd] = useState<World.World | undefined>(undefined);\n    const [world, setWorld] = useState<World.World | undefined>(undefined);\n    const [worldPrev, setWorldPrev] = useState<World.World | undefined>(undefined);\n    const [dynamic, setDynamic] = useState(false);\n\n    const [config, setConfig] = useState<Animation.Config>({\n        subdivideIterations: 10,\n        optimizeIterations: 10,\n        contractionType: Animation.ContractionType.Fibers,\n        contractIterations: 10,\n        minimizeAccelerationIterations: 100,\n        offset: 1.5,\n        slack: 2,\n        friction: 0.1,\n        overlapPenalty: 1000,\n        gravity: 1,\n        botMass: 1,\n        dt: 1\n    });\n\n    const center: Vec3.Vec3 =\n        worldStart === undefined || worldEnd === undefined ? [0, 0, 0] : worldCenter(worldStart, worldEnd);\n\n    return (\n        <>\n            <Grid container item xs={11}>\n                <Grid item xs={4} style={{ height: \"97vh\", overflowX: \"hidden\", overflowY: \"scroll\" }}>\n                    <Grid container direction=\"column\">\n                        <b style={{ fontSize: 20 }}>Microbots</b>\n                        <Grid item className={classes.gridItem}>\n                            <SelectExample\n                                onSelect={(ws: World.World, we: World.World) => {\n                                    setWorldStart(ws);\n                                    setWorldEnd(we);\n                                    setWorld(ws);\n                                    setWorldPrev(ws);\n                                }}\n                            />\n                        </Grid>\n                        <Grid item className={classes.gridItem}>\n                            <b>Animation</b>\n                            <br />\n                            <FormControlLabel\n                                control={<Switch checked={dynamic} onChange={e => setDynamic(e.target.checked)} />}\n                                label=\"Dynamic\"\n                            />\n                            {dynamic ? (\n                                <Dynamic\n                                    worldStart={worldStart}\n                                    worldEnd={worldEnd}\n                                    world={world}\n                                    worldPrev={worldPrev}\n                                    setWorld={setWorld}\n                                    setWorldPrev={setWorldPrev}\n                                    config={config}\n                                />\n                            ) : (\n                                <Static\n                                    worldStart={worldStart}\n                                    worldEnd={worldEnd}\n                                    setWorld={setWorld}\n                                    config={config}\n                                />\n                            )}\n                        </Grid>\n                        <Grid item className={classes.gridItem}>\n                            <b>Extra options</b>\n                            <List>\n                                {Object.entries(config).map(([key, value]) => (\n                                    <ListItem key={key}>\n                                        {key === \"contractionType\" ? (\n                                            <Select\n                                                value={value}\n                                                onChange={e => {\n                                                    setConfig(\n                                                        update(config, {\n                                                            [key]: { $set: e.target.value as Animation.ContractionType }\n                                                        })\n                                                    );\n                                                }}>\n                                                {Object.entries(Animation.ContractionType)\n                                                    .filter(([k]) => isNaN(Number(k)))\n                                                    .map(([k, v]) => (\n                                                        <MenuItem key={k} value={v}>\n                                                            {k}\n                                                        </MenuItem>\n                                                    ))}\n                                            </Select>\n                                        ) : (\n                                            <TextField\n                                                type=\"number\"\n                                                label={key}\n                                                value={value}\n                                                onChange={e =>\n                                                    setConfig(\n                                                        update(config, {\n                                                            [key]: { $set: Math.max(parseFloat(e.target.value), 0) }\n                                                        })\n                                                    )\n                                                }\n                                            />\n                                        )}\n                                    </ListItem>\n                                ))}\n                            </List>\n                        </Grid>\n                    </Grid>\n                </Grid>\n                <Grid item xs={5}>\n                    <Scene worldStart={worldStart} world={world} center={center} />\n                </Grid>\n            </Grid>\n        </>\n    );\n};\n\nexport default App;\n","import Gui from \"./Gui\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nReactDOM.render(\n    <React.StrictMode>\n        <Gui />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n);\n"],"sourceRoot":""}