(this.webpackJsonpmicrobots=this.webpackJsonpmicrobots||[]).push([[0],{60:function(t,n){},65:function(t,n,e){"use strict";e.r(n);var r={};e.r(r),e.d(r,"newBot",(function(){return w})),e.d(r,"setPos",(function(){return y})),e.d(r,"setWeight",(function(){return S})),e.d(r,"setFixed",(function(){return M}));var o={};e.r(o),e.d(o,"newWorld",(function(){return k})),e.d(o,"setBots",(function(){return N})),e.d(o,"initEdges",(function(){return I})),e.d(o,"stiffness",(function(){return T})),e.d(o,"stiffnessDerivative",(function(){return V})),e.d(o,"stiffnessPair",(function(){return W})),e.d(o,"stiffnessPairDerivative",(function(){return J})),e.d(o,"removeFixedFromVector",(function(){return $})),e.d(o,"removeFixedFromMatrix",(function(){return q})),e.d(o,"assembleMatrix",(function(){return G})),e.d(o,"stiffnessMatrix",(function(){return H})),e.d(o,"stiffnessMatrixDerivativeBot",(function(){return R})),e.d(o,"stiffnessMatrixDerivativeEdge",(function(){return U})),e.d(o,"forceMatrix",(function(){return X})),e.d(o,"inverse",(function(){return Y})),e.d(o,"compliance",(function(){return K})),e.d(o,"complianceDerivative",(function(){return Q})),e.d(o,"complianceDerivativeBot",(function(){return Z})),e.d(o,"complianceDerivativeEdge",(function(){return _})),e.d(o,"distancePenalty",(function(){return tt})),e.d(o,"distancePenaltyDerivative",(function(){return nt})),e.d(o,"distancePenaltyPair",(function(){return et})),e.d(o,"distancePenaltyPairDerivative",(function(){return rt})),e.d(o,"distancePenaltyTotal",(function(){return ot})),e.d(o,"distancePenaltyTotalDerivativeBot",(function(){return ut})),e.d(o,"distancePenaltyTotalDerivativeEdge",(function(){return it})),e.d(o,"objective",(function(){return ct})),e.d(o,"objectiveDerivativeBot",(function(){return at})),e.d(o,"objectiveDerivativeEdge",(function(){return ft})),e.d(o,"optimizeStepBots",(function(){return st})),e.d(o,"optimizeStepEdges",(function(){return lt})),e.d(o,"resolveCollisionStep",(function(){return dt})),e.d(o,"resolveCollision",(function(){return bt})),e.d(o,"optimizeStep",(function(){return pt})),e.d(o,"optimizeStepNumericalBotDim",(function(){return vt})),e.d(o,"optimizeStepNumericalBot",(function(){return jt})),e.d(o,"optimizeStepNumerical",(function(){return ht})),e.d(o,"optimize",(function(){return gt}));var u=e(5),i=e(0),c=e.n(i),a=e(14),f=e.n(a),s=e(8),l=e(38),d=e(7),b=e(1),p=e(39),m=e(82),v=e(84),j=e(85),h=e(86),g=e(88),x=e(44),O=e(25),w=function(){return{pos:new b.t(0,0,0),weight:1,fixed:!1}},y=function(t){return function(n){return n.pos=t,n}},S=function(t){return function(n){return n.weight=t,n}},M=function(t){return function(n){return n.fixed=t,n}},E=e(35),z=e.n(E),C=e(87),P=function(t,n){return(new b.h).set(t.x*n.x,t.x*n.y,t.x*n.z,t.y*n.x,t.y*n.y,t.y*n.z,t.z*n.x,t.z*n.y,t.z*n.z)},B=function(t,n){var e=new b.h;return e.elements=t.elements.map((function(t,e){return t+n.elements[e]})),e},D=function(t,n){return Object(d.a)(Array(t)).map((function(){return Object(d.a)(Array(n)).map((function(){return 0}))}))},A=function(t){var n=Object(d.a)(Array(3*t.length)).map((function(){return 0}));return t.map((function(t,e){for(var r=0;r<3;++r)n[3*e+r]=t.getComponent(r)})),n},F=function(t){var n,e=D(3*t.length,3*(null===(n=t[0])||void 0===n?void 0:n.length)||0);return t.map((function(n,r){return n.map((function(n,o){for(var u=0;u<3;++u)for(var i=0;i<3;++i)e[3*r+u][3*o+i]=t[r][o].elements[u+3*i]}))})),e},k=function(){return{bots:[],edges:[]}},N=function(t){return function(n){return n.bots=t,n}},I=function(t){var n=Object(d.a)(Array(t.bots.length)).map((function(){return 1})),e=n.map((function(t,e){return n.map((function(t,n){return e===n?0:1}))}));return t.edges=e,t},T=function(t){return P(t,t).multiplyScalar(-1/t.dot(t))},V=function(t){return function(n){var e=new b.t(0,0,0).setComponent(t,1),r=P(e,n),o=T(n);return B(B(r,r.clone().transpose()),o.multiplyScalar(2*n.getComponent(t))).multiplyScalar(-1/n.dot(n))}},W=function(t,n,e){return T(n.pos.clone().sub(t.pos)).multiplyScalar(e)},J=function(t){return function(n){return function(e,r,o){if(e!==t&&r!==t)return(new b.h).set(0,0,0,0,0,0,0,0,0);var u=V(n)(r.pos.clone().sub(e.pos)).multiplyScalar(o);return e===t?u.multiplyScalar(-1):u}}},$=function(t){return function(n){return n.filter((function(n,e){return!t.bots[e].fixed}))}},q=function(t){return function(n){return n.filter((function(n,e){return!t.bots[e].fixed})).map((function(n){return n.filter((function(n,e){return!t.bots[e].fixed}))}))}},G=function(t,n){var e=t.edges.map((function(){return t.edges.map((function(){return(new b.h).multiplyScalar(0)}))}));return e.forEach((function(r,o){r.forEach((function(r,u){if(o!==u){var i=n(t.bots[o],t.bots[u],t.edges[o][u]);e[o][o]=function(t,n){var e=new b.h;return e.elements=t.elements.map((function(t,e){return t-n.elements[e]})),e}(e[o][o],i),e[o][u]=B(e[o][u],i)}}))})),q(t)(e)},H=function(t){return G(t,W)},R=function(t){return function(n){return function(e){return G(e,J(t)(n))}}},U=function(t,n){return function(e){var r=Object(d.a)(Array(e.bots.length)).map((function(){return 0})),o=r.map((function(){return r}));o[t][n]=o[n][t]=1;var u=z()(e,{edges:{$set:o}});return H(u)}},X=function(t){return $(t)(t.bots.map((function(t){return new b.t(0,-t.weight,0)})))},Y=function(t){return function(t){var n;return D(t.length/3,((null===(n=t[0])||void 0===n?void 0:n.length)||0)/3).map((function(n,e){return n.map((function(n,r){for(var o=new b.h,u=0;u<3;++u)for(var i=0;i<3;++i)o.elements[u+3*i]=t[3*e+u][3*r+i];return o}))}))}(Object(C.a)(Object(C.b)(F(t))).toArray())},K=function(t){var n=Object(C.b)(A(X(t))),e=Object(C.b)(F(H(t))),r=Object(C.d)(n),o=Object(C.a)(e);return Object(C.c)(Object(C.c)(r,o),n)},L=function(t){return function(n){return Object(C.c)(n,t)}},Q=function(t){return function(n){var e=Object(C.b)(A(X(n))),r=Object(C.b)(F(t(n))),o=Object(C.b)(F(H(n))),u=Object(C.d)(e),i=Object(C.a)(o);return-Object(O.a)(u,L(i),L(r),L(i),L(e))}},Z=function(t){return function(n){return function(e){return Q(R(t)(n))(e)}}},_=function(t,n){return function(e){return Q(U(t,n))(e)}},tt=function(t){return Math.pow(t.dot(t)-1,2)},nt=function(t){return function(n){return(n.dot(n)-1)*n.getComponent(t)*4}},et=function(t,n,e){return tt(n.pos.clone().sub(t.pos))*e},rt=function(t){return function(n,e,r){return nt(t)(e.pos.clone().sub(n.pos))*r}},ot=function(t){var n=0;return t.edges.forEach((function(e,r){e.forEach((function(e,o){r>=o||(n+=et(t.bots[r],t.bots[o],e))}))})),n},ut=function(t){return function(n){return function(e){var r=0;return e.edges.forEach((function(o,u){o.forEach((function(o,i){e.bots[i]===t&&(r+=rt(n)(e.bots[u],e.bots[i],o))}))})),r}}},it=function(t,n){return function(e){return et(e.bots[t],e.bots[n],1)}},ct=function(t){return K(t)+ot(t)},at=function(t){return function(n){return function(e){return function(r){return Z(n)(e)(r)*(1-t)+ut(n)(e)(r)*t}}}},ft=function(t){return function(n,e){return function(r){return _(n,e)(r)*(1-t)+it(n,e)(r)*t}}},st=function(t){return function(n){return function(e){var r=e.bots.map((function(r){if(r.fixed)return r;var o=new b.t;[0,1,2].map((function(t){return o.setComponent(t,at(n)(r)(t)(e))}));var u=o.multiplyScalar(t),i=u.length();return i>.3&&(u=u.multiplyScalar(.3/i)),y(r.pos.clone().sub(u))(r)}));return N(r)(e)}}},lt=function(t){return function(n){return function(e){for(var r=e.edges,o=0;o<e.bots.length;++o)for(var u=0;u<e.bots.length;++u)if(o!==u){var i=ft(n)(o,u)(e);r[o][u]=e.edges[o][u]-i*t,r[o][u]=Math.max(r[o][u],.001),r[o][u]=Math.min(r[o][u],1)}return z()(e,{edges:{$set:r}})}}},dt=function(t){for(var n=0;n<t.bots.length;++n)for(var e=n+1;e<t.bots.length;++e)if(!t.bots[n].fixed||!t.bots[e].fixed){var r=t.bots[n].fixed||t.bots[e].fixed,o=t.bots[e].pos.clone().sub(t.bots[n].pos),u=o.length();if(!(u>1)){var i=o.multiplyScalar((1-u)/(r?1:2)/u);t.bots[n].fixed||(t.bots[n].pos=t.bots[n].pos.clone().sub(i)),t.bots[e].fixed||(t.bots[e].pos=t.bots[e].pos.clone().add(i))}}return t},bt=function(t){for(var n=t,e=0;e<10;++e)n=dt(n);return n},pt=function(t){return function(n){return function(e){return Object(O.a)(e,st(t)(n),lt(t)(n),bt)}}},mt=5,vt=function(t){return function(n){return function(e){return function(r){var o=e.pos.getComponent(r);e.pos.setComponent(r,o+.001);for(var u=0;u<n.bots.length;++u)for(var i=0;i<n.bots.length;++i)if(u!==i){var c=n.bots[i].pos.clone().sub(n.bots[u].pos).length();n.edges[u][i]=1/(1+Math.exp(4*(c-mt)))+.001}var a=K(n);e.pos.setComponent(r,o-.001);for(var f=0;f<n.bots.length;++f)for(var s=0;s<n.bots.length;++s)if(f!==s){var l=n.bots[s].pos.clone().sub(n.bots[f].pos).length();n.edges[f][s]=1/(1+Math.exp(4*(l-mt)))+.001}var d=K(n);e.pos.setComponent(r,o);var b=-(a-d)*t;Math.abs(b)>.5&&(b=.5*Math.sign(b)),e.pos.setComponent(r,o+b);for(var p=0;p<n.bots.length;++p)for(var m=0;m<n.bots.length;++m)if(p!==m){var v=n.bots[m].pos.clone().sub(n.bots[p].pos).length();n.edges[p][m]=1/(1+Math.exp(4*(v-mt)))+.001}return n}}}},jt=function(t){return function(n){return function(e){if(e.fixed)return n;var r=vt(t)(n)(e);return[0,1,2].map((function(t){return r(t)})),n}}},ht=function(t){return function(n){mt=1+.99*(mt-1),console.log(mt);var e=jt(t)(n);return n.bots.map((function(t){return e(t)})),bt(n)}},gt=function(t){for(var n=t,e=0;e<100;++e)n=pt(.01)(.5)(n),console.log(n.bots[3].pos.toArray()),console.log(n.edges);return n},xt=Object(m.a)((function(t){return{gridItem:{padding:t.spacing(2),textAlign:"center"}}})),Ot=function(){return r.setPos(Object(l.a)(b.t,Object(d.a)([Math.random(),Math.random(),Math.random()].map((function(t){return 10*t})))))(r.newBot())},wt=[r.setFixed(!0)(r.newBot()),r.setFixed(!0)(r.setPos(new b.t(3,0,0))(r.newBot())),r.setFixed(!0)(r.setPos(new b.t(0,0,2))(r.newBot())),Ot(),Ot(),Ot(),Ot(),Ot(),Ot(),Ot()],yt=Object(O.a)(o.newWorld(),o.setBots(wt),o.initEdges),St=function(){var t=Object(x.a)(),n=Object(s.a)(t,2),e=n[0],r=n[1],c=.55*e,a=.9*r,f=xt(),l=Object(i.useRef)(null),d=Object(i.useState)(),m=Object(s.a)(d,2),O=m[0],w=m[1],y=Object(i.useState)(),S=Object(s.a)(y,2),M=S[0],E=S[1],z=Object(i.useState)(),C=Object(s.a)(z,2),P=C[0],B=C[1],D=Object(i.useState)(),A=Object(s.a)(D,2),F=A[0],k=A[1],N=Object(i.useState)(0),I=Object(s.a)(N,2),T=I[0],V=I[1],W=Object(i.useState)(0),J=Object(s.a)(W,2),$=J[0],q=J[1];return Object(i.useEffect)((function(){var t=l.current;if(t){var n=new b.m(75,c/a,.1,1e3);n.position.set(10,10,10),n.lookAt(0,0,0),B(n);var e=new b.u({antialias:!0});e.setClearColor("#000000"),e.setSize(c,a),t.appendChild(e.domElement),k(e);var r=new p.a(n,e.domElement);r.enableDamping=!0,r.dampingFactor=.5,w(r);var o=window.setInterval((function(){return V((function(t){return t+1}))}),1e3/30);return function(){window.clearInterval(o),t.removeChild(e.domElement)}}}),[l,c,a]),Object(i.useEffect)((function(){O&&O.update(),F&&M&&P&&F.render(M,P)}),[O,F,M,P,T]),Object(i.useEffect)((function(){if(!($>=300)){var t=setTimeout((function(){if(q($+1),$%4===0){var t=yt.bots.map((function(t){return n=t.pos,e=t.fixed?new b.c(0,0,1):new b.c(0,1,0),function(t){var r=(new b.i).setPosition(n).scale(new b.t(.5,.5,.5)),o=new b.p(1,16,16).applyMatrix4(r);o.computeVertexNormals(),o.faces.forEach((function(t){return t.vertexColors=new Array(3).fill(!0).map((function(){return e}))}));var u=(new b.b).fromGeometry(o);delete u.attributes.uv;var i=new b.j(u,new b.k({color:e}));return i.geometry=u,i.matrixAutoUpdate=!1,i.matrix=r,i.updateMatrix(),t.add(i),t};var n,e})).reduce((function(t,n){return n(t)}),function(){var t=new b.o;t.add(new b.a(16777215,.4));var n=new b.e(16777215,.4);return n.position.set(0,1,0),t.add(n),t}());yt.bots.map((function(n,e){return yt.bots.map((function(r,o){e>=o||(t=function(t,n,e,r){return function(o){var u=(new b.t).subVectors(n,t),i=new b.i;i.lookAt(t,n,(new b.l).up),i.multiply((new b.i).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1));var c=new b.d(e,e,u.length(),8,1),a=new b.j(c,new b.k({color:r}));return a.applyMatrix4(i),a.position.x=(n.x+t.x)/2,a.position.y=(n.y+t.y)/2,a.position.z=(n.z+t.z)/2,o.add(a),o}}(n.pos,r.pos,.3*Math.sqrt(yt.edges[e][o]),new b.c(1,0,0))(t))}))})),E(t)}yt=o.optimizeStepNumerical(1)(yt)}),10);return function(){return clearTimeout(t)}}}),[O,F,M,P,$]),Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)(v.a,{container:!0,item:!0,xs:11,children:[Object(u.jsx)(v.a,{item:!0,xs:4,style:{height:.9*window.innerHeight,overflowX:"hidden",overflowY:"scroll"},children:Object(u.jsx)(v.a,{container:!0,direction:"column",children:Object(u.jsx)(v.a,{item:!0,className:f.gridItem,children:Object(u.jsx)(j.a,{children:Object(u.jsxs)(h.a,{children:[Object(u.jsx)(g.a,{children:Object(u.jsx)("b",{children:"Microbots"})}),Object(u.jsxs)(g.a,{children:[Object(u.jsx)("b",{children:"iterations: "}),$]})]})})})})}),Object(u.jsx)(v.a,{item:!0,xs:5,children:Object(u.jsx)("div",{ref:l})})]})})};f.a.render(Object(u.jsx)(c.a.StrictMode,{children:Object(u.jsx)(St,{})}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.da27c966.chunk.js.map