(this.webpackJsonpmicrobots=this.webpackJsonpmicrobots||[]).push([[0],{60:function(t,n){},65:function(t,n,e){"use strict";e.r(n);var r={};e.r(r),e.d(r,"newBot",(function(){return y})),e.d(r,"setPos",(function(){return S})),e.d(r,"setWeight",(function(){return C})),e.d(r,"setFixed",(function(){return z}));var o={};e.r(o),e.d(o,"newWorld",(function(){return k})),e.d(o,"setBots",(function(){return N})),e.d(o,"initEdges",(function(){return I})),e.d(o,"stiffness",(function(){return V})),e.d(o,"stiffnessDerivative",(function(){return W})),e.d(o,"stiffnessPair",(function(){return J})),e.d(o,"stiffnessPairDerivative",(function(){return T})),e.d(o,"removeFixedFromVector",(function(){return q})),e.d(o,"removeFixedFromMatrix",(function(){return G})),e.d(o,"assembleMatrix",(function(){return H})),e.d(o,"stiffnessMatrix",(function(){return R})),e.d(o,"stiffnessMatrixDerivativeBot",(function(){return U})),e.d(o,"forceMatrix",(function(){return X})),e.d(o,"compliance",(function(){return Y})),e.d(o,"complianceDerivative",(function(){return L})),e.d(o,"complianceDerivativeBot",(function(){return Q})),e.d(o,"objective",(function(){return Z})),e.d(o,"resolveCollisionStep",(function(){return $})),e.d(o,"resolveCollision",(function(){return _})),e.d(o,"optimizeStepNumericalBotDim",(function(){return nt})),e.d(o,"optimizeStepNumericalBot",(function(){return et})),e.d(o,"optimizeStepNumerical",(function(){return rt}));var i=e(5),u=e(0),c=e.n(u),a=e(14),s=e.n(a),f=e(7),l=e(37),d=e(8),b=e(1),p=e(38),m=e(82),v=e(84),j=e(85),x=e(86),w=e(88),h=e(45),O=e(31),g=e(39),y=function(){return{pos:new b.t(0,0,0),weight:1,fixed:!1}},S=function(t){return function(n){return n.pos=t,n}},C=function(t){return function(n){return n.weight=t,n}},z=function(t){return function(n){return n.fixed=t,n}},M=e(87),B=function(t,n){return(new b.h).set(t.x*n.x,t.x*n.y,t.x*n.z,t.y*n.x,t.y*n.y,t.y*n.z,t.z*n.x,t.z*n.y,t.z*n.z)},E=function(t,n){var e=new b.h;return e.elements=t.elements.map((function(t,e){return t+n.elements[e]})),e},F=function(t,n){return Object(d.a)(Array(t)).map((function(){return Object(d.a)(Array(n)).map((function(){return 0}))}))},A=function(t){var n=Object(d.a)(Array(3*t.length)).map((function(){return 0}));return t.map((function(t,e){for(var r=0;r<3;++r)n[3*e+r]=t.getComponent(r)})),n},D=function(t){var n,e=F(3*t.length,3*(null===(n=t[0])||void 0===n?void 0:n.length)||0);return t.map((function(n,r){return n.map((function(n,o){for(var i=0;i<3;++i)for(var u=0;u<3;++u)e[3*r+i][3*o+u]=t[r][o].elements[i+3*u]}))})),e},P=e(40),k=function(){return{bots:[],edges:[]}},N=function(t){return function(n){return n.bots=t,n}},I=function(t){var n=Object(d.a)(Array(t.bots.length)).map((function(){return 1})),e=n.map((function(t,e){return n.map((function(t,n){return e===n?0:1}))}));return t.edges=e,t},V=function(t){return B(t,t).multiplyScalar(-1/t.dot(t))},W=function(t){return function(n){var e=new b.t(0,0,0).setComponent(t,1),r=B(e,n),o=V(n);return E(E(r,r.clone().transpose()),o.multiplyScalar(2*n.getComponent(t))).multiplyScalar(-1/n.dot(n))}},J=function(t,n,e){return V(n.pos.clone().sub(t.pos)).multiplyScalar(e)},T=function(t){return function(n){return function(e,r,o){if(e!==t&&r!==t)return(new b.h).set(0,0,0,0,0,0,0,0,0);var i=W(n)(r.pos.clone().sub(e.pos)).multiplyScalar(o);return e===t?i.multiplyScalar(-1):i}}},q=function(t){return function(n){return n.filter((function(n,e){return!t.bots[e].fixed}))}},G=function(t){return function(n){return n.filter((function(n,e){return!t.bots[e].fixed})).map((function(n){return n.filter((function(n,e){return!t.bots[e].fixed}))}))}},H=function(t,n){var e=t.edges.map((function(){return t.edges.map((function(){return(new b.h).multiplyScalar(0)}))}));return e.forEach((function(r,o){r.forEach((function(r,i){if(o!==i){var u=n(t.bots[o],t.bots[i],t.edges[o][i]);e[o][o]=function(t,n){var e=new b.h;return e.elements=t.elements.map((function(t,e){return t-n.elements[e]})),e}(e[o][o],u),e[o][i]=E(e[o][i],u)}}))})),G(t)(e)},R=function(t){return H(t,J)},U=function(t){return function(n){return function(e){return H(e,T(t)(n))}}},X=function(t){return q(t)(t.bots.map((function(t){return new b.t(0,-t.weight,0)})))},Y=function(t){var n,e,r=A(X(t)),o=D(R(t));return function(t,n){for(var e=0,r=0;r<t.length;++r)e+=t[r]*n[r];return e}(r,(n=o,e=r,P.solve(n,e)))},K=function(t){return function(n){return Object(M.c)(n,t)}},L=function(t){return function(n){var e=Object(M.b)(A(X(n))),r=Object(M.b)(D(t(n))),o=Object(M.b)(D(R(n))),i=Object(M.d)(e),u=Object(M.a)(o);return-Object(O.a)(i,K(u),K(r),K(u),K(e))}},Q=function(t){return function(n){return function(e){return L(U(t)(n))(e)}}},Z=function(t){return Y(t)},$=function(t){for(var n=0;n<t.bots.length;++n)for(var e=n+1;e<t.bots.length;++e)if(!t.bots[n].fixed||!t.bots[e].fixed){var r=t.bots[n].fixed||t.bots[e].fixed,o=t.bots[e].pos.clone().sub(t.bots[n].pos),i=o.length();if(!(i>1)){var u=o.multiplyScalar((1-i)/(r?1:2)/i);t.bots[n].fixed||(t.bots[n].pos=t.bots[n].pos.clone().sub(u)),t.bots[e].fixed||(t.bots[e].pos=t.bots[e].pos.clone().add(u))}}return t},_=function(t){for(var n=t,e=0;e<10;++e)n=$(n);return n},tt=function(t){for(var n=0;n<t.bots.length;++n)for(var e=0;e<t.bots.length;++e)if(n!==e){var r=t.bots[e].pos.clone().sub(t.bots[n].pos).length();t.edges[n][e]=1/(1+Math.exp(4*(r-1.5)))}},nt=function(t){return function(n){return function(e){return function(r){var o=e.pos.getComponent(r);e.pos.setComponent(r,o+.001),tt(n);var i=Y(n);e.pos.setComponent(r,o-.001),tt(n);var u=Y(n);e.pos.setComponent(r,o);var c=-(i-u)*t;return Math.abs(c)>.5&&(c=.5*Math.sign(c)),e.pos.setComponent(r,o+c),tt(n),n}}}},et=function(t){return function(n){return function(e){if(e.fixed)return n;var r=nt(t)(n)(e);return[0,1,2].map((function(t){return r(t)})),n}}},rt=function(t){return function(n){var e=et(t)(n);return n.bots.map((function(t){return e(t)})),_(n)}},ot=new g.a(123),it=Object(m.a)((function(t){return{gridItem:{padding:t.spacing(2),textAlign:"center"}}})),ut=function(){return r.setPos(Object(l.a)(b.t,Object(d.a)([ot.next(),ot.next(),ot.next()].map((function(t){return 10*t})))))(r.newBot())},ct=[r.setFixed(!0)(r.newBot()),r.setFixed(!0)(r.setPos(new b.t(3,0,0))(r.newBot())),r.setFixed(!0)(r.setPos(new b.t(0,0,2))(r.newBot())),ut(),ut(),ut(),ut(),ut(),ut(),ut(),ut(),ut(),ut(),ut(),ut(),ut(),ut(),ut(),ut(),ut()],at=Object(O.a)(o.newWorld(),o.setBots(ct),o.initEdges),st=function(){var t=Object(h.a)(),n=Object(f.a)(t,2),e=n[0],r=n[1],c=.55*e,a=.9*r,s=it(),l=Object(u.useRef)(null),d=Object(u.useState)(),m=Object(f.a)(d,2),O=m[0],g=m[1],y=Object(u.useState)(),S=Object(f.a)(y,2),C=S[0],z=S[1],M=Object(u.useState)(),B=Object(f.a)(M,2),E=B[0],F=B[1],A=Object(u.useState)(),D=Object(f.a)(A,2),P=D[0],k=D[1],N=Object(u.useState)(0),I=Object(f.a)(N,2),V=I[0],W=I[1],J=Object(u.useState)(0),T=Object(f.a)(J,2),q=T[0],G=T[1];return Object(u.useEffect)((function(){var t=l.current;if(t){var n=new b.m(75,c/a,.1,1e3);n.position.set(10,10,10),n.lookAt(0,0,0),F(n);var e=new b.u({antialias:!0});e.setClearColor("#000000"),e.setSize(c,a),t.appendChild(e.domElement),k(e);var r=new p.a(n,e.domElement);r.enableDamping=!0,r.dampingFactor=.5,g(r);var o=window.setInterval((function(){return W((function(t){return t+1}))}),1e3/30);return function(){window.clearInterval(o),t.removeChild(e.domElement)}}}),[l,c,a]),Object(u.useEffect)((function(){O&&O.update(),P&&C&&E&&P.render(C,E)}),[O,P,C,E,V]),Object(u.useEffect)((function(){if(!(q>=50)){var t=setTimeout((function(){if(G(q+1),q%1===0){var t=at.bots.map((function(t){return n=t.pos,e=t.fixed?new b.c(0,0,1):new b.c(0,1,0),function(t){var r=(new b.i).setPosition(n).scale(new b.t(.5,.5,.5)),o=new b.p(1,16,16).applyMatrix4(r);o.computeVertexNormals(),o.faces.forEach((function(t){return t.vertexColors=new Array(3).fill(!0).map((function(){return e}))}));var i=(new b.b).fromGeometry(o);delete i.attributes.uv;var u=new b.j(i,new b.k({color:e}));return u.geometry=i,u.matrixAutoUpdate=!1,u.matrix=r,u.updateMatrix(),t.add(u),t};var n,e})).reduce((function(t,n){return n(t)}),function(){var t=new b.o;t.add(new b.a(16777215,.4));var n=new b.e(16777215,.4);return n.position.set(0,1,0),t.add(n),t}());at.bots.map((function(n,e){return at.bots.map((function(r,o){e>=o||(t=function(t,n,e,r){return function(o){var i=(new b.t).subVectors(n,t),u=new b.i;u.lookAt(t,n,(new b.l).up),u.multiply((new b.i).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1));var c=new b.d(e,e,i.length(),8,1),a=new b.j(c,new b.k({color:r}));return a.applyMatrix4(u),a.position.x=(n.x+t.x)/2,a.position.y=(n.y+t.y)/2,a.position.z=(n.z+t.z)/2,o.add(a),o}}(n.pos,r.pos,.3*Math.sqrt(at.edges[e][o]),new b.c(1,0,0))(t))}))})),z(t)}at=o.optimizeStepNumerical(1)(at)}),10);return function(){return clearTimeout(t)}}}),[O,P,C,E,q]),Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)(v.a,{container:!0,item:!0,xs:11,children:[Object(i.jsx)(v.a,{item:!0,xs:4,style:{height:.9*window.innerHeight,overflowX:"hidden",overflowY:"scroll"},children:Object(i.jsx)(v.a,{container:!0,direction:"column",children:Object(i.jsx)(v.a,{item:!0,className:s.gridItem,children:Object(i.jsx)(j.a,{children:Object(i.jsxs)(x.a,{children:[Object(i.jsx)(w.a,{children:Object(i.jsx)("b",{children:"Microbots"})}),Object(i.jsxs)(w.a,{children:[Object(i.jsx)("b",{children:"iterations: "}),q]})]})})})})}),Object(i.jsx)(v.a,{item:!0,xs:5,children:Object(i.jsx)("div",{ref:l})})]})})};s.a.render(Object(i.jsx)(c.a.StrictMode,{children:Object(i.jsx)(st,{})}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.243c1b30.chunk.js.map