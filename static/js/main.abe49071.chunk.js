(this.webpackJsonpmicrobots=this.webpackJsonpmicrobots||[]).push([[0],{47:function(t,n,e){"use strict";e.r(n);var r={};e.r(r),e.d(r,"newBot",(function(){return y})),e.d(r,"setPos",(function(){return S})),e.d(r,"setWeight",(function(){return E})),e.d(r,"setFixed",(function(){return M}));var o={};e.r(o),e.d(o,"newWorld",(function(){return P})),e.d(o,"setBots",(function(){return D})),e.d(o,"initEdges",(function(){return I})),e.d(o,"stiffness",(function(){return W})),e.d(o,"stiffnessDerivative",(function(){return J})),e.d(o,"stiffnessPair",(function(){return R})),e.d(o,"stiffnessPairDerivative",(function(){return q})),e.d(o,"removeFixedFromVector",(function(){return G})),e.d(o,"removeFixedFromMatrix",(function(){return H})),e.d(o,"stiffnessMatrix",(function(){return X})),e.d(o,"stiffnessMatrixDerivative",(function(){return Y})),e.d(o,"forceMatrix",(function(){return K})),e.d(o,"displacement",(function(){return L})),e.d(o,"compliance",(function(){return Q})),e.d(o,"objective",(function(){return T})),e.d(o,"resolveCollisionStep",(function(){return U})),e.d(o,"resolveCollision",(function(){return Z})),e.d(o,"optimizeStepNumericalBotDim",(function(){return _})),e.d(o,"optimizeStepNumericalBot",(function(){return tt})),e.d(o,"gradient",(function(){return nt})),e.d(o,"optimizeStepNumerical",(function(){return et}));var u=e(4),i=e(0),c=e.n(i),a=e(11),s=e.n(a),f=e(10),l=e(12),d=e(5),p=e(1),b=e(27),m=e(62),v=e(64),j=e(65),h=e(66),x=e(67),w=e(35),g=e(28),O=e(29),y=function(){return{pos:new p.t(0,0,0),weight:1,fixed:!1}},S=function(t){return function(n){return n.pos=t,n}},E=function(t){return function(n){return n.weight=t,n}},M=function(t){return function(n){return n.fixed=t,n}},C=function(){throw new Error("Vectors need to be the same length")},A=function(t,n){t.length!==n.length&&C();for(var e=0,r=0;r<t.length;++r)e+=t[r]*n[r];return e},z=function(t,n){var e=new p.h;return e.elements=t.elements.map((function(t,e){return t+n.elements[e]})),e},F=function(t,n){var e=new p.h;return e.elements=t.elements.map((function(t,e){return t-n.elements[e]})),e},B=function(t,n){return Object(d.a)(Array(t)).map((function(){return Object(d.a)(Array(n)).map((function(){return 0}))}))},k=function(t){var n=Object(d.a)(Array(3*t.length)).map((function(){return 0}));return t.map((function(t,e){for(var r=0;r<3;++r)n[3*e+r]=t.getComponent(r)})),n},N=e(30),P=function(){return{bots:[],edges:[]}},D=function(t){return function(n){return n.bots=t,n}},I=function(t){var n=Object(d.a)(Array(t.bots.length)).map((function(){return 1})),e=n.map((function(t,e){return n.map((function(t,n){return e===n?0:1}))}));return t.edges=e,t},V=function(t){return 1/(1+Math.exp(4*(t-1.5)))},W=function(t){return(n=t,e=t,n.length!==e.length&&C(),(new p.h).set(n.x*e.x,n.x*e.y,n.x*e.z,n.y*e.x,n.y*e.y,n.y*e.z,n.z*e.x,n.z*e.y,n.z*e.z)).multiplyScalar(-1/t.dot(t));var n,e},J=function(t){return function(n){return function(e){var r=1e-5,o=new p.t;o.setComponent(n,r);var u=W(e.clone().add(o)).multiplyScalar(t(e.clone().add(o).length())),i=W(e.clone().sub(o)).multiplyScalar(t(e.clone().sub(o).length()));return F(u,i).multiplyScalar(1/2e-5)}}},R=function(t,n,e){return W(n.pos.clone().sub(t.pos)).multiplyScalar(e)},q=function(t){return function(n){return function(e){return function(r,o){if(r!==n&&o!==n)return(new p.h).set(0,0,0,0,0,0,0,0,0);var u=J(t)(e)(o.pos.clone().sub(r.pos));return r===n?u.multiplyScalar(-1):u}}}},G=function(t){return function(n){return n.map((function(n,e){return t.bots[e].fixed?new p.t(0,0,0):n}))}},H=function(t){return function(n){return n.map((function(n,e){return n.map((function(n,r){return t.bots[e].fixed||t.bots[r].fixed?(new p.h).multiplyScalar(0):n}))}))}},X=function(t){var n=t.edges.map((function(){return t.edges.map((function(){return(new p.h).multiplyScalar(0)}))}));return n.forEach((function(e,r){e.forEach((function(e,o){if(r!==o){var u=R(t.bots[r],t.bots[o],t.edges[r][o]);n[r][r]=F(n[r][r],u),n[r][o]=z(n[r][o],u)}}))})),H(t)(n)},Y=function(t){return function(n){return function(e){return function(r){var o=r.edges.map((function(){return r.edges.map((function(){return(new p.h).multiplyScalar(0)}))})),u=r.bots[n];return r.bots.forEach((function(i,c){if(n!==c){var a=q(t)(u)(e)(r.bots[n],r.bots[c]);o[n][n]=F(o[n][n],a),o[c][c]=F(o[c][c],a),o[n][c]=z(o[n][c],a),o[c][n]=z(o[c][n],a)}})),H(r)(o)}}}},K=function(t){return G(t)(t.bots.map((function(t){return new p.t(0,-t.weight,0)})))},L=function(t){var n,e,r=k(K(t)),o=function(t){var n,e=B(3*t.length,3*(null===(n=t[0])||void 0===n?void 0:n.length)||0);return t.map((function(n,r){return n.map((function(n,o){for(var u=0;u<3;++u)for(var i=0;i<3;++i)e[3*r+u][3*o+i]=t[r][o].elements[u+3*i]}))})),e}(X(t));return n=o,e=r,N.solve(n,e)},Q=function(t){var n=k(K(t)),e=L(t);return A(n,e)},T=function(t){return Q(t)},U=function(t){for(var n=0;n<t.bots.length;++n)for(var e=n+1;e<t.bots.length;++e)if(!t.bots[n].fixed||!t.bots[e].fixed){var r=t.bots[n].fixed||t.bots[e].fixed,o=t.bots[e].pos.clone().sub(t.bots[n].pos),u=o.length();if(!(u>1)){var i=o.multiplyScalar((1-u)/(r?1:2)/u);t.bots[n].fixed||(t.bots[n].pos=t.bots[n].pos.clone().sub(i)),t.bots[e].fixed||(t.bots[e].pos=t.bots[e].pos.clone().add(i))}}return t},Z=function(t){for(var n=t,e=0;e<10;++e)n=U(n);return n},$=function(t){for(var n=0;n<t.bots.length;++n)for(var e=0;e<t.bots.length;++e)if(n!==e){var r=t.bots[e].pos.clone().sub(t.bots[n].pos).length();t.edges[n][e]=V(r)}},_=function(t){return function(n){return function(e){return function(r){var o=e.pos.getComponent(r);e.pos.setComponent(r,o+.001),$(n);var u=Q(n);e.pos.setComponent(r,o-.001),$(n);var i=Q(n);e.pos.setComponent(r,o);var c=-(u-i)*t;return Math.abs(c)>.5&&(c=.5*Math.sign(c)),e.pos.setComponent(r,o+c),$(n),n}}}},tt=function(t){return function(n){return function(e){if(e.fixed)return n;var r=_(t)(n)(e);return[0,1,2].map((function(t){return r(t)})),n}}},nt=function(t){return function(n){var e=L(n);return n.bots.map((function(r,o){return(new p.t).fromArray([0,1,2].map((function(r){var u=n.bots.map((function(){return new p.t(0,0,0)})),i=n.bots[o];n.bots.forEach((function(c,a){if(o!==a){var s=q(t)(i)(r)(n.bots[o],n.bots[a]);u[o].sub(Object(l.a)(p.t,Object(d.a)(e.slice(3*o,3*(o+1)))).applyMatrix3(s)),u[a].sub(Object(l.a)(p.t,Object(d.a)(e.slice(3*a,3*(a+1)))).applyMatrix3(s)),u[o].add(Object(l.a)(p.t,Object(d.a)(e.slice(3*a,3*(a+1)))).applyMatrix3(s)),u[a].add(Object(l.a)(p.t,Object(d.a)(e.slice(3*o,3*(o+1)))).applyMatrix3(s))}}));var c=k(G(n)(u));return-A(e,c)})))}))}},et=function(t){return function(n){$(n);var e=nt(V)(n).map((function(n){return n.multiplyScalar(-t/(1+n.length()))}));return n.bots.map((function(t,n){t.fixed||t.pos.add(e[n])})),Z(n)}},rt=function(t,n,e){return function(r){var o,u=(new p.t).subVectors(n,t),i=new p.i;return i.lookAt(t,n,(new p.l).up),i.multiply((new p.i).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1)),r.setRotationFromMatrix(i),r.scale.set(e,u.length(),e),(o=r.position).set.apply(o,Object(d.a)(t.clone().add(n).divideScalar(2).toArray())),r}},ot=new O.a(123),ut=Object(m.a)((function(t){return{gridItem:{padding:t.spacing(2),textAlign:"center"}}})),it=[r.setFixed(!0)(r.newBot()),r.setFixed(!0)(r.setPos(new p.t(3,0,0))(r.newBot())),r.setFixed(!0)(r.setPos(new p.t(0,0,2))(r.newBot()))].concat(Object(d.a)(Object(d.a)(Array(97)).map((function(){return r.setPos(Object(l.a)(p.t,Object(d.a)([ot.next(),ot.next(),ot.next()].map((function(t){return 10*t})))))(r.newBot())})))),ct=Object(g.a)(o.newWorld(),o.setBots(it),o.initEdges),at=it.map((function(t){return function(t,n){var e,r=new p.p(1,16,16);r.computeVertexNormals(),r.faces.forEach((function(t){return t.vertexColors=new Array(3).fill(!0).map((function(){return n}))}));var o=(new p.b).fromGeometry(r);delete o.attributes.uv;var u=new p.j(o,new p.k({color:n}));return u.geometry=o,(e=u.position).set.apply(e,Object(d.a)(t.toArray())),u.scale.set(.5,.5,.5),u}(t.pos,t.fixed?new p.c(0,0,1):new p.c(0,1,0))})),st=it.map((function(t){return it.map((function(n){return function(t,n,e,r){var o=new p.d(1,1,1,8,1),u=new p.j(o,new p.k({color:r}));return rt(t,n,e)(u)}(t.pos,n.pos,1,new p.c(1,0,0))}))})),ft=function(){var t=new p.o;t.add(new p.a(16777215,.4));var n=new p.e(16777215,.4);return n.position.set(0,1,0),t.add(n),t}();at.map((function(t){return ft.add(t)})),st.map((function(t,n){return t.map((function(t,e){n>=e||ft.add(t)}))}));var lt=function(){var t=Object(w.a)(),n=Object(f.a)(t,2),e=n[0],r=n[1],c=.55*e,a=.9*r,s=ut(),l=Object(i.useRef)(null),m=Object(i.useState)(),g=Object(f.a)(m,2),O=g[0],y=g[1],S=Object(i.useState)(),E=Object(f.a)(S,2),M=E[0],C=E[1],A=Object(i.useState)(),z=Object(f.a)(A,2),F=z[0],B=z[1],k=Object(i.useState)(0),N=Object(f.a)(k,2),P=N[0],D=N[1],I=Object(i.useState)(0),V=Object(f.a)(I,2),W=V[0],J=V[1];return Object(i.useEffect)((function(){var t=l.current;if(t){var n=new p.m(75,c/a,.1,1e3);n.position.set(10,10,10),n.lookAt(0,0,0),C(n);var e=new p.u({antialias:!0});e.setClearColor("#000000"),e.setSize(c,a),t.appendChild(e.domElement),B(e);var r=new b.a(n,e.domElement);r.enableDamping=!0,r.dampingFactor=.5,y(r);var o=window.setInterval((function(){return D((function(t){return t+1}))}),1e3/30);return function(){window.clearInterval(o),t.removeChild(e.domElement)}}}),[l,c,a]),Object(i.useEffect)((function(){O&&O.update(),F&&M&&F.render(ft,M)}),[O,F,M,P]),Object(i.useEffect)((function(){W>=50||(J(W+1),ct.bots.map((function(t,n){var e;(e=at[n].position).set.apply(e,Object(d.a)(t.pos.toArray()))})),ct.bots.map((function(t,n){return ct.bots.map((function(e,r){n>=r||(ft.remove(st[n][r]),ct.edges[n][r]<.01||(ft.add(st[n][r]),rt(t.pos,e.pos,.3*Math.sqrt(ct.edges[n][r]))(st[n][r])))}))})),ct=o.optimizeStepNumerical(.5)(ct))}),[O,F,M,W]),Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)(v.a,{container:!0,item:!0,xs:11,children:[Object(u.jsx)(v.a,{item:!0,xs:4,style:{height:.9*window.innerHeight,overflowX:"hidden",overflowY:"scroll"},children:Object(u.jsx)(v.a,{container:!0,direction:"column",children:Object(u.jsx)(v.a,{item:!0,className:s.gridItem,children:Object(u.jsx)(j.a,{children:Object(u.jsxs)(h.a,{children:[Object(u.jsx)(x.a,{children:Object(u.jsx)("b",{children:"Microbots"})}),Object(u.jsxs)(x.a,{children:[Object(u.jsx)("b",{children:"iterations: "}),W]})]})})})})}),Object(u.jsx)(v.a,{item:!0,xs:5,children:Object(u.jsx)("div",{ref:l})})]})})};s.a.render(Object(u.jsx)(c.a.StrictMode,{children:Object(u.jsx)(lt,{})}),document.getElementById("root"))}},[[47,1,2]]]);
//# sourceMappingURL=main.abe49071.chunk.js.map