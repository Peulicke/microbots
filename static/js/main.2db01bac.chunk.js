(this.webpackJsonpmicrobots=this.webpackJsonpmicrobots||[]).push([[0],{57:function(t,n,e){"use strict";e.r(n);var r={};e.r(r),e.d(r,"newVec3",(function(){return A})),e.d(r,"clone",(function(){return E})),e.d(r,"add",(function(){return S})),e.d(r,"addEq",(function(){return V})),e.d(r,"sub",(function(){return k})),e.d(r,"subEq",(function(){return B})),e.d(r,"multiplyScalar",(function(){return C})),e.d(r,"dot",(function(){return I})),e.d(r,"length",(function(){return W})),e.d(r,"dist",(function(){return q})),e.d(r,"normalize",(function(){return P})),e.d(r,"dir",(function(){return D}));var o={};e.r(o),e.d(o,"newBot",(function(){return T})),e.d(o,"average",(function(){return $})),e.d(o,"interpolate",(function(){return H}));var a={};e.r(a),e.d(a,"newWorld",(function(){return at})),e.d(a,"setBots",(function(){return it})),e.d(a,"setSlack",(function(){return ut})),e.d(a,"setOffset",(function(){return ft})),e.d(a,"edgeStrength",(function(){return lt})),e.d(a,"edgeStrengthGround",(function(){return ht})),e.d(a,"displacement",(function(){return mt})),e.d(a,"neighbors",(function(){return jt})),e.d(a,"gradient",(function(){return gt})),e.d(a,"connections",(function(){return Ot}));var i={};e.r(i),e.d(i,"createAnimation",(function(){return Vt}));var c=e(3),s=e(0),u=e.n(s),f=e(14),l=e.n(f),h=e(8),v=e(77),d=e(78),p=e(81),b=e(79),m=e(76),j=e(80),g=e(74),w=e(2),O=e(37),y=e(42),x=function(t){var n=Object(y.a)(),e=Object(h.a)(n,2),r=e[0],o=e[1],a=.55*r,i=.9*o,u=Object(s.useRef)(null),f=Object(s.useState)(),l=Object(h.a)(f,2),v=l[0],d=l[1],p=Object(s.useState)(),b=Object(h.a)(p,2),m=b[0],j=b[1],g=Object(s.useState)(),x=Object(h.a)(g,2),M=x[0],A=x[1];return Object(s.useEffect)((function(){var t=u.current;if(t){var n=new w.l(75,a/i,.1,1e3);n.position.set(10,10,10),n.lookAt(0,0,0),j(n);var e=new w.t({antialias:!0});e.setClearColor("#000000"),e.setSize(a,i),t.appendChild(e.domElement),A(e);var r=new O.a(n,e.domElement);return r.enableDamping=!0,r.dampingFactor=.5,d(r),function(){t.removeChild(e.domElement)}}}),[u,a,i]),Object(s.useEffect)((function(){if(v&&M&&m&&t.scene){var n=window.setInterval((function(){v.update(),M.render(t.scene,m)}),1e3/30);return function(){window.clearInterval(n)}}}),[v,M,m,t.scene]),Object(c.jsx)("div",{ref:u})},M=e(4),A=function(t,n,e){return[t,n,e]},E=function(t){return[t[0],t[1],t[2]]},S=function(t,n){return[t[0]+n[0],t[1]+n[1],t[2]+n[2]]},V=function(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]},k=function(t,n){return[t[0]-n[0],t[1]-n[1],t[2]-n[2]]},B=function(t,n){t[0]-=n[0],t[1]-=n[1],t[2]-=n[2]},C=function(t,n){return[t[0]*n,t[1]*n,t[2]*n]},I=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},W=function(t){return Math.sqrt(I(t,t))},q=function(t,n){return W(k(t,n))},P=function(t){return C(t,1/W(t))},D=function(t,n){return P(k(t,n))},N=function(t,n){for(var e=0;e<3;++e)for(var r=0;r<3;++r)t[e][r]+=n[e][r]},F=function(t,n){for(var e=0;e<3;++e)for(var r=0;r<3;++r)t[e][r]*=n},z=function(t,n){for(var e=[0,0,0],r=0;r<3;++r)for(var o=0;o<3;++o)e[r]+=t[r][o]*n[o];return e},G=e(25),R=function(t,n){return e=A(t[0]*n[0],t[0]*n[1],t[0]*n[2]),r=A(t[1]*n[0],t[1]*n[1],t[1]*n[2]),o=A(t[2]*n[0],t[2]*n[1],t[2]*n[2]),[e,r,o];var e,r,o},T=function(t){return{pos:t.pos||A(0,0,0),vel:t.vel||A(0,0,0),target:t.target||function(){},weight:t.weight||1}},J=function(t,n,e){var r,o,a=e.time>n?1:-1;for(o=n;(e.time-o)*a<=0;o+=.01*a)if(void 0!==(r=t.target(o)))return{pos:r,time:o};return e},$=function(t,n,e,r){var o=(e+r)/2,a=J(t,o,{pos:t.pos,time:e}),i=J(t,o,{pos:n.pos,time:r});if(i.time-a.time<1e-10)return T(Object(G.a)(Object(G.a)({},t),{},{pos:i.pos}));var c=(i.time-o)/(i.time-a.time),s=(o-a.time)/(i.time-a.time),u=S(C(a.pos,c),C(i.pos,s));return Object(G.a)(Object(G.a)({},t),{},{pos:u})},H=function(t,n,e,r,o,a,i){var c=J(t,n,{pos:r,time:n-2*e}),s=J(t,n,{pos:i,time:n+2*e});return s.time-c.time<1e-10?s.pos:(r=c.pos,i=s.pos,c.time>n-e&&(o=c.pos),s.time<n+e&&(a=s.pos),function(t,n,e,r,o){var a=1e-10,i=n.time-t.time,c=o-t.time,s=o-n.time,u=e.time-n.time,f=e.time-o,l=r.time-o,h=i*c+a,v=c*s+a,d=s*u+a,p=u*f+a,b=f*l+a,m=l*(r.time-e.time)+a,j=1/(p*d),g=j+1/Math.pow(v,2)+1/Math.pow(d,2),w=j+1/Math.pow(p,2)+1/Math.pow(b,2),O=-1/(h*v*(g+w)),y=(g+1/(h*v))/(g+w),x=(w+1/(b*m))/(g+w),M=-1/(b*m*(g+w)),A=C(t.pos,O),E=C(n.pos,y),V=C(e.pos,x),k=C(r.pos,M);return S(S(S(A,E),V),k)}({pos:r,time:n-2*e},{pos:o,time:n-e},{pos:a,time:n+e},{pos:i,time:n+2*e},n))},L=function(t,n){for(var e=0;e<t.length;++e)n[e]=t[e]},U=function(t,n){for(var e=0,r=0;r<t.length;++r)e+=t[r]*n[r];return e},X=function(t,n,e){for(var r=0;r<t.length;++r)t[r]+=n[r]*e},Y=function(t,n,e){for(var r=0;r<e.length;++r)e[r]=0;for(var o=0;o<t.length;++o)for(var a=0;a<t[o].length;++a){var i=t[o][a][0],c=t[o][a][1];e[o]+=c*n[i],o!==i&&(e[i]+=c*n[o])}},K=function(t,n){for(var e=0;e<n.length;++e)n[e]*=t[Math.floor(e/3)]},Q=function(t,n){var e=Array(n.length);L(n,e);var r=function(t,n){for(var e=Array(n.length/3).fill(0),r=0;r<t.length;++r)for(var o=0;o<t[r].length;++o){var a=Object(h.a)(t[r][o],2),i=a[0],c=a[1];Math.floor(r/3)===Math.floor(i/3)&&(e[Math.floor(r/3)]+=c,r!==i&&(e[Math.floor(i/3)]+=c))}for(var s=0;s<e.length;++s)e[s]=Math.sqrt(Math.sqrt(3/e[s]));return e}(t,e);!function(t,n){for(var e=0;e<n.length;++e)for(var r=0;r<n[e].length;++r){var o=n[e][r][0];n[e][r][1]*=t[Math.floor(e/3)],n[e][r][1]*=t[Math.floor(o/3)]}}(r,t),K(r,e);var o=function(t,n){var e=Array(n.length).fill(0),r=Array(n.length);L(n,r);var o=Array(n.length);Y(t,e,o),X(r,o,-1);var a=Array(r.length),i=Array(a.length);L(r,a);for(var c=U(r,r),s=0;s<20;++s){Y(t,a,o);var u=c/U(a,o);X(e,a,u),X(r,o,-u);var f=U(r,r);L(a,i),L(r,a),X(a,i,f/c),c=f}return e}(t,e);return K(r,o),o},Z=function(t){return((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[2][2]+(t[2][1]*t[4][0]-t[4][1]*t[2][0])*-t[3][2]+(t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[4][2])*t[1][3]+((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[1][2]+(t[1][1]*t[4][0]-t[4][1]*t[1][0])*-t[3][2]+(t[1][1]*t[3][0]-t[3][1]*t[1][0])*t[4][2])*-t[2][3]+((t[2][1]*t[4][0]-t[4][1]*t[2][0])*t[1][2]+(t[1][1]*t[4][0]-t[4][1]*t[1][0])*-t[2][2]+(t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[4][2])*t[3][3]+((t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[1][2]+(t[1][1]*t[3][0]-t[3][1]*t[1][0])*-t[2][2]+(t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[3][2])*-t[4][3]+((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[1][2]+(t[1][1]*t[4][0]-t[4][1]*t[1][0])*-t[3][2]+(t[1][1]*t[3][0]-t[3][1]*t[1][0])*t[4][2])*t[0][3]+((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[3][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*t[4][2])*-t[1][3]+(((t[1][1]*t[4][0]-t[4][1]*t[1][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[4][2])*t[3][3]+((t[1][1]*t[3][0]-t[3][1]*t[1][0])*t[0][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[3][2])*-t[4][3]+((t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[1][2]+(t[1][1]*t[3][0]-t[3][1]*t[1][0])*-t[2][2]+(t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[3][2])*t[0][3]+((t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[0][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*-t[2][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*t[3][2])*-t[1][3]+((t[1][1]*t[3][0]-t[3][1]*t[1][0])*t[0][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[3][2])*t[2][3]+((t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[0][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[2][2])*-t[3][3])-(((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[2][2]+(t[2][1]*t[4][0]-t[4][1]*t[2][0])*-t[3][2]+(t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[4][2])*t[0][3]+((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[3][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*t[4][2])*-t[2][3]+(((t[2][1]*t[4][0]-t[4][1]*t[2][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[2][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*t[4][2])*t[3][3]+((t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[0][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*-t[2][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*t[3][2])*-t[4][3])+(((t[2][1]*t[4][0]-t[4][1]*t[2][0])*t[1][2]+(t[1][1]*t[4][0]-t[4][1]*t[1][0])*-t[2][2]+(t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[4][2])*t[0][3]+((t[2][1]*t[4][0]-t[4][1]*t[2][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[2][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*t[4][2])*-t[1][3]+(((t[1][1]*t[4][0]-t[4][1]*t[1][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[4][2])*t[2][3]+((t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[0][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[2][2])*-t[4][3])))};function _(t,n,e){this.vertices=t,this.adjacent=n,this.boundary=e,this.lastVisited=-1}function tt(t,n,e){this.vertices=t,this.cell=n,this.index=e}function nt(t,n){var e=this;this.vertices=t,this.simplices=n,this.interior=n.filter((function(t){return!t.boundary})),this.tuple=Object(M.a)(this.vertices),this.orient=function(){return Z(e.tuple)}}function et(t,n){this.point=t,this.index=n}function rt(t){var n=t.length;if(0===n)return[];for(var e=new Array(n),r=1,o=0;o<n;++o){for(var a=t[o],i=new Array(4),c=0,s=0;s<3;++s){var u=a[s];i[s]=u,c+=u*u}i[3]=c,e[o]=new et(i,o),r=Math.max(c,r)}e.sort((function(t,n){for(var e=0;e<5;++e){var r=n.point[e]-t.point[e];if(r)return r}return 0})),n=e.length;for(var f=new Array(n+3+1),l=new Array(n+3+1),h=16*r,v=new Array(4),d=0;d<=3;++d)v[d]=0;v[3]=h,f[0]=v.slice(),l[0]=-1;for(var p=0;p<=3;++p){var b=v.slice();b[p]=1,f[p+1]=b,l[p+1]=-1}for(var m=0;m<n;++m){var j=e[m];f[m+3+1]=j.point,l[m+3+1]=j.index}var g=function(t,n){var e=t.length;if(0===e)throw new Error("Must have at least d+1 points");var r=t[0].length;if(e<=r)throw new Error("Must input at least d+1 points");var o=t.slice(0,r+1),a=Z(o);if(0===a)throw new Error("Input not in general position");for(var i=new Array(r+1),c=0;c<=r;++c)i[c]=c;a<0&&(i[0]=1,i[1]=0);for(var s=new _(i,new Array(r+1),!1),u=s.adjacent,f=new Array(r+2),l=0;l<=r;++l){for(var h=i.slice(),v=0;v<=r;++v)v===l&&(h[v]=-1);var d=h[0];h[0]=h[1],h[1]=d;var p=new _(h,new Array(r+1),!0);u[l]=p,f[l]=p}f[r+1]=s;for(var b=0;b<=r;++b)for(var m=u[b].vertices,j=u[b].adjacent,g=0;g<=r;++g){var w=m[g];if(w<0)j[g]=s;else for(var O=0;O<=r;++O)u[O].vertices.indexOf(w)<0&&(j[g]=u[O])}for(var y=new nt(o,f),x=!!n,M=r+1;M<e;++M)y.insert(t[M],x);return y.boundary()}(f,!1);g=g.filter((function(t){for(var n=0;n<=3;++n){var e=l[t[n]];if(e<0)return!1;t[n]=e}return!0}));for(var w=0;w<g.length;++w){var O=g[w],y=O[0];O[0]=O[1],O[1]=y}return g}_.prototype.flip=function(){var t=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=t;var n=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=n},nt.prototype.handleBoundaryDegeneracy=function(t,n){var e=this.vertices.length-1,r=this.tuple,o=this.vertices,a=[t];for(t.lastVisited=-e;a.length>0;)for(var i=(t=a.pop()).adjacent,c=0;c<=4;++c){var s=i[c];if(s.boundary&&!(s.lastVisited<=-e)){for(var u=s.vertices,f=0;f<=4;++f){var l=u[f];r[f]=l<0?n:o[l]}var h=this.orient();if(h>0)return s;s.lastVisited=-e,0===h&&a.push(s)}}return null},nt.prototype.walk=function(t,n){var e=this.vertices.length-1,r=this.vertices,o=this.tuple,a=n?this.interior.length*Math.random()|0:this.interior.length-1,i=this.interior[a];t:for(;!i.boundary;){for(var c=i.vertices,s=i.adjacent,u=0;u<=4;++u)o[u]=r[c[u]];i.lastVisited=e;for(var f=0;f<=4;++f){var l=s[f];if(!(l.lastVisited>=e)){var h=o[f];o[f]=t;var v=this.orient();if(o[f]=h,v<0){i=l;continue t}l.boundary?l.lastVisited=-e:l.lastVisited=e}}return}return i},nt.prototype.addPeaks=function(t,n){var e=this.vertices.length-1,r=this.vertices,o=this.tuple,a=this.interior,i=this.simplices,c=[n];n.lastVisited=e,n.vertices[n.vertices.indexOf(-1)]=e,n.boundary=!1,a.push(n);for(var s=[];c.length>0;){var u=(n=c.pop()).vertices,f=n.adjacent,l=u.indexOf(e);if(!(l<0))for(var h=0;h<=4;++h)if(h!==l){var v=f[h];if(v.boundary&&!(v.lastVisited>=e)){var d=v.vertices;if(v.lastVisited!==-e){for(var p=0,b=0;b<=4;++b)d[b]<0?(p=b,o[b]=t):o[b]=r[d[b]];if(this.orient()>0){d[p]=e,v.boundary=!1,a.push(v),c.push(v),v.lastVisited=e;continue}v.lastVisited=-e}var m=v.adjacent,j=u.slice(),g=f.slice(),w=new _(j,g,!0);i.push(w);var O=m.indexOf(n);if(!(O<0)){m[O]=w,g[l]=v,j[h]=-1,g[h]=n,f[h]=w,w.flip();for(var y=0;y<=4;++y){var x=j[y];if(!(x<0||x===e)){for(var M=new Array(3),A=0,E=0;E<=4;++E){var S=j[E];S<0||E===y||(M[A++]=S)}s.push(new tt(M,w,y))}}}}}}s.sort((function(t,n){return function(t,n){var e=t[0]+t[1],r=n[0]+n[1],o=e+t[2]-(r+n[2]);if(o)return o;var a=Math.min(t[0],t[1]),i=Math.min(n[0],n[1]);return(o=Math.min(a,t[2])-Math.min(i,n[2]))||Math.min(a+t[2],e)-Math.min(i+n[2],r)}(t.vertices,n.vertices)}));for(var V=0;V+1<s.length;V+=2){var k=s[V],B=s[V+1],C=k.index,I=B.index;C<0||I<0||(k.cell.adjacent[k.index]=B.cell,B.cell.adjacent[B.index]=k.cell)}},nt.prototype.insert=function(t,n){var e=this.vertices;e.push(t);var r=this.walk(t,n);if(r){for(var o=this.tuple,a=0;a<=4;++a){var i=r.vertices[a];o[a]=i<0?t:e[i]}var c=this.orient(o);c<0||(0!==c||(r=this.handleBoundaryDegeneracy(r,t)))&&this.addPeaks(t,r)}},nt.prototype.boundary=function(){for(var t=[],n=this.simplices,e=n.length,r=0;r<e;++r){var o=n[r];if(o.boundary){for(var a=new Array(4),i=o.vertices,c=0,s=0,u=0;u<=4;++u)i[u]>=0?a[c++]=i[u]:s=1&u;if(0===s){var f=a[0];a[0]=a[1],a[1]=f}t.push(a)}}return t};for(var ot=e(15),at=function(){return{bots:[],time:0}},it=function(t){return function(n){return n.bots=t,n}},ct=1.5,st=2,ut=function(t){st=t},ft=function(t){ct=t},lt=function(t){return t<ct-st/2?1:t>ct+st/2?0:2*(t+st-ct)*Math.pow(ct+st/2-t,2)/Math.pow(st,3)},ht=function(t){return lt(t)+1e-4},vt=function(t){var n=W(t);return t=C(t,Math.sqrt(lt(n))/n),R(t,t)},dt=function(t){var n=R(t,t);return F(n,ht(W(t))/I(t,t)),n},pt=function(t,n){var e=1e-5,r=n[t],o=E(n);o[t]=r+e;var a=E(n);a[t]=r-e;var i=vt(o);return function(t,n){for(var e=0;e<3;++e)for(var r=0;r<3;++r)t[e][r]-=n[e][r]}(i,vt(a)),F(i,1/2e-5),i},bt=function(t,n,e){for(var r=Object(M.a)(Array(3*t.bots.length)).map((function(){return[]})),o=0;o<t.bots.length;++o)for(var a=dt(A(t.bots[o].pos[1]+.5,0,0)),i=dt(A(0,t.bots[o].pos[1]+.5,0)),c=dt(A(0,0,t.bots[o].pos[1]+.5)),s=0;s<3;++s)for(var u=s;u<3;++u)r[3*o+s].push([3*o+u,.1*(a[s][u]+c[s][u])+i[s][u]]);for(var f=function(n){e[n].forEach((function(e){for(var o=function(t,n){var e=k(n.pos,t.pos);return vt(e)}(t.bots[n],t.bots[e]),a=0;a<3;++a)for(var i=0;i<3;++i)r[3*n+a].push([3*e+i,-o[a][i]]),a>i||(r[3*n+a][i-a][1]+=o[a][i],r[3*e+a][i-a][1]+=o[a][i])}))},l=0;l<t.bots.length;++l)f(l);return r},mt=function(t,n,e,r,o,a){var i=function(t,n,e,r){var o=Object(M.a)(Array(3*r.bots.length)).map((function(){return 0}));return r.bots.forEach((function(a,i){for(var c=0;c<3;++c){var s=(r.bots[i].pos[c]-t.bots[i].pos[c])/e,u=((n.bots[i].pos[c]-r.bots[i].pos[c])/e-s)/e;o[3*i+c]=((1===c?-1:0)-u)*a.weight}})),o}(t,n,e,r),c=bt(r,0,a);return Q(c,i)},jt=function(t,n,e){return n[e].filter((function(t){return t>e})).filter((function(n){return q(t.bots[e].pos,t.bots[n].pos)<ct+st/2}))},gt=function(t,n,e,r,o,a,i,c,s,u,f){for(var l=Object(M.a)(Array(s.bots.length)).map((function(){return[0,1,2].map((function(){return 0}))})),h=function(t){for(var e=function(e){var r=pt(e,A(s.bots[t].pos[1]+.5,0,0));F(r,.1);var o=pt(e,A(0,s.bots[t].pos[1]+.5,0)),a=pt(e,A(0,0,s.bots[t].pos[1]+.5));F(a,.1);var i=A(n[3*t],n[3*t+1],n[3*t+2]);N(r,o),N(r,a);var c=I(i,z(r,i));l[t][e]+=c,u[t].forEach((function(r){var o=function(t,n,e){return pt(n,k(t.pos,e.pos))}(s.bots[t],e,s.bots[r]),a=A(n[3*r],n[3*r+1],n[3*r+2]);B(a,i);var c=z(o,a),u=I(a,c);l[t][e]+=u,l[r][e]-=u}))},r=0;r<3;++r)e(r)},v=0;v<s.bots.length;++v)h(v);for(var d=Object(M.a)(Array(s.bots.length)).map((function(){return A(0,0,0)})),p=0;p<s.bots.length;++p)for(var b=0;b<3;++b)d[p][b]=-l[p][b]+(-t[3*p+b]+2*n[3*p+b]-e[3*p+b])/Math.pow(c,2)*2;for(var m=0;m<s.bots.length;++m)if(!(s.bots[m].pos[1]>.5)){var j=s.bots[m].pos[1]+.5;d[m][1]+=2*(j-2)*2e3}for(var g=function(t){u[t].forEach((function(n){var e=k(s.bots[n].pos,s.bots[t].pos),r=W(e);r>1||(e=C(e,2*(r-2)/r*1e3),B(d[t],e),V(d[n],e))}))},w=0;w<s.bots.length;++w)g(w);for(var O=0;O<s.bots.length;++O){var y=H(s.bots[O],f,c,r.bots[O].pos,o.bots[O].pos,a.bots[O].pos,i.bots[O].pos),x=k(y,s.bots[O].pos);V(d[O],C(x,-.1))}return d},wt=new ot.a(123),Ot=function(t){return function(t){var n=rt(t),e=t.map((function(){return{}}));return n.map((function(t){for(var n=0;n<4;++n)for(var r=n+1;r<4;++r)e[t[n]][t[r]]=!0,e[t[r]][t[n]]=!0})),e.map((function(t){return Object.keys(t).map((function(t){return Number(t)}))}))}(t.bots.map((function(t){return S(t.pos,C(A(wt.next()-.5,wt.next()-.5,wt.next()-.5),.1))})))},yt=function(t,n,e,r,o,a,i){var c=C(S(n.pos,e.pos),.5),s=C(k(n.pos,t.pos),1/(o+1e-10)),u=C(k(r.pos,e.pos),1/(a+1e-10)),f=C(S(s,u),.5);return function(t,n,e){var r=C(k(t,C(n,e)),2/Math.pow(e,2));return I(r,r)}(k(e.pos,c),k(u,f),i/2)},xt=function(t,n,e,r,o){for(var a=0,i=0;i<n.bots.length;++i)a+=yt(t.bots[i],n.bots[i],e.bots[i],r.bots[i],n.time-t.time,r.time-e.time,o);return Math.sqrt(a/n.bots.length)},Mt=function(t,n,e,r){var o=at();return o.bots=t.bots.map((function(t,o){return $(t,n.bots[o],e,r)})),o.time=(t.time+n.time)/2,o},At=function(t,n){var e=Math.floor(200/t.length);if(0!==e)for(var r=1/t.length,o=t.map((function(t){return t.bots.map((function(){return A(0,0,0)}))})),a=t.map((function(t){return Ot(t)})),i=t.map((function(t,n){return t.bots.map((function(e,r){return jt(t,a[n],r)}))})),c=function(c){ft(1+40/((1+c/e)*t.length));var s=function(t,n,e,r){for(var o=Object(M.a)(Array(t.length)).map((function(){return Object(M.a)(Array(t[0].bots.length)).map((function(){return A(0,0,0)}))})),a=t.map((function(){return Object(M.a)(Array(3*t[0].bots.length)).map((function(){return 0}))})),i=0;i<t.length;++i){var c=t[Math.max(i-1,0)],s=t[Math.min(i+1,t.length-1)];a[i]=mt(c,s,n,t[i],e[i],r[i])}for(var u=1;u<t.length;++u){var f=t[Math.max(u-2,0)],l=t[u-1],h=t[Math.min(u+1,t.length-1)],v=t[Math.min(u+2,t.length-1)];o[u]=gt(a[u-1],a[u],a[Math.min(u+1,t.length-1)],f,l,h,v,n,t[u],r[u],u/(t.length-1))}return o}(t,n,a,i);s=s.map((function(t){return t.map((function(t){return C(t,-r/(1e-4+W(t)))}))})),t.map((function(n,e){e<=1||e>=t.length-2||n.bots.map((function(n,r){var a=n.target(e/(t.length-1));void 0===a?(o[e][r]=S(o[e][r],s[e][r]),o[e][r]=C(o[e][r],.9),n.pos=S(n.pos,o[e][r])):n.pos=E(a)}))}))},s=0;s<e;++s)c(s)},Et=function(t){var n=Object(M.a)(Array(2*t.length-3));n[0]=t[0],n[n.length-1]=t[t.length-1];for(var e=0;e<t.length-2;++e)n[1+2*e]=t[1+e];for(var r=2;r<n.length-2;r+=2)n[r]=Mt(n[r-1],n[r+1],(r-2)/(n.length-3),r/(n.length-3));return n},St=function(t,n){var e=Math.floor(1e3/t.length);if(0!==e)for(var r=t.map((function(t){return Ot(t)})),o=0;o<e;++o)for(var a=function(e){var o=t[e-2],a=t[e-1],i=t[e],c=t[e+1],s=t[e+2],u=i.bots.map((function(r,i){return H(r,(e-1)/(t.length-3),n,o.bots[i].pos,a.bots[i].pos,c.bots[i].pos,s.bots[i].pos)}));i.bots.map((function(t,n){t.pos[1]+=.1*(.5-t.pos[1])/r[e][n].length,r[e][n].map((function(o){if(!(n>=o)){var a=i.bots[o],c=k(a.pos,t.pos),s=W(c),u=s-1,f=C(c,(u>0?.3/(r[e][n].length+r[e][o].length):1)*u/s),l=t.weight+a.weight;V(t.pos,C(f,a.weight/l)),B(a.pos,C(f,t.weight/l))}}))})),i.bots.map((function(r,o){var a=r.target((e-1)/(t.length-3));if(void 0===a){var i=Math.pow(0,r.weight/n);r.pos=C(r.pos,i),V(r.pos,C(u[o],1-i))}else r.pos=E(a)}))},i=2;i<t.length-2;++i)a(i)},Vt=function(t,n,e,r,o){var a=[t,n,e,r],i=function(t,n,e,r){for(var o=.01,a=1e3,i=0;i<20;++i){var c=(o+a)/2;xt(t,n,e,r,c)>.2?o=c:a=c}return(o+a)/2}(t,n,e,r);i=30;var c=e.time-i-n.time;n.time+=c,t.time+=c;for(var s=o*i,u=Math.log2(s),f=0;f<u;++f)console.log("".concat(f," subdivisions")),i/=2,a=Et(a),St(a,i),At(a,i);return console.log("done"),a.slice(1,a.length-1)},kt=e(34),Bt=function(){var t=new w.n;t.add(new w.a(16777215,.4));var n=new w.e(16777215,.4);return n.position.set(0,1,0),t.add(n),t},Ct=function(t,n,e){return function(r){var o=new w.h;o.lookAt(Object(kt.a)(w.s,Object(M.a)(t)),Object(kt.a)(w.s,Object(M.a)(n)),(new w.k).up),o.multiply((new w.h).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1)),r.setRotationFromMatrix(o),r.scale.set(e,W(k(n,t)),e);var a=C(S(t,n),.5);return r.position.set(a[0],a[1],a[2]),r}},It=function(t,n,e,r){var o=new w.d(1,1,1,8,1),a=new w.i(o,new w.j({color:r}));return Ct(t,n,e)(a)},Wt=function(t){var n=Object(s.useState)(Bt()),e=Object(h.a)(n,2),o=e[0],i=e[1],u=Object(s.useState)([]),f=Object(h.a)(u,2),l=f[0],v=f[1],d=Object(s.useState)([]),p=Object(h.a)(d,2),b=p[0],m=p[1],j=Object(s.useState)([]),g=Object(h.a)(j,2),O=g[0],y=g[1];return Object(s.useEffect)((function(){var n=t.world;void 0!==n&&l.length===n.bots.length&&(n.bots.forEach((function(t,n){var e;(e=l[n].position).set.apply(e,Object(M.a)(t.pos))})),n.bots.forEach((function(t,n){o.remove(b[n]);var e=a.edgeStrength(t.pos[1]+.5);e<.01||(o.add(b[n]),Ct(t.pos,r.newVec3(t.pos[0],0,t.pos[2]),.3*Math.sqrt(e))(b[n]))})),n.bots.forEach((function(t,e){n.bots.forEach((function(n,i){if(!(e>=i)){o.remove(O[e][i]);var c=a.edgeStrength(r.length(r.sub(n.pos,t.pos)));c<.01||(o.add(O[e][i]),Ct(t.pos,n.pos,.3*Math.sqrt(c))(O[e][i]))}}))})))}),[t.world,l,O,b]),Object(s.useEffect)((function(){var n=t.world;void 0!==n&&l.length!==n.bots.length&&(v(n.bots.map((function(t){return function(t,n){var e,r=new w.o(1,16,16);r.computeVertexNormals(),r.faces.forEach((function(t){return t.vertexColors=new Array(3).fill(!0).map((function(){return n}))}));var o=(new w.b).fromGeometry(r);delete o.attributes.uv;var a=new w.i(o,new w.j({color:n}));return a.geometry=o,(e=a.position).set.apply(e,Object(M.a)(t)),a.scale.set(.5,.5,.5),a}(t.pos,void 0===t.target(1)?new w.c(0,0,1):new w.c(0,1,0))}))),m(n.bots.map((function(t){return It(t.pos,r.newVec3(t.pos[0],0,t.pos[2]),1,new w.c(1,0,0))}))),y(n.bots.map((function(t){return n.bots.map((function(n){return It(t.pos,n.pos,1,new w.c(1,0,0))}))}))))}),[t.world,l]),Object(s.useEffect)((function(){var t=Bt();l.forEach((function(n){return t.add(n)})),b.forEach((function(n){return t.add(n)})),O.forEach((function(n,e){return n.forEach((function(n,r){e>=r||t.add(n)}))})),i(t)}),[l,b,O]),Object(c.jsx)(x,{scene:o})},qt=[r.newVec3(0,0,0)],Pt=0;Pt<10;++Pt){var Dt=Math.PI/2*(Pt/10);qt.push(r.newVec3(qt[Pt][0]+Math.cos(Dt),qt[Pt][1]-Math.sin(Dt),0))}for(var Nt=1;Nt<11;++Nt)qt.push(r.newVec3(-qt[Nt][0],qt[Nt][1],0));var Ft=Math.min.apply(Math,Object(M.a)(qt.map((function(t){return t[1]}))));qt.forEach((function(t,n){return qt[n][1]=qt[n][1]-Ft+.5}));for(var zt={title:"Arc",world:{bots:[].concat(Object(M.a)(Object(M.a)(Array(11)).map((function(t,n){return r.newVec3(n,.5,0)}))),Object(M.a)(Object(M.a)(Array(10)).map((function(t,n){return r.newVec3(-n-1,.5,0)})))).map((function(t,n){return o.newBot({pos:t,target:function(t){if(t>.9999)return qt[n]},weight:1})})),time:0}},Gt=[r.newVec3(0,0,0)],Rt=0;Rt<20;++Rt){var Tt=Math.PI/2*(Rt/20);Gt.push(r.newVec3(Gt[Rt][0]+Math.cos(Tt),Gt[Rt][1]-Math.sin(Tt),0))}for(var Jt=1;Jt<21;++Jt)Gt.push(r.newVec3(-Gt[Jt][0],Gt[Jt][1],0));var $t=Math.min.apply(Math,Object(M.a)(Gt.map((function(t){return t[1]}))));Gt.forEach((function(t,n){return Gt[n][1]=Gt[n][1]-$t+.5}));var Ht={title:"Big arc",world:{bots:[].concat(Object(M.a)(Object(M.a)(Array(21)).map((function(t,n){return r.newVec3(n,.5,0)}))),Object(M.a)(Object(M.a)(Array(20)).map((function(t,n){return r.newVec3(-n-1,.5,0)})))).map((function(t,n){return o.newBot({pos:t,target:function(t){if(t>.9999)return Gt[n]},weight:1})})),time:0}},Lt=Object(M.a)(Array(8)).map((function(t,n){return Object(M.a)(Array(8)).map((function(t,e){return r.newVec3(n-3.5,.5,e-3.5)}))})).flat(),Ut=Object(M.a)(Array(4)).map((function(t,n){return Object(M.a)(Array(4)).map((function(t,e){return Object(M.a)(Array(4)).map((function(t,o){return r.newVec3(n-1.5,o+.5,e-1.5)}))}))})).flat().flat(),Xt={title:"Big cube",world:{bots:Lt.map((function(t,n){return o.newBot({pos:t,target:function(t){if(t>.9999)return Ut[n]},weight:1})})),time:0}},Yt=[[-1.5,.5,-1.5],[-.5,.5,-1.5],[.5,.5,-1.5],[1.5,.5,-1.5],[-1.5,.5,-.5],[-.5,.5,-.5],[.5,.5,-.5],[1.5,.5,-.5],[-1.5,.5,.5],[-.5,.5,.5],[.5,.5,.5],[1.5,.5,.5],[-1.5,.5,1.5],[-.5,.5,1.5],[.5,.5,1.5],[1.5,.5,1.5]],Kt={title:"Cube",world:{bots:[[-.5,.5,-.5],[.5,.5,-.5],[.5,.5,.5],[-.5,.5,.5],[-.5,1.5,-.5],[.5,1.5,-.5],[.5,1.5,.5],[-.5,1.5,.5],[-.5,2.5,-.5],[.5,2.5,-.5],[.5,2.5,.5],[-.5,2.5,.5],[-.5,3.5,-.5],[.5,3.5,-.5],[.5,3.5,.5],[-.5,3.5,.5]].map((function(t,n){return o.newBot({pos:t,target:function(t){if(t>.9999)return Yt[n]},weight:1})})),time:0}},Qt={bots:Object(M.a)(Object(M.a)(Array(5)).map((function(t,n){return o.newBot({pos:[n,.5,0],target:function(t){if(t>.9999)return[0,.5+n,0]},weight:10})}))),time:0},Zt=[[2,.5,0],[2,1.5,0],[2,2.5,0],[2,3.5,0],[2,4.5,0],[-2,.5,0],[-2,1.5,0],[-2,2.5,0],[-2,3.5,0],[-2,4.5,0],[-2,5.5,0]],_t=[{title:"Stack",world:Qt},{title:"Towers",world:{bots:[[2,.5,0],[2,1.5,0],[2,2.5,0],[2,3.5,0],[2,4.5,0],[-2,.5,0],[-2,1.5,0],[-2,2.5,0],[-2,3.5,0],[-2,4.5,0],[2,5.5,0]].map((function(t,n){return o.newBot({pos:t,target:function(t){if(t>.9999)return Zt[n]},weight:1})})),time:0}},{title:"Targets",world:{bots:[].concat(Object(M.a)(Object(M.a)(Array(9)).map((function(t,n){return o.newBot({pos:[n-3.5,.5,0],weight:.3})}))),[o.newBot({pos:[.5,.5,1],target:function(t){return Math.abs(t-.4)<.03?[1,3.5,1]:Math.abs(t-.6)<.03?[-1,3.5,1]:Math.abs(t-.8)<.03?[-1,3.5,-1]:Math.abs(t-1)<.03?[1,3.5,-1]:void 0}})]),time:0}},zt,Ht,Kt,Xt].sort((function(t,n){var e=t.world.bots.length-n.world.bots.length;return 0===e?t.title>n.title?1:-1:e})),tn=function(t){var n=Object(s.useState)(void 0),e=Object(h.a)(n,2),o=e[0],i=e[1];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("b",{children:"Select an example"}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),_t.map((function(n,e){return Object(c.jsxs)(g.a,{variant:"contained",color:o===e?"primary":"default",onClick:function(){var n,o=new ot.a(123),c=[_t[n=e].world,a.setBots(_t[n].world.bots.map((function(t){return{pos:void 0!==t.target&&t.target(1)||t.pos,vel:t.vel,target:t.target,weight:t.weight}})))(a.newWorld())],s=Object(h.a)(c,2),u=s[0],f=s[1];console.log(u,f);var l=function(){return r.multiplyScalar(r.newVec3(o.next()-.5,o.next()-.5,o.next()-.5),.1)};u.bots.map((function(t){return t.pos=r.add(t.pos,l())})),f.bots.map((function(t){return t.pos=r.add(t.pos,l())})),t.onSelect(u,f),i(e)},children:[n.title," (",n.world.bots.length," bots)"]},e)}))]})},nn=function(t){var n=Object(s.useState)(0),e=Object(h.a)(n,2),r=e[0],o=e[1],a=Object(s.useState)(!0),u=Object(h.a)(a,2),f=u[0],l=u[1],v=Object(s.useState)([]),d=Object(h.a)(v,2),p=d[0],b=d[1];return Object(s.useEffect)((function(){if(0!==p.length){var n=Math.round(.1*p.length),e=r%(2*(p.length+n));e<n?t.setWorld(p[0]):(e-=n)<p.length?t.setWorld(p[e]):(e-=p.length)<n?t.setWorld(p[p.length-1]):(e-=n,t.setWorld(p[p.length-1-e]))}}),[p,r]),Object(s.useEffect)((function(){if(!f){var t=setInterval((function(){return o((function(t){return t+1}))}),1e3/30);return function(){return clearInterval(t)}}}),[f]),Object(c.jsxs)(m.a,{children:[Object(c.jsx)(j.a,{children:Object(c.jsx)(g.a,{variant:"contained",onClick:function(){if(void 0!==t.worldStart&&void 0!==t.worldEnd){var n=Date.now();b(i.createAnimation(t.worldStart,t.worldStart,t.worldEnd,t.worldEnd,2)),console.log((Date.now()-n)/1e3),l(!1)}},children:"Generate animation"})}),Object(c.jsxs)(j.a,{children:[Object(c.jsxs)(g.a,{variant:"contained",onClick:function(){return l(!f)},children:["paused: ",f?"yes":"no"]}),f&&Object(c.jsx)(g.a,{variant:"contained",onClick:function(){return o(r+1)},children:"Step"})]})]})},en=e(35),rn=e.n(en),on=new ot.a(123),an=function(t){var n=Object(s.useState)(!0),e=Object(h.a)(n,2),o=e[0],a=e[1],u=Object(s.useState)([]),f=Object(h.a)(u,2),l=f[0],v=f[1],d=function(){if(void 0!==t.world&&void 0!==t.worldPrev&&void 0!==t.worldEnd)if(0===l.length||t.world.bots.map((function(t,n){return r.sub(t.pos,l[0].bots[n].pos)})).map((function(t){return r.dot(t,t)})).reduce((function(t,n){return t+n}),0)>1e-5)v(i.createAnimation(t.worldPrev,t.world,t.worldEnd,t.worldEnd,1));else{var n=l;n.length>1&&(n=n.slice(1)),t.setWorldPrev(t.world),t.setWorld(n[0]),v(n)}};return Object(s.useEffect)((function(){if(!o){var t=setInterval(d,1e3/30);return function(){return clearInterval(t)}}}),[t,o,l]),Object(c.jsxs)(m.a,{children:[Object(c.jsx)(j.a,{children:Object(c.jsxs)(g.a,{variant:"contained",onClick:function(){a(!o)},children:["paused: ",o?"yes":"no"]})}),Object(c.jsx)(j.a,{children:Object(c.jsx)(g.a,{variant:"contained",onClick:function(){void 0!==t.world&&t.setWorld(rn()(t.world,{bots:{$set:t.world.bots.map((function(t){return rn()(t,{pos:{$set:r.add(t.pos,r.multiplyScalar(r.newVec3(on.next()-.5,on.next()-.5,on.next()-.5),2))}})}))}}))},children:"Disturb"})})]})},cn=Object(v.a)((function(t){return{gridItem:{padding:t.spacing(2),textAlign:"center"}}})),sn=function(){var t=cn(),n=Object(s.useState)(void 0),e=Object(h.a)(n,2),r=e[0],o=e[1],a=Object(s.useState)(void 0),i=Object(h.a)(a,2),u=i[0],f=i[1],l=Object(s.useState)(void 0),v=Object(h.a)(l,2),w=v[0],O=v[1],y=Object(s.useState)(void 0),x=Object(h.a)(y,2),M=x[0],A=x[1],E=Object(s.useState)(!1),S=Object(h.a)(E,2),V=S[0],k=S[1];return Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)(d.a,{container:!0,item:!0,xs:11,children:[Object(c.jsx)(d.a,{item:!0,xs:4,style:{height:.9*window.innerHeight,overflowX:"hidden",overflowY:"scroll"},children:Object(c.jsxs)(d.a,{container:!0,direction:"column",children:[Object(c.jsx)("b",{style:{fontSize:20},children:"Microbots"}),Object(c.jsx)(d.a,{item:!0,className:t.gridItem,children:Object(c.jsx)(tn,{onSelect:function(t,n){o(t),f(n),O(t),A(t)}})}),Object(c.jsxs)(d.a,{item:!0,className:t.gridItem,children:[Object(c.jsx)("b",{children:"Animation"}),Object(c.jsx)("br",{}),Object(c.jsx)(p.a,{control:Object(c.jsx)(b.a,{checked:V,onChange:function(t){return k(t.target.checked)}}),label:"Dynamic"}),V?Object(c.jsx)(an,{worldEnd:u,world:w,worldPrev:M,setWorld:O,setWorldPrev:A}):Object(c.jsx)(nn,{worldStart:r,worldEnd:u,setWorld:O})]}),Object(c.jsxs)(d.a,{item:!0,className:t.gridItem,children:[Object(c.jsx)("b",{children:"Extra options"}),Object(c.jsx)(m.a,{children:Object(c.jsx)(j.a,{children:Object(c.jsx)(g.a,{variant:"contained",onClick:function(){return function(){var t=document.getElementsByTagName("canvas")[0].toDataURL("image/png"),n=document.createElement("a");n.href=t.replace(/^data:image\/[^;]/,"data:application/octet-stream"),n.download="image.png",n.click()}()},children:"Save screenshot"})})})]})]})}),Object(c.jsx)(d.a,{item:!0,xs:5,children:Object(c.jsx)(Wt,{world:w})})]})})};l.a.render(Object(c.jsx)(u.a.StrictMode,{children:Object(c.jsx)(sn,{})}),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.2db01bac.chunk.js.map