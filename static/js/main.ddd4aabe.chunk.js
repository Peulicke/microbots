(this.webpackJsonpmicrobots=this.webpackJsonpmicrobots||[]).push([[0],{46:function(t,n,e){"use strict";e.r(n);var r={};e.r(r),e.d(r,"newVec3",(function(){return y})),e.d(r,"clone",(function(){return A})),e.d(r,"add",(function(){return S})),e.d(r,"sub",(function(){return M})),e.d(r,"multiplyScalar",(function(){return B})),e.d(r,"divideScalar",(function(){return E})),e.d(r,"dot",(function(){return V})),e.d(r,"length",(function(){return C}));var o={};e.r(o),e.d(o,"newBot",(function(){return W})),e.d(o,"setPos",(function(){return q})),e.d(o,"setWeight",(function(){return N})),e.d(o,"setFixed",(function(){return R})),e.d(o,"average",(function(){return z}));var u={};e.r(u),e.d(u,"newWorld",(function(){return L})),e.d(u,"setBots",(function(){return U})),e.d(u,"edgeStrength",(function(){return Y})),e.d(u,"stiffness",(function(){return K})),e.d(u,"stiffnessDerivative",(function(){return Q})),e.d(u,"stiffnessPair",(function(){return Z})),e.d(u,"stiffnessPairDerivative",(function(){return $})),e.d(u,"removeFixedFromVector",(function(){return _})),e.d(u,"removeFixedFromMatrix",(function(){return tt})),e.d(u,"stiffnessMatrix",(function(){return nt})),e.d(u,"acceleration",(function(){return et})),e.d(u,"forceMatrix",(function(){return rt})),e.d(u,"displacement",(function(){return ot})),e.d(u,"resolveCollisionStep",(function(){return ut})),e.d(u,"resolveCollision",(function(){return ct})),e.d(u,"gradient",(function(){return it}));var c={};e.r(c),e.d(c,"gradient",(function(){return st})),e.d(c,"optimizeStep",(function(){return ft})),e.d(c,"createAnimation",(function(){return dt}));var i=e(5),a=e(0),s=e.n(a),f=e(11),b=e.n(f),d=e(10),l=e(4),p=e(2),v=e(28),m=e(61),h=e(63),j=e(64),g=e(65),O=e(66),w=e(34),x=e(26),y=function(t,n,e){return[t,n,e]},A=function(t){return[t[0],t[1],t[2]]},S=function(t,n){return[t[0]+n[0],t[1]+n[1],t[2]+n[2]]},M=function(t,n){return[t[0]-n[0],t[1]-n[1],t[2]-n[2]]},B=function(t,n){return[t[0]*n,t[1]*n,t[2]*n]},E=function(t,n){return[t[0]/n,t[1]/n,t[2]/n]},V=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},C=function(t){return Math.sqrt(V(t,t))},k=function(t,n,e){return[t,n,e]},P=function(t,n){return[S(t[0],n[0]),S(t[1],n[1]),S(t[2],n[2])]},F=function(t,n){return[M(t[0],n[0]),M(t[1],n[1]),M(t[2],n[2])]},I=function(t,n){return[B(t[0],n),B(t[1],n),B(t[2],n)]},D=function(t,n){return[V(t[0],n),V(t[1],n),V(t[2],n)]},W=function(){return{pos:y(0,0,0),weight:1,fixed:!1}},q=function(t){return function(n){return n.pos=t,n}},N=function(t){return function(n){return n.weight=t,n}},R=function(t){return function(n){return n.fixed=t,n}},z=function(t,n){var e=W();return e.pos=E(S(t.pos,n.pos),2),e.weight=(t.weight+n.weight)/2,e.fixed=t.fixed||n.fixed,e},J=function(t,n){t.length!==n.length&&function(){throw new Error("Vectors need to be the same length")}();for(var e=0,r=0;r<t.length;++r)e+=t[r]*n[r];return e},T=function(t,n){return Object(l.a)(Array(t)).map((function(){return Object(l.a)(Array(n)).map((function(){return 0}))}))},G=function(t){var n=Object(l.a)(Array(3*t.length)).map((function(){return 0}));return t.map((function(t,e){for(var r=0;r<3;++r)n[3*e+r]=t[r]})),n},H=e(29),L=function(){return{bots:[]}},U=function(t){return function(n){return n.bots=t,n}},X=.1,Y=function(t){return 2/(1+Math.exp(4*(t-1)))},K=function(t){return I((e=t,k(y((n=t)[0]*e[0],n[0]*e[1],n[0]*e[2]),y(n[1]*e[0],n[1]*e[1],n[1]*e[2]),y(n[2]*e[0],n[2]*e[1],n[2]*e[2]))),-Y(C(t))/V(t,t));var n,e},Q=function(t){return function(n){var e=1e-5,r=n[t],o=A(n);o[t]=r+e;var u=A(n);u[t]=r-e;var c=K(o),i=K(u);return I(F(c,i),1/2e-5)}},Z=function(t,n){var e=M(n.pos,t.pos);return K(e)},$=function(t){return function(n){return function(e,r){if(e!==t&&r!==t)return k(y(0,0,0),y(0,0,0),y(0,0,0));var o=Q(n)(M(r.pos,e.pos));return e===t?I(o,-1):o}}},_=function(t){return function(n){return n.map((function(n,e){return t.bots[e].fixed?y(0,0,0):n}))}},tt=function(t){return function(n){return n.map((function(n,e){return n.map((function(n,r){return t.bots[e].fixed||t.bots[r].fixed?k(y(0,0,0),y(0,0,0),y(0,0,0)):n}))}))}},nt=function(t){for(var n=t.bots.map((function(){return t.bots.map((function(){return k(y(0,0,0),y(0,0,0),y(0,0,0))}))})),e=0;e<t.bots.length;++e){var r=I(K(y(t.bots[e].pos[1]+.5,0,0)),X),o=K(y(0,t.bots[e].pos[1]+.5,0)),u=I(K(y(0,0,t.bots[e].pos[1]+.5)),X);n[e][e]=F(n[e][e],r),n[e][e]=F(n[e][e],o),n[e][e]=F(n[e][e],u)}for(var c=0;c<t.bots.length;++c)for(var i=0;i<t.bots.length;++i)if(c!==i){var a=Z(t.bots[c],t.bots[i]);n[c][c]=F(n[c][c],a),n[c][i]=P(n[c][i],a)}return tt(t)(n)},et=function(t,n,e){return function(r){return r.bots.map((function(o,u){var c=E(M(r.bots[u].pos,t.bots[u].pos),e),i=E(M(n.bots[u].pos,r.bots[u].pos),e);return E(M(i,c),e)}))}},rt=function(t,n,e){return function(r){var o=et(t,n,e)(r);return _(r)(r.bots.map((function(t,n){return B(M(y(0,-1,0),o[n]),t.weight)})))}},ot=function(t,n,e){return function(r){var o,u,c=G(rt(t,n,e)(r)),i=function(t){var n,e=T(3*t.length,3*(null===(n=t[0])||void 0===n?void 0:n.length)||0);return t.map((function(n,r){return n.map((function(n,o){for(var u=0;u<3;++u)for(var c=0;c<3;++c)e[3*r+u][3*o+c]=t[r][o][u][c]}))})),e}(nt(r));return o=i,u=c,H.solve(o,u)}},ut=function(t){for(var n=0;n<t.bots.length;++n)t.bots[n].fixed||(t.bots[n].pos[1]=Math.max(t.bots[n].pos[1],.5));for(var e=0;e<t.bots.length;++e)for(var r=e+1;r<t.bots.length;++r)if(!t.bots[e].fixed||!t.bots[r].fixed){var o=t.bots[e].fixed||t.bots[r].fixed,u=M(t.bots[r].pos,t.bots[e].pos),c=C(u);if(!(c>1)){var i=B(u,(1-c)/(o?1:2)/c);t.bots[e].fixed||(t.bots[e].pos=M(t.bots[e].pos,i)),t.bots[r].fixed||(t.bots[r].pos=S(t.bots[r].pos,i))}}return t},ct=function(t){for(var n=t,e=0;e<10;++e)n=ut(n);return n},it=function(t,n,e){return function(r,o,u,c,i){return function(r){for(var o=Object(l.a)(Array(r.bots.length)).map((function(){return y(0,0,0)})),u=Object(l.a)(Array(r.bots.length)).map((function(){return[0,1,2].map((function(){return Object(l.a)(Array(r.bots.length)).map((function(){return y(0,0,0)}))}))})),c=0;c<r.bots.length;++c)for(var a=0;a<3;++a){var s=I(Q(a)(y(r.bots[c].pos[1]+.5,0,0)),X),f=Q(a)(y(0,r.bots[c].pos[1]+.5,0)),b=I(Q(a)(y(0,0,r.bots[c].pos[1]+.5)),X),d=y(n[3*c],n[3*c+1],n[3*c+2]);u[c][a][c]=M(u[c][a][c],D(P(P(s,f),b),d));for(var p=0;p<r.bots.length;++p)if(!(c>=p)){var v=$(r.bots[c])(a)(r.bots[c],r.bots[p]),m=D(v,M(y(n[3*p],n[3*p+1],n[3*p+2]),d));u[c][a][c]=S(u[c][a][c],m),u[c][a][p]=M(u[c][a][p],m),u[p][a][p]=S(u[p][a][p],m),u[p][a][c]=M(u[p][a][c],m)}}for(var h=0;h<r.bots.length;++h)for(var j=0;j<3;++j){var g=G(_(r)(u[h][j]));o[h][j]=-J(n,g)+(2*n[3*h+j]-t[3*h+j]-e[3*h+j])/Math.pow(i,2)*2}return o}}},at=function(t,n){var e=L();return e.bots=t.bots.map((function(t,e){return z(t,n.bots[e])})),e},st=function(t,n){for(var e=Object(l.a)(Array(t.length)).map((function(){return Object(l.a)(Array(t[0].bots.length)).map((function(){return y(0,0,0)}))})),r=Object(l.a)(Array(t.length)).map((function(){return Object(l.a)(Array(3*t[0].bots.length)).map((function(){return 0}))})),o=1;o<t.length-1;++o){var u=t[o-1],c=t[o+1];r[o]=ot(u,c,n)(t[o])}for(var i=1;i<t.length-1;++i){var a=t[Math.max(i-2,0)],s=t[i-1],f=t[i+1],b=t[Math.min(i+2,t.length-1)];e[i]=it(r[i-1],r[i],r[i+1])(a,s,f,b,n)(t[i])}return e},ft=function(t){return function(n,e){var r=st(n,e).map((function(n){return n.map((function(n){return B(n,-t/(1+C(n)))}))}));n.map((function(t,n){return t.bots.map((function(t,e){t.fixed||(t.pos=S(t.pos,r[n][e]))}))})),n.map((function(t){return ct(t)}))}},bt=function(t){for(var n=Object(l.a)(Array(2*t.length-1)),e=0;e<t.length;++e)n[2*e]=t[e];for(var r=1;r<n.length-1;r+=2)n[r]=at(n[r-1],n[r+1]);return n},dt=function(t,n,e){for(var r=[t,n],o=100,u=.1,c=0;c<e;++c){o/=2,u/=2,r=bt(r);for(var i=0;i<30;++i)ft(u)(r,o)}return r},lt=e(27),pt=function(t,n,e){return function(r){var o=new p.h;o.lookAt(Object(lt.a)(p.s,Object(l.a)(t)),Object(lt.a)(p.s,Object(l.a)(n)),(new p.k).up),o.multiply((new p.h).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1)),r.setRotationFromMatrix(o),r.scale.set(e,C(M(n,t)),e);var u=E(S(t,n),2);return r.position.set(u[0],u[1],u[2]),r}},vt=function(t,n,e,r){var o=new p.d(1,1,1,8,1),u=new p.i(o,new p.j({color:r}));return pt(t,n,e)(u)},mt=Object(m.a)((function(t){return{gridItem:{padding:t.spacing(2),textAlign:"center"}}})),ht=Object(x.a)(u.newWorld(),u.setBots([].concat(Object(l.a)(Object(l.a)(Array(3)).map((function(t,n){return[o.setPos(r.newVec3(-4,.5+n,0))(o.newBot()),o.setPos(r.newVec3(4,.5+n,0))(o.newBot())]})).flat()),[o.setPos(r.newVec3(-4,3.5,0))(o.newBot())]))),jt=Object(x.a)(u.newWorld(),u.setBots([].concat(Object(l.a)(Object(l.a)(Array(3)).map((function(t,n){return[o.setPos(r.newVec3(-4,.5+n,0))(o.newBot()),o.setPos(r.newVec3(4,.5+n,0))(o.newBot())]})).flat()),[o.setPos(r.newVec3(4,3.5,0))(o.newBot())]))),gt=c.createAnimation(ht,jt,8),Ot=gt[0].bots.map((function(t){return function(t,n){var e,r=new p.o(1,16,16);r.computeVertexNormals(),r.faces.forEach((function(t){return t.vertexColors=new Array(3).fill(!0).map((function(){return n}))}));var o=(new p.b).fromGeometry(r);delete o.attributes.uv;var u=new p.i(o,new p.j({color:n}));return u.geometry=o,(e=u.position).set.apply(e,Object(l.a)(t)),u.scale.set(.5,.5,.5),u}(t.pos,t.fixed?new p.c(0,0,1):new p.c(0,1,0))})),wt=gt[0].bots.map((function(t){return vt(t.pos,r.newVec3(t.pos[0],0,t.pos[2]),1,new p.c(1,0,0))})),xt=gt[0].bots.map((function(t){return gt[0].bots.map((function(n){return vt(t.pos,n.pos,1,new p.c(1,0,0))}))})),yt=function(){var t=new p.n;t.add(new p.a(16777215,.4));var n=new p.e(16777215,.4);return n.position.set(0,1,0),t.add(n),t}();Ot.map((function(t){return yt.add(t)})),wt.map((function(t){return yt.add(t)})),xt.map((function(t,n){return t.map((function(t,e){n>=e||yt.add(t)}))}));var At=function(t){gt[t].bots.map((function(t,n){var e;(e=Ot[n].position).set.apply(e,Object(l.a)(t.pos))})),gt[t].bots.map((function(t,n){yt.remove(wt[n]);var e=u.edgeStrength(t.pos[1]+.5);e<.01||(yt.add(wt[n]),pt(t.pos,r.newVec3(t.pos[0],0,t.pos[2]),.3*Math.sqrt(e))(wt[n]))})),gt[t].bots.map((function(n,e){return gt[t].bots.map((function(t,o){if(!(e>=o)){yt.remove(xt[e][o]);var c=u.edgeStrength(r.length(r.sub(t.pos,n.pos)));c<.01||(yt.add(xt[e][o]),pt(n.pos,t.pos,.3*Math.sqrt(c))(xt[e][o]))}}))}))},St=function(){var t=Object(w.a)(),n=Object(d.a)(t,2),e=n[0],r=n[1],o=.55*e,u=.9*r,c=mt(),s=Object(a.useRef)(null),f=Object(a.useState)(),b=Object(d.a)(f,2),l=b[0],m=b[1],x=Object(a.useState)(),y=Object(d.a)(x,2),A=y[0],S=y[1],M=Object(a.useState)(),B=Object(d.a)(M,2),E=B[0],V=B[1],C=Object(a.useState)(0),k=Object(d.a)(C,2),P=k[0],F=k[1],I=Object(a.useState)(0),D=Object(d.a)(I,2),W=D[0],q=D[1],N=Object(a.useState)(!1),R=Object(d.a)(N,2),z=R[0],J=R[1];return Object(a.useEffect)((function(){var t=s.current;if(t){var n=new p.l(75,o/u,.1,1e3);n.position.set(10,10,10),n.lookAt(0,0,0),S(n);var e=new p.t({antialias:!0});e.setClearColor("#000000"),e.setSize(o,u),t.appendChild(e.domElement),V(e);var r=new v.a(n,e.domElement);r.enableDamping=!0,r.dampingFactor=.5,m(r);var c=window.setInterval((function(){return F((function(t){return t+1}))}),1e3/30);return function(){window.clearInterval(c),t.removeChild(e.domElement)}}}),[s,o,u]),Object(a.useEffect)((function(){l&&l.update(),E&&A&&E.render(yt,A)}),[l,E,A,P]),Object(a.useEffect)((function(){var t=Math.round(.1*gt.length),n=W%(2*(gt.length+t));n<t?At(0):(n-=t)<gt.length?At(n):(n-=gt.length)<t?At(gt.length-1):(n-=t,At(gt.length-1-n))}),[W]),Object(a.useEffect)((function(){if(z){var t=setInterval((function(){return q((function(t){return t+1}))}),10);return function(){return clearInterval(t)}}}),[z]),Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)(h.a,{container:!0,item:!0,xs:11,children:[Object(i.jsx)(h.a,{item:!0,xs:4,style:{height:.9*window.innerHeight,overflowX:"hidden",overflowY:"scroll"},children:Object(i.jsx)(h.a,{container:!0,direction:"column",children:Object(i.jsx)(h.a,{item:!0,className:c.gridItem,children:Object(i.jsx)(j.a,{children:Object(i.jsxs)(g.a,{children:[Object(i.jsx)(O.a,{children:Object(i.jsx)("b",{children:"Microbots"})}),Object(i.jsx)(O.a,{children:Object(i.jsxs)("button",{onClick:function(){return q(W+1)},children:["Time: ",W]})}),Object(i.jsx)(O.a,{children:Object(i.jsxs)("button",{onClick:function(){return J(!z)},children:["Animating: ",z?"true":"false"]})}),Object(i.jsx)(O.a,{children:Object(i.jsx)("button",{onClick:function(){return function(){var t=document.getElementsByTagName("canvas")[0].toDataURL("image/png"),n=document.createElement("a");n.href=t.replace(/^data:image\/[^;]/,"data:application/octet-stream"),n.download="image.png",n.click()}()},children:"Save screenshot"})})]})})})})}),Object(i.jsx)(h.a,{item:!0,xs:5,children:Object(i.jsx)("div",{ref:s})})]})})};b.a.render(Object(i.jsx)(s.a.StrictMode,{children:Object(i.jsx)(St,{})}),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.ddd4aabe.chunk.js.map