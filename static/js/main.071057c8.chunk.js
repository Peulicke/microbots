(this.webpackJsonpmicrobots=this.webpackJsonpmicrobots||[]).push([[0],{50:function(t,n,r){"use strict";r.r(n);var e={};r.r(e),r.d(e,"newVec3",(function(){return x})),r.d(e,"clone",(function(){return M})),r.d(e,"add",(function(){return A})),r.d(e,"addEq",(function(){return V})),r.d(e,"sub",(function(){return S})),r.d(e,"subEq",(function(){return E})),r.d(e,"multiplyScalar",(function(){return k})),r.d(e,"dot",(function(){return B})),r.d(e,"length",(function(){return C})),r.d(e,"dist",(function(){return I})),r.d(e,"normalize",(function(){return q})),r.d(e,"dir",(function(){return D}));var o={};r.r(o),r.d(o,"newBot",(function(){return G})),r.d(o,"average",(function(){return z})),r.d(o,"interpolate",(function(){return J}));var a={};r.r(a),r.d(a,"newWorld",(function(){return et})),r.d(a,"setBots",(function(){return ot})),r.d(a,"setSlack",(function(){return ct})),r.d(a,"setOffset",(function(){return ut})),r.d(a,"edgeStrength",(function(){return st})),r.d(a,"edgeStrengthGround",(function(){return ft})),r.d(a,"displacement",(function(){return bt})),r.d(a,"neighbors",(function(){return dt})),r.d(a,"gradient",(function(){return mt})),r.d(a,"connections",(function(){return gt}));var i={};r.r(i),r.d(i,"createAnimation",(function(){return Mt}));var c=r(4),u=r(0),s=r.n(u),f=r(13),l=r.n(f),h=r(3),p=r(8),v=r(2),b=r(32),d=r(65),m=r(67),j=r(68),g=r(69),w=r(71),O=r(72),y=r(37),x=function(t,n,r){return[t,n,r]},M=function(t){return[t[0],t[1],t[2]]},A=function(t,n){return[t[0]+n[0],t[1]+n[1],t[2]+n[2]]},V=function(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]},S=function(t,n){return[t[0]-n[0],t[1]-n[1],t[2]-n[2]]},E=function(t,n){t[0]-=n[0],t[1]-=n[1],t[2]-=n[2]},k=function(t,n){return[t[0]*n,t[1]*n,t[2]*n]},B=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},C=function(t){return Math.sqrt(B(t,t))},I=function(t,n){return C(S(t,n))},q=function(t){return k(t,1/C(t))},D=function(t,n){return q(S(t,n))},N=function(t,n){for(var r=0;r<3;++r)for(var e=0;e<3;++e)t[r][e]+=n[r][e]},P=function(t,n){for(var r=0;r<3;++r)for(var e=0;e<3;++e)t[r][e]*=n},T=function(t,n){for(var r=[0,0,0],e=0;e<3;++e)for(var o=0;o<3;++o)r[e]+=t[e][o]*n[o];return r},W=r(23),F=function(t,n){return r=x(t[0]*n[0],t[0]*n[1],t[0]*n[2]),e=x(t[1]*n[0],t[1]*n[1],t[1]*n[2]),o=x(t[2]*n[0],t[2]*n[1],t[2]*n[2]),[r,e,o];var r,e,o},G=function(t){return{pos:t.pos||x(0,0,0),target:t.target||function(){},weight:t.weight||1}},R=function(t,n,r){var e,o,a=r.time>n?1:-1;for(o=n;(r.time-o)*a<=0;o+=.01*a)if(void 0!==(e=t.target(o)))return{pos:e,time:o};return r},z=function(t,n,r,e){var o=(r+e)/2,a=R(t,o,{pos:t.pos,time:r}),i=R(t,o,{pos:n.pos,time:e});if(i.time-a.time<1e-10)return G(Object(W.a)(Object(W.a)({},t),{},{pos:i.pos}));var c=(i.time-o)/(i.time-a.time),u=(o-a.time)/(i.time-a.time),s=A(k(a.pos,c),k(i.pos,u));return Object(W.a)(Object(W.a)({},t),{},{pos:s})},J=function(t,n,r,e,o,a,i){var c=R(t,n,{pos:e,time:n-2*r}),u=R(t,n,{pos:i,time:n+2*r});return u.time-c.time<1e-10?u.pos:(e=c.pos,i=u.pos,c.time>n-r&&(o=c.pos),u.time<n+r&&(a=u.pos),function(t,n,r,e,o){var a=1e-10,i=n.time-t.time,c=o-t.time,u=o-n.time,s=r.time-n.time,f=r.time-o,l=e.time-o,h=i*c+a,p=c*u+a,v=u*s+a,b=s*f+a,d=f*l+a,m=l*(e.time-r.time)+a,j=1/(b*v),g=j+1/Math.pow(p,2)+1/Math.pow(v,2),w=j+1/Math.pow(b,2)+1/Math.pow(d,2),O=-1/(h*p*(g+w)),y=(g+1/(h*p))/(g+w),x=(w+1/(d*m))/(g+w),M=-1/(d*m*(g+w)),V=k(t.pos,O),S=k(n.pos,y),E=k(r.pos,x),B=k(e.pos,M);return A(A(A(V,S),E),B)}({pos:e,time:n-2*r},{pos:o,time:n-r},{pos:a,time:n+r},{pos:i,time:n+2*r},n))},H=function(t,n){for(var r=0;r<t.length;++r)n[r]=t[r]},L=function(t,n){for(var r=0,e=0;e<t.length;++e)r+=t[e]*n[e];return r},U=function(t,n,r){for(var e=0;e<t.length;++e)t[e]+=n[e]*r},X=function(t,n,r){for(var e=0;e<r.length;++e)r[e]=0;for(var o=0;o<t.length;++o)for(var a=0;a<t[o].length;++a){var i=t[o][a][0],c=t[o][a][1];r[o]+=c*n[i],o!==i&&(r[i]+=c*n[o])}},Y=function(t,n){for(var r=0;r<n.length;++r)n[r]*=t[Math.floor(r/3)]},K=function(t,n){var r=Array(n.length);H(n,r);var e=function(t,n){for(var r=Array(n.length/3).fill(0),e=0;e<t.length;++e)for(var o=0;o<t[e].length;++o){var a=Object(p.a)(t[e][o],2),i=a[0],c=a[1];Math.floor(e/3)===Math.floor(i/3)&&(r[Math.floor(e/3)]+=c,e!==i&&(r[Math.floor(i/3)]+=c))}for(var u=0;u<r.length;++u)r[u]=Math.sqrt(Math.sqrt(3/r[u]));return r}(t,r);!function(t,n){for(var r=0;r<n.length;++r)for(var e=0;e<n[r].length;++e){var o=n[r][e][0];n[r][e][1]*=t[Math.floor(r/3)],n[r][e][1]*=t[Math.floor(o/3)]}}(e,t),Y(e,r);var o=function(t,n){var r=Array(n.length).fill(0),e=Array(n.length);H(n,e);var o=Array(n.length);X(t,r,o),U(e,o,-1);var a=Array(e.length),i=Array(a.length);H(e,a);for(var c=L(e,e),u=0;u<20;++u){X(t,a,o);var s=c/L(a,o);U(r,a,s),U(e,o,-s);var f=L(e,e);H(a,i),H(e,a),U(a,i,f/c),c=f}return r}(t,r);return Y(e,o),o},Q=function(t){return((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[2][2]+(t[2][1]*t[4][0]-t[4][1]*t[2][0])*-t[3][2]+(t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[4][2])*t[1][3]+((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[1][2]+(t[1][1]*t[4][0]-t[4][1]*t[1][0])*-t[3][2]+(t[1][1]*t[3][0]-t[3][1]*t[1][0])*t[4][2])*-t[2][3]+((t[2][1]*t[4][0]-t[4][1]*t[2][0])*t[1][2]+(t[1][1]*t[4][0]-t[4][1]*t[1][0])*-t[2][2]+(t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[4][2])*t[3][3]+((t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[1][2]+(t[1][1]*t[3][0]-t[3][1]*t[1][0])*-t[2][2]+(t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[3][2])*-t[4][3]+((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[1][2]+(t[1][1]*t[4][0]-t[4][1]*t[1][0])*-t[3][2]+(t[1][1]*t[3][0]-t[3][1]*t[1][0])*t[4][2])*t[0][3]+((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[3][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*t[4][2])*-t[1][3]+(((t[1][1]*t[4][0]-t[4][1]*t[1][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[4][2])*t[3][3]+((t[1][1]*t[3][0]-t[3][1]*t[1][0])*t[0][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[3][2])*-t[4][3]+((t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[1][2]+(t[1][1]*t[3][0]-t[3][1]*t[1][0])*-t[2][2]+(t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[3][2])*t[0][3]+((t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[0][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*-t[2][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*t[3][2])*-t[1][3]+((t[1][1]*t[3][0]-t[3][1]*t[1][0])*t[0][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[3][2])*t[2][3]+((t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[0][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[2][2])*-t[3][3])-(((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[2][2]+(t[2][1]*t[4][0]-t[4][1]*t[2][0])*-t[3][2]+(t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[4][2])*t[0][3]+((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[3][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*t[4][2])*-t[2][3]+(((t[2][1]*t[4][0]-t[4][1]*t[2][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[2][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*t[4][2])*t[3][3]+((t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[0][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*-t[2][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*t[3][2])*-t[4][3])+(((t[2][1]*t[4][0]-t[4][1]*t[2][0])*t[1][2]+(t[1][1]*t[4][0]-t[4][1]*t[1][0])*-t[2][2]+(t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[4][2])*t[0][3]+((t[2][1]*t[4][0]-t[4][1]*t[2][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[2][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*t[4][2])*-t[1][3]+(((t[1][1]*t[4][0]-t[4][1]*t[1][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[4][2])*t[2][3]+((t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[0][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[2][2])*-t[4][3])))};function Z(t,n,r){this.vertices=t,this.adjacent=n,this.boundary=r,this.lastVisited=-1}function $(t,n,r){this.vertices=t,this.cell=n,this.index=r}function _(t,n){var r=this;this.vertices=t,this.simplices=n,this.interior=n.filter((function(t){return!t.boundary})),this.tuple=Object(h.a)(this.vertices),this.orient=function(){return Q(r.tuple)}}function tt(t,n){this.point=t,this.index=n}function nt(t){var n=t.length;if(0===n)return[];for(var r=new Array(n),e=1,o=0;o<n;++o){for(var a=t[o],i=new Array(4),c=0,u=0;u<3;++u){var s=a[u];i[u]=s,c+=s*s}i[3]=c,r[o]=new tt(i,o),e=Math.max(c,e)}r.sort((function(t,n){for(var r=0;r<5;++r){var e=n.point[r]-t.point[r];if(e)return e}return 0})),n=r.length;for(var f=new Array(n+3+1),l=new Array(n+3+1),h=16*e,p=new Array(4),v=0;v<=3;++v)p[v]=0;p[3]=h,f[0]=p.slice(),l[0]=-1;for(var b=0;b<=3;++b){var d=p.slice();d[b]=1,f[b+1]=d,l[b+1]=-1}for(var m=0;m<n;++m){var j=r[m];f[m+3+1]=j.point,l[m+3+1]=j.index}var g=function(t,n){var r=t.length;if(0===r)throw new Error("Must have at least d+1 points");var e=t[0].length;if(r<=e)throw new Error("Must input at least d+1 points");var o=t.slice(0,e+1),a=Q(o);if(0===a)throw new Error("Input not in general position");for(var i=new Array(e+1),c=0;c<=e;++c)i[c]=c;a<0&&(i[0]=1,i[1]=0);for(var u=new Z(i,new Array(e+1),!1),s=u.adjacent,f=new Array(e+2),l=0;l<=e;++l){for(var h=i.slice(),p=0;p<=e;++p)p===l&&(h[p]=-1);var v=h[0];h[0]=h[1],h[1]=v;var b=new Z(h,new Array(e+1),!0);s[l]=b,f[l]=b}f[e+1]=u;for(var d=0;d<=e;++d)for(var m=s[d].vertices,j=s[d].adjacent,g=0;g<=e;++g){var w=m[g];if(w<0)j[g]=u;else for(var O=0;O<=e;++O)s[O].vertices.indexOf(w)<0&&(j[g]=s[O])}for(var y=new _(o,f),x=!!n,M=e+1;M<r;++M)y.insert(t[M],x);return y.boundary()}(f,!1);g=g.filter((function(t){for(var n=0;n<=3;++n){var r=l[t[n]];if(r<0)return!1;t[n]=r}return!0}));for(var w=0;w<g.length;++w){var O=g[w],y=O[0];O[0]=O[1],O[1]=y}return g}Z.prototype.flip=function(){var t=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=t;var n=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=n},_.prototype.handleBoundaryDegeneracy=function(t,n){var r=this.vertices.length-1,e=this.tuple,o=this.vertices,a=[t];for(t.lastVisited=-r;a.length>0;)for(var i=(t=a.pop()).adjacent,c=0;c<=4;++c){var u=i[c];if(u.boundary&&!(u.lastVisited<=-r)){for(var s=u.vertices,f=0;f<=4;++f){var l=s[f];e[f]=l<0?n:o[l]}var h=this.orient();if(h>0)return u;u.lastVisited=-r,0===h&&a.push(u)}}return null},_.prototype.walk=function(t,n){var r=this.vertices.length-1,e=this.vertices,o=this.tuple,a=n?this.interior.length*Math.random()|0:this.interior.length-1,i=this.interior[a];t:for(;!i.boundary;){for(var c=i.vertices,u=i.adjacent,s=0;s<=4;++s)o[s]=e[c[s]];i.lastVisited=r;for(var f=0;f<=4;++f){var l=u[f];if(!(l.lastVisited>=r)){var h=o[f];o[f]=t;var p=this.orient();if(o[f]=h,p<0){i=l;continue t}l.boundary?l.lastVisited=-r:l.lastVisited=r}}return}return i},_.prototype.addPeaks=function(t,n){var r=this.vertices.length-1,e=this.vertices,o=this.tuple,a=this.interior,i=this.simplices,c=[n];n.lastVisited=r,n.vertices[n.vertices.indexOf(-1)]=r,n.boundary=!1,a.push(n);for(var u=[];c.length>0;){var s=(n=c.pop()).vertices,f=n.adjacent,l=s.indexOf(r);if(!(l<0))for(var h=0;h<=4;++h)if(h!==l){var p=f[h];if(p.boundary&&!(p.lastVisited>=r)){var v=p.vertices;if(p.lastVisited!==-r){for(var b=0,d=0;d<=4;++d)v[d]<0?(b=d,o[d]=t):o[d]=e[v[d]];if(this.orient()>0){v[b]=r,p.boundary=!1,a.push(p),c.push(p),p.lastVisited=r;continue}p.lastVisited=-r}var m=p.adjacent,j=s.slice(),g=f.slice(),w=new Z(j,g,!0);i.push(w);var O=m.indexOf(n);if(!(O<0)){m[O]=w,g[l]=p,j[h]=-1,g[h]=n,f[h]=w,w.flip();for(var y=0;y<=4;++y){var x=j[y];if(!(x<0||x===r)){for(var M=new Array(3),A=0,V=0;V<=4;++V){var S=j[V];S<0||V===y||(M[A++]=S)}u.push(new $(M,w,y))}}}}}}u.sort((function(t,n){return function(t,n){var r=t[0]+t[1],e=n[0]+n[1],o=r+t[2]-(e+n[2]);if(o)return o;var a=Math.min(t[0],t[1]),i=Math.min(n[0],n[1]);return(o=Math.min(a,t[2])-Math.min(i,n[2]))||Math.min(a+t[2],r)-Math.min(i+n[2],e)}(t.vertices,n.vertices)}));for(var E=0;E+1<u.length;E+=2){var k=u[E],B=u[E+1],C=k.index,I=B.index;C<0||I<0||(k.cell.adjacent[k.index]=B.cell,B.cell.adjacent[B.index]=k.cell)}},_.prototype.insert=function(t,n){var r=this.vertices;r.push(t);var e=this.walk(t,n);if(e){for(var o=this.tuple,a=0;a<=4;++a){var i=e.vertices[a];o[a]=i<0?t:r[i]}var c=this.orient(o);c<0||(0!==c||(e=this.handleBoundaryDegeneracy(e,t)))&&this.addPeaks(t,e)}},_.prototype.boundary=function(){for(var t=[],n=this.simplices,r=n.length,e=0;e<r;++e){var o=n[e];if(o.boundary){for(var a=new Array(4),i=o.vertices,c=0,u=0,s=0;s<=4;++s)i[s]>=0?a[c++]=i[s]:u=1&s;if(0===u){var f=a[0];a[0]=a[1],a[1]=f}t.push(a)}}return t};for(var rt=r(27),et=function(){return{bots:[]}},ot=function(t){return function(n){return n.bots=t,n}},at=1.5,it=2,ct=function(t){it=t},ut=function(t){at=t},st=function(t){return t<at-it/2?1:t>at+it/2?0:2*(t+it-at)*Math.pow(at+it/2-t,2)/Math.pow(it,3)},ft=function(t){return st(t)+1e-4},lt=function(t){var n=C(t);return t=k(t,Math.sqrt(st(n))/n),F(t,t)},ht=function(t){var n=F(t,t);return P(n,ft(C(t))/B(t,t)),n},pt=function(t,n){var r=1e-5,e=n[t],o=M(n);o[t]=e+r;var a=M(n);a[t]=e-r;var i=lt(o);return function(t,n){for(var r=0;r<3;++r)for(var e=0;e<3;++e)t[r][e]-=n[r][e]}(i,lt(a)),P(i,1/2e-5),i},vt=function(t,n,r){for(var e=Object(h.a)(Array(3*t.bots.length)).map((function(){return[]})),o=0;o<t.bots.length;++o)for(var a=ht(x(t.bots[o].pos[1]+.5,0,0)),i=ht(x(0,t.bots[o].pos[1]+.5,0)),c=ht(x(0,0,t.bots[o].pos[1]+.5)),u=0;u<3;++u)for(var s=u;s<3;++s)e[3*o+u].push([3*o+s,.1*(a[u][s]+c[u][s])+i[u][s]]);for(var f=function(n){r[n].forEach((function(r){for(var o=function(t,n){var r=S(n.pos,t.pos);return lt(r)}(t.bots[n],t.bots[r]),a=0;a<3;++a)for(var i=0;i<3;++i)e[3*n+a].push([3*r+i,-o[a][i]]),a>i||(e[3*n+a][i-a][1]+=o[a][i],e[3*r+a][i-a][1]+=o[a][i])}))},l=0;l<t.bots.length;++l)f(l);return e},bt=function(t,n,r,e,o,a){var i=function(t,n,r,e){var o=Object(h.a)(Array(3*e.bots.length)).map((function(){return 0}));return e.bots.forEach((function(a,i){for(var c=0;c<3;++c){var u=(e.bots[i].pos[c]-t.bots[i].pos[c])/r,s=((n.bots[i].pos[c]-e.bots[i].pos[c])/r-u)/r;o[3*i+c]=((1===c?-1:0)-s)*a.weight}})),o}(t,n,r,e),c=vt(e,0,a);return K(c,i)},dt=function(t,n,r){return n[r].filter((function(t){return t>r})).filter((function(n){return I(t.bots[r].pos,t.bots[n].pos)<at+it/2}))},mt=function(t,n,r,e,o,a,i,c,u,s,f){for(var l=Object(h.a)(Array(u.bots.length)).map((function(){return[0,1,2].map((function(){return 0}))})),p=function(t){for(var r=function(r){var e=pt(r,x(u.bots[t].pos[1]+.5,0,0));P(e,.1);var o=pt(r,x(0,u.bots[t].pos[1]+.5,0)),a=pt(r,x(0,0,u.bots[t].pos[1]+.5));P(a,.1);var i=x(n[3*t],n[3*t+1],n[3*t+2]);N(e,o),N(e,a);var c=B(i,T(e,i));l[t][r]+=c,s[t].forEach((function(e){var o=function(t,n,r){return pt(n,S(t.pos,r.pos))}(u.bots[t],r,u.bots[e]),a=x(n[3*e],n[3*e+1],n[3*e+2]);E(a,i);var c=T(o,a),s=B(a,c);l[t][r]+=s,l[e][r]-=s}))},e=0;e<3;++e)r(e)},v=0;v<u.bots.length;++v)p(v);for(var b=Object(h.a)(Array(u.bots.length)).map((function(){return x(0,0,0)})),d=0;d<u.bots.length;++d)for(var m=0;m<3;++m)b[d][m]=-l[d][m]+(-t[3*d+m]+2*n[3*d+m]-r[3*d+m])/Math.pow(c,2)*2;for(var j=0;j<u.bots.length;++j)if(!(u.bots[j].pos[1]>.5)){var g=u.bots[j].pos[1]+.5;b[j][1]+=2*(g-2)*2e3}for(var w=function(t){s[t].forEach((function(n){var r=S(u.bots[n].pos,u.bots[t].pos),e=C(r);e>1||(r=k(r,2*(e-2)/e*1e3),E(b[t],r),V(b[n],r))}))},O=0;O<u.bots.length;++O)w(O);for(var y=0;y<u.bots.length;++y){var M=J(u.bots[y],f,c,e.bots[y].pos,o.bots[y].pos,a.bots[y].pos,i.bots[y].pos),A=S(M,u.bots[y].pos);V(b[y],k(A,-.1))}return b},jt=new rt.a(123),gt=function(t){return function(t){var n=nt(t),r=t.map((function(){return{}}));return n.map((function(t){for(var n=0;n<4;++n)for(var e=n+1;e<4;++e)r[t[n]][t[e]]=!0,r[t[e]][t[n]]=!0})),r.map((function(t){return Object.keys(t).map((function(t){return Number(t)}))}))}(t.bots.map((function(t){return A(t.pos,k(x(jt.next()-.5,jt.next()-.5,jt.next()-.5),.1))})))},wt=function(t,n,r,e){var o=et();return o.bots=t.bots.map((function(t,o){return z(t,n.bots[o],r,e)})),o},Ot=function(t,n){var r=Math.floor(50/t.length);if(0!==r)for(var e=1/t.length,o=t.map((function(t){return t.bots.map((function(){return x(0,0,0)}))})),a=t.map((function(t){return gt(t)})),i=t.map((function(t,n){return t.bots.map((function(r,e){return dt(t,a[n],e)}))})),c=function(c){ut(1+20/((1+c/r)*t.length));var u=function(t,n,r,e){for(var o=Object(h.a)(Array(t.length)).map((function(){return Object(h.a)(Array(t[0].bots.length)).map((function(){return x(0,0,0)}))})),a=t.map((function(){return Object(h.a)(Array(3*t[0].bots.length)).map((function(){return 0}))})),i=0;i<t.length;++i){var c=t[Math.max(i-1,0)],u=t[Math.min(i+1,t.length-1)];a[i]=bt(c,u,n,t[i],r[i],e[i])}for(var s=1;s<t.length;++s){var f=t[Math.max(s-2,0)],l=t[s-1],p=t[Math.min(s+1,t.length-1)],v=t[Math.min(s+2,t.length-1)];o[s]=mt(a[s-1],a[s],a[Math.min(s+1,t.length-1)],f,l,p,v,n,t[s],e[s],s/(t.length-1))}return o}(t,n,a,i);u=u.map((function(t){return t.map((function(t){return k(t,-e/(1e-4+C(t)))}))})),t.map((function(n,r){return n.bots.map((function(n,e){var a=n.target(r/(t.length-1));void 0===a?(o[r][e]=A(o[r][e],u[r][e]),o[r][e]=k(o[r][e],.9),n.pos=A(n.pos,o[r][e])):n.pos=M(a)}))}))},u=0;u<r;++u)c(u)},yt=function(t){for(var n=Object(h.a)(Array(2*t.length-1)),r=0;r<t.length;++r)n[2*r]=t[r];for(var e=1;e<n.length-1;e+=2)n[e]=wt(n[e-1],n[e+1],(e-1)/(n.length-1),(e+1)/(n.length-1));return n},xt=function(t,n){var r=Math.floor(100/t.length);if(0!==r)for(var e=t.map((function(t){return gt(t)})),o=0;o<r;++o)for(var a=function(r){var o=t[Math.max(r-2,0)],a=t[r-1],i=t[r],c=t[Math.min(r+1,t.length-1)],u=t[Math.min(r+2,t.length-1)],s=i.bots.map((function(e,i){return J(e,r/(t.length-1),n,o.bots[i].pos,a.bots[i].pos,c.bots[i].pos,u.bots[i].pos)}));i.bots.map((function(t,n){t.pos[1]+=.1*(.5-t.pos[1])/e[r][n].length,e[r][n].map((function(o){if(!(n>=o)){var a=i.bots[o],c=S(a.pos,t.pos),u=C(c),s=u-1,f=k(c,(s>0?.3/(e[r][n].length+e[r][o].length):1)*s/u),l=t.weight+a.weight;V(t.pos,k(f,a.weight/l)),E(a.pos,k(f,t.weight/l))}}))})),i.bots.map((function(e,o){var a=e.target(r/(t.length-1));if(void 0===a){var i=Math.pow(.2,e.weight/n);e.pos=k(e.pos,i),V(e.pos,k(s[o],1-i))}else e.pos=M(a)}))},i=1;i<t.length;++i)a(i)},Mt=function(t,n,r){for(var e=[t,n],o=100,a=0;a<r;++a)console.log("".concat(a," subdivisions")),o/=2,e=yt(e),xt(e,o),Ot(e,o);return console.log("done"),e},At=r(31),Vt=function(){var t=new v.n;t.add(new v.a(16777215,.4));var n=new v.e(16777215,.4);return n.position.set(0,1,0),t.add(n),t},St=function(t,n,r){return function(e){var o=new v.h;o.lookAt(Object(At.a)(v.s,Object(h.a)(t)),Object(At.a)(v.s,Object(h.a)(n)),(new v.k).up),o.multiply((new v.h).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1)),e.setRotationFromMatrix(o),e.scale.set(r,C(S(n,t)),r);var a=k(A(t,n),.5);return e.position.set(a[0],a[1],a[2]),e}},Et=function(t,n,r,e){var o=new v.d(1,1,1,8,1),a=new v.i(o,new v.j({color:e}));return St(t,n,r)(a)},kt=[e.newVec3(0,0,0)],Bt=0;Bt<10;++Bt){var Ct=Math.PI/2*(Bt/10);kt.push(e.newVec3(kt[Bt][0]+Math.cos(Ct),kt[Bt][1]-Math.sin(Ct),0))}for(var It=1;It<11;++It)kt.push(e.newVec3(-kt[It][0],kt[It][1],0));var qt=Math.min.apply(Math,Object(h.a)(kt.map((function(t){return t[1]}))));kt.forEach((function(t,n){return kt[n][1]=kt[n][1]-qt+.5}));for(var Dt={title:"Arc",world:{bots:[].concat(Object(h.a)(Object(h.a)(Array(11)).map((function(t,n){return e.newVec3(n,.5,0)}))),Object(h.a)(Object(h.a)(Array(10)).map((function(t,n){return e.newVec3(-n-1,.5,0)})))).map((function(t,n){return o.newBot({pos:t,target:function(t){if(t>.9999)return kt[n]},weight:1})}))}},Nt=[e.newVec3(0,0,0)],Pt=0;Pt<20;++Pt){var Tt=Math.PI/2*(Pt/20);Nt.push(e.newVec3(Nt[Pt][0]+Math.cos(Tt),Nt[Pt][1]-Math.sin(Tt),0))}for(var Wt=1;Wt<21;++Wt)Nt.push(e.newVec3(-Nt[Wt][0],Nt[Wt][1],0));var Ft=Math.min.apply(Math,Object(h.a)(Nt.map((function(t){return t[1]}))));Nt.forEach((function(t,n){return Nt[n][1]=Nt[n][1]-Ft+.5}));var Gt={title:"Big arc",world:{bots:[].concat(Object(h.a)(Object(h.a)(Array(21)).map((function(t,n){return e.newVec3(n,.5,0)}))),Object(h.a)(Object(h.a)(Array(20)).map((function(t,n){return e.newVec3(-n-1,.5,0)})))).map((function(t,n){return o.newBot({pos:t,target:function(t){if(t>.9999)return Nt[n]},weight:1})}))}},Rt=Object(h.a)(Array(8)).map((function(t,n){return Object(h.a)(Array(8)).map((function(t,r){return e.newVec3(n-3.5,.5,r-3.5)}))})).flat(),zt=Object(h.a)(Array(4)).map((function(t,n){return Object(h.a)(Array(4)).map((function(t,r){return Object(h.a)(Array(4)).map((function(t,o){return e.newVec3(n-1.5,o+.5,r-1.5)}))}))})).flat().flat(),Jt={title:"Big cube",world:{bots:Rt.map((function(t,n){return o.newBot({pos:t,target:function(t){if(t>.9999)return zt[n]},weight:1})}))}},Ht=[[-1.5,.5,-1.5],[-.5,.5,-1.5],[.5,.5,-1.5],[1.5,.5,-1.5],[-1.5,.5,-.5],[-.5,.5,-.5],[.5,.5,-.5],[1.5,.5,-.5],[-1.5,.5,.5],[-.5,.5,.5],[.5,.5,.5],[1.5,.5,.5],[-1.5,.5,1.5],[-.5,.5,1.5],[.5,.5,1.5],[1.5,.5,1.5]],Lt={title:"Cube",world:{bots:[[-.5,.5,-.5],[.5,.5,-.5],[.5,.5,.5],[-.5,.5,.5],[-.5,1.5,-.5],[.5,1.5,-.5],[.5,1.5,.5],[-.5,1.5,.5],[-.5,2.5,-.5],[.5,2.5,-.5],[.5,2.5,.5],[-.5,2.5,.5],[-.5,3.5,-.5],[.5,3.5,-.5],[.5,3.5,.5],[-.5,3.5,.5]].map((function(t,n){return o.newBot({pos:t,target:function(t){if(t>.9999)return Ht[n]},weight:1})}))}},Ut={bots:Object(h.a)(Object(h.a)(Array(5)).map((function(t,n){return o.newBot({pos:[n,.5,0],target:function(t){if(t>.9999)return[0,.5+n,0]},weight:1})})))},Xt=[[2,.5,0],[2,1.5,0],[2,2.5,0],[2,3.5,0],[2,4.5,0],[-2,.5,0],[-2,1.5,0],[-2,2.5,0],[-2,3.5,0],[-2,4.5,0],[-2,5.5,0]],Yt=[{title:"Stack",world:Ut},{title:"Towers",world:{bots:[[2,.5,0],[2,1.5,0],[2,2.5,0],[2,3.5,0],[2,4.5,0],[-2,.5,0],[-2,1.5,0],[-2,2.5,0],[-2,3.5,0],[-2,4.5,0],[2,5.5,0]].map((function(t,n){return o.newBot({pos:t,target:function(t){if(t>.9999)return Xt[n]},weight:1})}))}},{title:"Targets",world:{bots:[].concat(Object(h.a)(Object(h.a)(Array(9)).map((function(t,n){return o.newBot({pos:[n-3.5,.5,0],weight:.3})}))),[o.newBot({pos:[.5,.5,1],target:function(t){return Math.abs(t-.4)<.03?[1,3.5,1]:Math.abs(t-.6)<.03?[-1,3.5,1]:Math.abs(t-.8)<.03?[-1,3.5,-1]:Math.abs(t-1)<.03?[1,3.5,-1]:void 0}})])}},Dt,Gt,Lt,Jt].sort((function(t,n){var r=t.world.bots.length-n.world.bots.length;return 0===r?t.title>n.title?1:-1:r})),Kt=Object(d.a)((function(t){return{gridItem:{padding:t.spacing(2),textAlign:"center"}}})),Qt=function(){var t=Object(y.a)(),n=Object(p.a)(t,2),r=n[0],o=n[1],s=.55*r,f=.9*o,l=Kt(),d=Object(u.useRef)(null),x=Object(u.useState)(),M=Object(p.a)(x,2),A=M[0],V=M[1],S=Object(u.useState)(),E=Object(p.a)(S,2),k=E[0],B=E[1],C=Object(u.useState)(),I=Object(p.a)(C,2),q=I[0],D=I[1],N=Object(u.useState)(0),P=Object(p.a)(N,2),T=P[0],W=P[1],F=Object(u.useState)(0),G=Object(p.a)(F,2),R=G[0],z=G[1],J=Object(u.useState)(!1),H=Object(p.a)(J,2),L=H[0],U=H[1],X=Object(u.useState)(Vt()),Y=Object(p.a)(X,2),K=Y[0],Q=Y[1],Z=Object(u.useState)([]),$=Object(p.a)(Z,2),_=$[0],tt=$[1],nt=Object(u.useState)([]),et=Object(p.a)(nt,2),ot=et[0],at=et[1],it=Object(u.useState)([]),ct=Object(p.a)(it,2),ut=ct[0],st=ct[1],ft=Object(u.useState)([]),lt=Object(p.a)(ft,2),ht=lt[0],pt=lt[1],vt=Object(u.useState)(a.newWorld()),bt=Object(p.a)(vt,2),dt=bt[0],mt=bt[1],jt=Object(u.useState)(a.newWorld()),gt=Object(p.a)(jt,2),wt=gt[0],Ot=gt[1],yt=Object(u.useState)(void 0),xt=Object(p.a)(yt,2),Mt=xt[0],At=xt[1],kt=function(t){ht[t].bots.map((function(t,n){var r;(r=_[n].position).set.apply(r,Object(h.a)(t.pos))})),ht[t].bots.map((function(t,n){K.remove(ot[n]);var r=a.edgeStrength(t.pos[1]+.5);r<.01||(K.add(ot[n]),St(t.pos,e.newVec3(t.pos[0],0,t.pos[2]),.3*Math.sqrt(r))(ot[n]))})),ht[t].bots.map((function(n,r){return ht[t].bots.map((function(t,o){if(!(r>=o)){K.remove(ut[r][o]);var i=a.edgeStrength(e.length(e.sub(t.pos,n.pos)));i<.01||(K.add(ut[r][o]),St(n.pos,t.pos,.3*Math.sqrt(i))(ut[r][o]))}}))}))};return Object(u.useEffect)((function(){0!==ht.length&&(tt(ht[0].bots.map((function(t){return function(t,n){var r,e=new v.o(1,16,16);e.computeVertexNormals(),e.faces.forEach((function(t){return t.vertexColors=new Array(3).fill(!0).map((function(){return n}))}));var o=(new v.b).fromGeometry(e);delete o.attributes.uv;var a=new v.i(o,new v.j({color:n}));return a.geometry=o,(r=a.position).set.apply(r,Object(h.a)(t)),a.scale.set(.5,.5,.5),a}(t.pos,void 0===t.target(1)?new v.c(0,0,1):new v.c(0,1,0))}))),at(ht[0].bots.map((function(t){return Et(t.pos,e.newVec3(t.pos[0],0,t.pos[2]),1,new v.c(1,0,0))}))),st(ht[0].bots.map((function(t){return ht[0].bots.map((function(n){return Et(t.pos,n.pos,1,new v.c(1,0,0))}))}))))}),[ht]),Object(u.useEffect)((function(){var t=Vt();_.map((function(n){return t.add(n)})),ot.map((function(n){return t.add(n)})),ut.map((function(n,r){return n.map((function(n,e){r>=e||t.add(n)}))})),Q(t)}),[_,ot,ut]),Object(u.useEffect)((function(){var t=d.current;if(t){var n=new v.l(75,s/f,.1,1e3);n.position.set(10,10,10),n.lookAt(0,0,0),B(n);var r=new v.t({antialias:!0});r.setClearColor("#000000"),r.setSize(s,f),t.appendChild(r.domElement),D(r);var e=new b.a(n,r.domElement);e.enableDamping=!0,e.dampingFactor=.5,V(e);var o=window.setInterval((function(){return W((function(t){return t+1}))}),1e3/30);return function(){window.clearInterval(o),t.removeChild(r.domElement)}}}),[d,s,f]),Object(u.useEffect)((function(){A&&A.update(),q&&k&&K&&q.render(K,k)}),[A,q,k,T,K]),Object(u.useEffect)((function(){if(0!==_.length){var t=Math.round(.1*ht.length),n=R%(2*(ht.length+t));n<t?kt(0):(n-=t)<ht.length?kt(n):(n-=ht.length)<t?kt(ht.length-1):(n-=t,kt(ht.length-1-n))}}),[R,K]),Object(u.useEffect)((function(){if(L){var t=setInterval((function(){return z((function(t){return t+1}))}),10);return function(){return clearInterval(t)}}}),[L]),Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)(m.a,{container:!0,item:!0,xs:11,children:[Object(c.jsx)(m.a,{item:!0,xs:4,style:{height:.9*window.innerHeight,overflowX:"hidden",overflowY:"scroll"},children:Object(c.jsxs)(m.a,{container:!0,direction:"column",children:[Object(c.jsx)("b",{children:"Microbots"}),Object(c.jsx)(m.a,{item:!0,className:l.gridItem,children:Object(c.jsxs)(j.a,{children:[Object(c.jsx)(g.a,{children:Object(c.jsx)(w.a,{children:Object(c.jsx)("b",{children:"Select an example"})})}),Yt.map((function(t,n){return Object(c.jsxs)(O.a,{variant:"contained",color:Mt===n?"primary":"default",onClick:function(){var t,r=new rt.a(123),o=[Yt[t=n].world,a.setBots(Yt[t].world.bots.map((function(t){return{pos:void 0!==t.target&&t.target(1)||t.pos,target:t.target,weight:t.weight}})))(a.newWorld())],i=Object(p.a)(o,2),c=i[0],u=i[1];console.log(c,u);var s=function(){return e.multiplyScalar(e.newVec3(r.next()-.5,r.next()-.5,r.next()-.5),.1)};c.bots.map((function(t){return t.pos=e.add(t.pos,s())})),u.bots.map((function(t){return t.pos=e.add(t.pos,s())})),mt(c),Ot(u),pt([c,u]),U(!1),At(n)},children:[t.title," (",t.world.bots.length," bots)"]},n)})),Object(c.jsx)("br",{}),Object(c.jsx)("br",{})]})}),Object(c.jsx)(m.a,{item:!0,className:l.gridItem,children:Object(c.jsx)(j.a,{children:Object(c.jsxs)(g.a,{children:[Object(c.jsx)(w.a,{children:Object(c.jsx)("b",{children:"Compute the animation"})}),Object(c.jsx)(w.a,{children:Object(c.jsx)(O.a,{variant:"contained",onClick:function(){var t=Date.now();pt(i.createAnimation(dt,wt,8)),console.log((Date.now()-t)/1e3),U(!0)},children:"Generate animation"})})]})})}),Object(c.jsx)(m.a,{item:!0,className:l.gridItem,children:Object(c.jsx)(j.a,{children:Object(c.jsxs)(g.a,{children:[Object(c.jsx)(w.a,{children:Object(c.jsx)("b",{children:"Extra options"})}),Object(c.jsx)(w.a,{children:Object(c.jsxs)(O.a,{variant:"contained",onClick:function(){return z(R+1)},children:["Time: ",R]})}),Object(c.jsx)(w.a,{children:Object(c.jsxs)(O.a,{variant:"contained",onClick:function(){return U(!L)},children:["Animate: ",L?"true":"false"]})}),Object(c.jsx)(w.a,{children:Object(c.jsx)(O.a,{variant:"contained",onClick:function(){return function(){var t=document.getElementsByTagName("canvas")[0].toDataURL("image/png"),n=document.createElement("a");n.href=t.replace(/^data:image\/[^;]/,"data:application/octet-stream"),n.download="image.png",n.click()}()},children:"Save screenshot"})})]})})})]})}),Object(c.jsx)(m.a,{item:!0,xs:5,children:Object(c.jsx)("div",{ref:d})})]})})};l.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(Qt,{})}),document.getElementById("root"))}},[[50,1,2]]]);
//# sourceMappingURL=main.071057c8.chunk.js.map