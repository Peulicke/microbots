(this.webpackJsonpmicrobots=this.webpackJsonpmicrobots||[]).push([[0],{50:function(t,r,n){"use strict";n.r(r);var e={};n.r(e),n.d(e,"newVec3",(function(){return x})),n.d(e,"clone",(function(){return M})),n.d(e,"add",(function(){return A})),n.d(e,"addEq",(function(){return V})),n.d(e,"sub",(function(){return S})),n.d(e,"subEq",(function(){return E})),n.d(e,"multiplyScalar",(function(){return k})),n.d(e,"dot",(function(){return B})),n.d(e,"length",(function(){return C})),n.d(e,"dist",(function(){return I})),n.d(e,"normalize",(function(){return q})),n.d(e,"dir",(function(){return D}));var a={};n.r(a),n.d(a,"newBot",(function(){return F})),n.d(a,"average",(function(){return G}));var o={};n.r(o),n.d(o,"newWorld",(function(){return tt})),n.d(o,"setBots",(function(){return rt})),n.d(o,"setSlack",(function(){return at})),n.d(o,"setOffset",(function(){return ot})),n.d(o,"edgeStrength",(function(){return it})),n.d(o,"edgeStrengthGround",(function(){return ct})),n.d(o,"displacement",(function(){return vt})),n.d(o,"gradient",(function(){return bt})),n.d(o,"connections",(function(){return pt}));var i={};n.r(i),n.d(i,"createAnimation",(function(){return mt}));var c=n(4),u=n(0),s=n.n(u),f=n(13),l=n.n(f),h=n(3),v=n(8),b=n(2),p=n(31),d=n(65),j=n(67),g=n(68),m=n(69),w=n(71),O=n(72),y=n(37),x=function(t,r,n){return[t,r,n]},M=function(t){return[t[0],t[1],t[2]]},A=function(t,r){return[t[0]+r[0],t[1]+r[1],t[2]+r[2]]},V=function(t,r){t[0]+=r[0],t[1]+=r[1],t[2]+=r[2]},S=function(t,r){return[t[0]-r[0],t[1]-r[1],t[2]-r[2]]},E=function(t,r){t[0]-=r[0],t[1]-=r[1],t[2]-=r[2]},k=function(t,r){return[t[0]*r,t[1]*r,t[2]*r]},B=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},C=function(t){return Math.sqrt(B(t,t))},I=function(t,r){return C(S(t,r))},q=function(t){return k(t,1/C(t))},D=function(t,r){return q(S(t,r))},N=function(t,r){for(var n=0;n<3;++n)for(var e=0;e<3;++e)t[n][e]+=r[n][e]},P=function(t,r){for(var n=0;n<3;++n)for(var e=0;e<3;++e)t[n][e]*=r},T=function(t,r){for(var n=[0,0,0],e=0;e<3;++e)for(var a=0;a<3;++a)n[e]+=t[e][a]*r[a];return n},W=n(29),F=function(t){return{pos:t.pos||x(0,0,0),target:t.target||function(){},weight:t.weight||1}},G=function(t,r){return F(Object(W.a)(Object(W.a)({},t),{},{pos:k(A(t.pos,r.pos),.5)}))},R=function(t,r){return n=x(t[0]*r[0],t[0]*r[1],t[0]*r[2]),e=x(t[1]*r[0],t[1]*r[1],t[1]*r[2]),a=x(t[2]*r[0],t[2]*r[1],t[2]*r[2]),[n,e,a];var n,e,a},z=function(t,r){for(var n=0;n<t.length;++n)r[n]=t[n]},J=function(t,r){for(var n=0,e=0;e<t.length;++e)n+=t[e]*r[e];return n},H=function(t,r,n){for(var e=0;e<t.length;++e)t[e]+=r[e]*n},L=function(t,r,n){for(var e=0;e<n.length;++e)n[e]=0;for(var a=0;a<t.length;++a)for(var o=0;o<t[a].length;++o){var i=t[a][o][0],c=t[a][o][1];n[a]+=c*r[i],a!==i&&(n[i]+=c*r[a])}},U=function(t,r){for(var n=0;n<r.length;++n)r[n]*=t[Math.floor(n/3)]},X=function(t,r){var n=Array(r.length);z(r,n);var e=function(t,r){for(var n=Array(r.length/3).fill(0),e=0;e<t.length;++e)for(var a=0;a<t[e].length;++a){var o=Object(v.a)(t[e][a],2),i=o[0],c=o[1];Math.floor(e/3)===Math.floor(i/3)&&(n[Math.floor(e/3)]+=c,e!==i&&(n[Math.floor(i/3)]+=c))}for(var u=0;u<n.length;++u)n[u]=Math.sqrt(Math.sqrt(3/n[u]));return n}(t,n);!function(t,r){for(var n=0;n<r.length;++n)for(var e=0;e<r[n].length;++e){var a=r[n][e][0];r[n][e][1]*=t[Math.floor(n/3)],r[n][e][1]*=t[Math.floor(a/3)]}}(e,t),U(e,n);var a=function(t,r){var n=Array(r.length).fill(0),e=Array(r.length);z(r,e);var a=Array(r.length);L(t,n,a),H(e,a,-1);var o=Array(e.length),i=Array(o.length);z(e,o);for(var c=J(e,e),u=0;u<20;++u){L(t,o,a);var s=c/J(o,a);H(n,o,s),H(e,a,-s);var f=J(e,e);z(o,i),z(e,o),H(o,i,f/c),c=f}return n}(t,n);return U(e,a),a},Y=function(t){return((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[2][2]+(t[2][1]*t[4][0]-t[4][1]*t[2][0])*-t[3][2]+(t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[4][2])*t[1][3]+((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[1][2]+(t[1][1]*t[4][0]-t[4][1]*t[1][0])*-t[3][2]+(t[1][1]*t[3][0]-t[3][1]*t[1][0])*t[4][2])*-t[2][3]+((t[2][1]*t[4][0]-t[4][1]*t[2][0])*t[1][2]+(t[1][1]*t[4][0]-t[4][1]*t[1][0])*-t[2][2]+(t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[4][2])*t[3][3]+((t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[1][2]+(t[1][1]*t[3][0]-t[3][1]*t[1][0])*-t[2][2]+(t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[3][2])*-t[4][3]+((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[1][2]+(t[1][1]*t[4][0]-t[4][1]*t[1][0])*-t[3][2]+(t[1][1]*t[3][0]-t[3][1]*t[1][0])*t[4][2])*t[0][3]+((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[3][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*t[4][2])*-t[1][3]+(((t[1][1]*t[4][0]-t[4][1]*t[1][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[4][2])*t[3][3]+((t[1][1]*t[3][0]-t[3][1]*t[1][0])*t[0][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[3][2])*-t[4][3]+((t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[1][2]+(t[1][1]*t[3][0]-t[3][1]*t[1][0])*-t[2][2]+(t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[3][2])*t[0][3]+((t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[0][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*-t[2][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*t[3][2])*-t[1][3]+((t[1][1]*t[3][0]-t[3][1]*t[1][0])*t[0][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[3][2])*t[2][3]+((t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[0][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[2][2])*-t[3][3])-(((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[2][2]+(t[2][1]*t[4][0]-t[4][1]*t[2][0])*-t[3][2]+(t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[4][2])*t[0][3]+((t[3][1]*t[4][0]-t[4][1]*t[3][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[3][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*t[4][2])*-t[2][3]+(((t[2][1]*t[4][0]-t[4][1]*t[2][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[2][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*t[4][2])*t[3][3]+((t[2][1]*t[3][0]-t[3][1]*t[2][0])*t[0][2]+(t[0][1]*t[3][0]-t[3][1]*t[0][0])*-t[2][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*t[3][2])*-t[4][3])+(((t[2][1]*t[4][0]-t[4][1]*t[2][0])*t[1][2]+(t[1][1]*t[4][0]-t[4][1]*t[1][0])*-t[2][2]+(t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[4][2])*t[0][3]+((t[2][1]*t[4][0]-t[4][1]*t[2][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[2][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*t[4][2])*-t[1][3]+(((t[1][1]*t[4][0]-t[4][1]*t[1][0])*t[0][2]+(t[0][1]*t[4][0]-t[4][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[4][2])*t[2][3]+((t[1][1]*t[2][0]-t[2][1]*t[1][0])*t[0][2]+(t[0][1]*t[2][0]-t[2][1]*t[0][0])*-t[1][2]+(t[0][1]*t[1][0]-t[1][1]*t[0][0])*t[2][2])*-t[4][3])))};function K(t,r,n){this.vertices=t,this.adjacent=r,this.boundary=n,this.lastVisited=-1}function Q(t,r,n){this.vertices=t,this.cell=r,this.index=n}function Z(t,r){var n=this;this.vertices=t,this.simplices=r,this.interior=r.filter((function(t){return!t.boundary})),this.tuple=Object(h.a)(this.vertices),this.orient=function(){return Y(n.tuple)}}function $(t,r){this.point=t,this.index=r}function _(t){var r=t.length;if(0===r)return[];for(var n=new Array(r),e=1,a=0;a<r;++a){for(var o=t[a],i=new Array(4),c=0,u=0;u<3;++u){var s=o[u];i[u]=s,c+=s*s}i[3]=c,n[a]=new $(i,a),e=Math.max(c,e)}n.sort((function(t,r){for(var n=0;n<5;++n){var e=r.point[n]-t.point[n];if(e)return e}return 0})),r=n.length;for(var f=new Array(r+3+1),l=new Array(r+3+1),h=16*e,v=new Array(4),b=0;b<=3;++b)v[b]=0;v[3]=h,f[0]=v.slice(),l[0]=-1;for(var p=0;p<=3;++p){var d=v.slice();d[p]=1,f[p+1]=d,l[p+1]=-1}for(var j=0;j<r;++j){var g=n[j];f[j+3+1]=g.point,l[j+3+1]=g.index}var m=function(t,r){var n=t.length;if(0===n)throw new Error("Must have at least d+1 points");var e=t[0].length;if(n<=e)throw new Error("Must input at least d+1 points");var a=t.slice(0,e+1),o=Y(a);if(0===o)throw new Error("Input not in general position");for(var i=new Array(e+1),c=0;c<=e;++c)i[c]=c;o<0&&(i[0]=1,i[1]=0);for(var u=new K(i,new Array(e+1),!1),s=u.adjacent,f=new Array(e+2),l=0;l<=e;++l){for(var h=i.slice(),v=0;v<=e;++v)v===l&&(h[v]=-1);var b=h[0];h[0]=h[1],h[1]=b;var p=new K(h,new Array(e+1),!0);s[l]=p,f[l]=p}f[e+1]=u;for(var d=0;d<=e;++d)for(var j=s[d].vertices,g=s[d].adjacent,m=0;m<=e;++m){var w=j[m];if(w<0)g[m]=u;else for(var O=0;O<=e;++O)s[O].vertices.indexOf(w)<0&&(g[m]=s[O])}for(var y=new Z(a,f),x=!!r,M=e+1;M<n;++M)y.insert(t[M],x);return y.boundary()}(f,!1);m=m.filter((function(t){for(var r=0;r<=3;++r){var n=l[t[r]];if(n<0)return!1;t[r]=n}return!0}));for(var w=0;w<m.length;++w){var O=m[w],y=O[0];O[0]=O[1],O[1]=y}return m}K.prototype.flip=function(){var t=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=t;var r=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=r},Z.prototype.handleBoundaryDegeneracy=function(t,r){var n=this.vertices.length-1,e=this.tuple,a=this.vertices,o=[t];for(t.lastVisited=-n;o.length>0;)for(var i=(t=o.pop()).adjacent,c=0;c<=4;++c){var u=i[c];if(u.boundary&&!(u.lastVisited<=-n)){for(var s=u.vertices,f=0;f<=4;++f){var l=s[f];e[f]=l<0?r:a[l]}var h=this.orient();if(h>0)return u;u.lastVisited=-n,0===h&&o.push(u)}}return null},Z.prototype.walk=function(t,r){var n=this.vertices.length-1,e=this.vertices,a=this.tuple,o=r?this.interior.length*Math.random()|0:this.interior.length-1,i=this.interior[o];t:for(;!i.boundary;){for(var c=i.vertices,u=i.adjacent,s=0;s<=4;++s)a[s]=e[c[s]];i.lastVisited=n;for(var f=0;f<=4;++f){var l=u[f];if(!(l.lastVisited>=n)){var h=a[f];a[f]=t;var v=this.orient();if(a[f]=h,v<0){i=l;continue t}l.boundary?l.lastVisited=-n:l.lastVisited=n}}return}return i},Z.prototype.addPeaks=function(t,r){var n=this.vertices.length-1,e=this.vertices,a=this.tuple,o=this.interior,i=this.simplices,c=[r];r.lastVisited=n,r.vertices[r.vertices.indexOf(-1)]=n,r.boundary=!1,o.push(r);for(var u=[];c.length>0;){var s=(r=c.pop()).vertices,f=r.adjacent,l=s.indexOf(n);if(!(l<0))for(var h=0;h<=4;++h)if(h!==l){var v=f[h];if(v.boundary&&!(v.lastVisited>=n)){var b=v.vertices;if(v.lastVisited!==-n){for(var p=0,d=0;d<=4;++d)b[d]<0?(p=d,a[d]=t):a[d]=e[b[d]];if(this.orient()>0){b[p]=n,v.boundary=!1,o.push(v),c.push(v),v.lastVisited=n;continue}v.lastVisited=-n}var j=v.adjacent,g=s.slice(),m=f.slice(),w=new K(g,m,!0);i.push(w);var O=j.indexOf(r);if(!(O<0)){j[O]=w,m[l]=v,g[h]=-1,m[h]=r,f[h]=w,w.flip();for(var y=0;y<=4;++y){var x=g[y];if(!(x<0||x===n)){for(var M=new Array(3),A=0,V=0;V<=4;++V){var S=g[V];S<0||V===y||(M[A++]=S)}u.push(new Q(M,w,y))}}}}}}u.sort((function(t,r){return function(t,r){var n=t[0]+t[1],e=r[0]+r[1],a=n+t[2]-(e+r[2]);if(a)return a;var o=Math.min(t[0],t[1]),i=Math.min(r[0],r[1]);return(a=Math.min(o,t[2])-Math.min(i,r[2]))||Math.min(o+t[2],n)-Math.min(i+r[2],e)}(t.vertices,r.vertices)}));for(var E=0;E+1<u.length;E+=2){var k=u[E],B=u[E+1],C=k.index,I=B.index;C<0||I<0||(k.cell.adjacent[k.index]=B.cell,B.cell.adjacent[B.index]=k.cell)}},Z.prototype.insert=function(t,r){var n=this.vertices;n.push(t);var e=this.walk(t,r);if(e){for(var a=this.tuple,o=0;o<=4;++o){var i=e.vertices[o];a[o]=i<0?t:n[i]}var c=this.orient(a);c<0||(0!==c||(e=this.handleBoundaryDegeneracy(e,t)))&&this.addPeaks(t,e)}},Z.prototype.boundary=function(){for(var t=[],r=this.simplices,n=r.length,e=0;e<n;++e){var a=r[e];if(a.boundary){for(var o=new Array(4),i=a.vertices,c=0,u=0,s=0;s<=4;++s)i[s]>=0?o[c++]=i[s]:u=1&s;if(0===u){var f=o[0];o[0]=o[1],o[1]=f}t.push(o)}}return t};for(var tt=function(){return{bots:[]}},rt=function(t){return function(r){return r.bots=t,r}},nt=1.5,et=2,at=function(t){et=t},ot=function(t){nt=t},it=function(t){return t<nt-et/2?1:t>nt+et/2?0:2*(t+et-nt)*Math.pow(nt+et/2-t,2)/Math.pow(et,3)},ct=function(t){return it(t)+1e-4},ut=function(t){var r=C(t);return t=k(t,Math.sqrt(it(r))/r),R(t,t)},st=function(t){var r=R(t,t);return P(r,ct(C(t))/B(t,t)),r},ft=function(t,r){var n=1e-5,e=r[t],a=M(r);a[t]=e+n;var o=M(r);o[t]=e-n;var i=ut(a);return function(t,r){for(var n=0;n<3;++n)for(var e=0;e<3;++e)t[n][e]-=r[n][e]}(i,ut(o)),P(i,1/2e-5),i},lt=function(t,r){var n=S(r.pos,t.pos);return ut(n)},ht=function(t,r,n){return ft(r,S(t.pos,n.pos))},vt=function(t,r,n,e,a){var o=function(t,r,n,e){var a=Object(h.a)(Array(3*e.bots.length)).map((function(){return 0}));return e.bots.forEach((function(o,i){for(var c=0;c<3;++c){var u=(e.bots[i].pos[c]-t.bots[i].pos[c])/n,s=((r.bots[i].pos[c]-e.bots[i].pos[c])/n-u)/n;a[3*i+c]=((1===c?-1:0)-s)*o.weight}})),a}(t,r,n,e),i=function(t,r){for(var n=Object(h.a)(Array(3*t.bots.length)).map((function(){return[]})),e=0;e<t.bots.length;++e)for(var a=st(x(t.bots[e].pos[1]+.5,0,0)),o=st(x(0,t.bots[e].pos[1]+.5,0)),i=st(x(0,0,t.bots[e].pos[1]+.5)),c=0;c<3;++c)for(var u=c;u<3;++u)n[3*e+c].push([3*e+u,.1*(a[c][u]+i[c][u])+o[c][u]]);for(var s=0;s<t.bots.length;++s)for(var f=s+1;f<t.bots.length;++f){var l=I(t.bots[s].pos,t.bots[f].pos);if(!(l>nt+et/2)&&(!(l>1.5)||r[s].includes(f)))for(var v=lt(t.bots[s],t.bots[f]),b=0;b<3;++b)for(var p=0;p<3;++p)n[3*s+b].push([3*f+p,-v[b][p]]),b>p||(n[3*s+b][p-b][1]+=v[b][p],n[3*f+b][p-b][1]+=v[b][p])}return n}(e,a);return X(i,o)},bt=function(t,r,n,e,a,o,i,c,u,s){for(var f=Object(h.a)(Array(u.bots.length)).map((function(){return[0,1,2].map((function(){return 0}))})),l=0;l<u.bots.length;++l)for(var v=0;v<3;++v){var b=ft(v,x(u.bots[l].pos[1]+.5,0,0));P(b,.1);var p=ft(v,x(0,u.bots[l].pos[1]+.5,0)),d=ft(v,x(0,0,u.bots[l].pos[1]+.5));P(d,.1);var j=x(r[3*l],r[3*l+1],r[3*l+2]);N(b,p),N(b,d);var g=B(j,T(b,j));f[l][v]+=g;for(var m=l+1;m<u.bots.length;++m){var w=I(u.bots[l].pos,u.bots[m].pos);if(!(w>nt+et/2)&&(!(w>1.5)||s[l].includes(m))){var O=ht(u.bots[l],v,u.bots[m]),y=x(r[3*m],r[3*m+1],r[3*m+2]);E(y,j);var M=T(O,y),A=B(y,M);f[l][v]+=A,f[m][v]-=A}}}for(var q=Object(h.a)(Array(u.bots.length)).map((function(){return x(0,0,0)})),D=0;D<u.bots.length;++D)for(var W=0;W<3;++W)q[D][W]=-f[D][W]+(-t[3*D+W]+2*r[3*D+W]-n[3*D+W])/Math.pow(c,2)*2;for(var F=0;F<u.bots.length;++F)if(!(u.bots[F].pos[1]>.5)){var G=u.bots[F].pos[1]+.5;q[F][1]+=2*(G-2)*2e3}for(var R=0;R<u.bots.length;++R)for(var z=R+1;z<u.bots.length;++z){var J=S(u.bots[z].pos,u.bots[R].pos),H=C(J);H>1||(J=k(J,2*(H-2)/H*1e3),E(q[R],J),V(q[z],J))}for(var L=0;L<u.bots.length;++L){var U=k(e.bots[L].pos,2),X=k(a.bots[L].pos,-8),Y=k(u.bots[L].pos,12),K=k(o.bots[L].pos,-8),Q=k(i.bots[L].pos,2);V(U,X),V(U,Y),V(U,K),V(U,Q),V(q[L],k(U,100/Math.pow(c,4)))}return q},pt=function(t){return function(t){var r=_(t),n=t.map((function(){return{}}));return r.map((function(t){for(var r=0;r<4;++r)for(var e=r+1;e<4;++e)n[t[r]][t[e]]=!0,n[t[e]][t[r]]=!0})),n.map((function(t){return Object.keys(t).map((function(t){return Number(t)}))}))}(t.bots.map((function(t){return t.pos})))},dt=function(t,r){var n=tt();return n.bots=t.bots.map((function(t,n){return G(t,r.bots[n])})),n},jt=function(t,r){for(var n=t.map((function(t){return t.bots.map((function(){return x(0,0,0)}))})),e=t.map((function(t){return pt(t)})),a=function(a){a>0&&a%10===0&&(e=t.map((function(t){return pt(t)})));var o=(1+a*t.length/1e3)*t.length;ot(1+20/o);var i=function(t,r,n){for(var e=Object(h.a)(Array(t.length)).map((function(){return Object(h.a)(Array(t[0].bots.length)).map((function(){return x(0,0,0)}))})),a=Object(h.a)(Array(t.length)).map((function(){return Object(h.a)(Array(3*t[0].bots.length)).map((function(){return 0}))})),o=0;o<t.length;++o){var i=t[Math.max(o-1,0)],c=t[Math.min(o+1,t.length-1)];a[o]=vt(i,c,r,t[o],n[o])}for(var u=1;u<t.length;++u){var s=t[Math.max(u-2,0)],f=t[u-1],l=t[Math.min(u+1,t.length-1)],v=t[Math.min(u+2,t.length-1)];e[u]=bt(a[u-1],a[u],a[Math.min(u+1,t.length-1)],s,f,l,v,r,t[u],n[u])}return e}(t,r,e);i=i.map((function(t){return t.map((function(t){return k(t,-.02/(1e-4+C(t)))}))})),t.map((function(r,e){return r.bots.map((function(r,a){var o=r.target(e/(t.length-1));void 0===o?(n[e][a]=A(n[e][a],i[e][a]),n[e][a]=k(n[e][a],.9),r.pos=A(r.pos,n[e][a])):r.pos=o}))}))},o=0;o<1e3/t.length;++o)a(o)},gt=function(t){for(var r=Object(h.a)(Array(2*t.length-1)),n=0;n<t.length;++n)r[2*n]=t[n];for(var e=1;e<r.length-1;e+=2)r[e]=dt(r[e-1],r[e+1]);return r},mt=function(t,r,n){for(var e=[t,r],a=100,o=0;o<n;++o)a/=2,e=gt(e),jt(e,a);return e},wt=n(30),Ot=function(){var t=new b.n;t.add(new b.a(16777215,.4));var r=new b.e(16777215,.4);return r.position.set(0,1,0),t.add(r),t},yt=function(t,r,n){return function(e){var a=new b.h;a.lookAt(Object(wt.a)(b.s,Object(h.a)(t)),Object(wt.a)(b.s,Object(h.a)(r)),(new b.k).up),a.multiply((new b.h).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1)),e.setRotationFromMatrix(a),e.scale.set(n,C(S(r,t)),n);var o=k(A(t,r),.5);return e.position.set(o[0],o[1],o[2]),e}},xt=function(t,r,n,e){var a=new b.d(1,1,1,8,1),o=new b.i(a,new b.j({color:e}));return yt(t,r,n)(o)},Mt=n(32),At=[e.newVec3(0,0,0)],Vt=0;Vt<10;++Vt){var St=Math.PI/2*(Vt/10);At.push(e.newVec3(At[Vt][0]+Math.cos(St),At[Vt][1]-Math.sin(St),0))}for(var Et=1;Et<11;++Et)At.push(e.newVec3(-At[Et][0],At[Et][1],0));var kt=Math.min.apply(Math,Object(h.a)(At.map((function(t){return t[1]}))));At.forEach((function(t,r){return At[r][1]=At[r][1]-kt+.5}));for(var Bt={title:"Arc",world:{bots:[].concat(Object(h.a)(Object(h.a)(Array(11)).map((function(t,r){return e.newVec3(r,.5,0)}))),Object(h.a)(Object(h.a)(Array(10)).map((function(t,r){return e.newVec3(-r-1,.5,0)})))).map((function(t,r){return a.newBot({pos:t,target:function(t){if(t>.9)return At[r]},weight:.01})}))}},Ct=[e.newVec3(0,0,0)],It=0;It<20;++It){var qt=Math.PI/2*(It/20);Ct.push(e.newVec3(Ct[It][0]+Math.cos(qt),Ct[It][1]-Math.sin(qt),0))}for(var Dt=1;Dt<21;++Dt)Ct.push(e.newVec3(-Ct[Dt][0],Ct[Dt][1],0));var Nt=Math.min.apply(Math,Object(h.a)(Ct.map((function(t){return t[1]}))));Ct.forEach((function(t,r){return Ct[r][1]=Ct[r][1]-Nt+.5}));var Pt={title:"Big arc",world:{bots:[].concat(Object(h.a)(Object(h.a)(Array(21)).map((function(t,r){return e.newVec3(r,.5,0)}))),Object(h.a)(Object(h.a)(Array(20)).map((function(t,r){return e.newVec3(-r-1,.5,0)})))).map((function(t,r){return a.newBot({pos:t,target:function(t){if(t>.9)return Ct[r]},weight:.01})}))}},Tt=Object(h.a)(Array(8)).map((function(t,r){return Object(h.a)(Array(8)).map((function(t,n){return e.newVec3(r-3.5,.5,n-3.5)}))})).flat(),Wt=Object(h.a)(Array(4)).map((function(t,r){return Object(h.a)(Array(4)).map((function(t,n){return Object(h.a)(Array(4)).map((function(t,a){return e.newVec3(r-1.5,a+.5,n-1.5)}))}))})).flat().flat(),Ft={title:"Big cube",world:{bots:Tt.map((function(t,r){return a.newBot({pos:t,target:function(t){if(t>.9)return Wt[r]},weight:.01})}))}},Gt=[[-1.5,.5,-1.5],[-.5,.5,-1.5],[.5,.5,-1.5],[1.5,.5,-1.5],[-1.5,.5,-.5],[-.5,.5,-.5],[.5,.5,-.5],[1.5,.5,-.5],[-1.5,.5,.5],[-.5,.5,.5],[.5,.5,.5],[1.5,.5,.5],[-1.5,.5,1.5],[-.5,.5,1.5],[.5,.5,1.5],[1.5,.5,1.5]],Rt={title:"Cube",world:{bots:[[-.5,.5,-.5],[.5,.5,-.5],[.5,.5,.5],[-.5,.5,.5],[-.5,1.5,-.5],[.5,1.5,-.5],[.5,1.5,.5],[-.5,1.5,.5],[-.5,2.5,-.5],[.5,2.5,-.5],[.5,2.5,.5],[-.5,2.5,.5],[-.5,3.5,-.5],[.5,3.5,-.5],[.5,3.5,.5],[-.5,3.5,.5]].map((function(t,r){return a.newBot({pos:t,target:function(t){if(t>.9)return Gt[r]},weight:.01})}))}},zt={bots:Object(h.a)(Object(h.a)(Array(5)).map((function(t,r){return a.newBot({pos:[r,.5,0],target:function(t){if(t>.9)return[0,.5+r,0]},weight:.1})})))},Jt=[[2,.5,0],[2,1.5,0],[2,2.5,0],[2,3.5,0],[2,4.5,0],[-2,.5,0],[-2,1.5,0],[-2,2.5,0],[-2,3.5,0],[-2,4.5,0],[-2,5.5,0]],Ht=[{title:"Stack",world:zt},{title:"Towers",world:{bots:[[2,.5,0],[2,1.5,0],[2,2.5,0],[2,3.5,0],[2,4.5,0],[-2,.5,0],[-2,1.5,0],[-2,2.5,0],[-2,3.5,0],[-2,4.5,0],[2,5.5,0]].map((function(t,r){return a.newBot({pos:t,target:function(t){if(t>.9)return Jt[r]},weight:.02})}))}},{title:"Targets",world:{bots:[].concat(Object(h.a)(Object(h.a)(Array(9)).map((function(t,r){return a.newBot({pos:[r,.5,0],weight:.001})}))),[a.newBot({pos:[4.5,.5,4],target:function(t){return Math.abs(t-.4)<.03?[1,3.5,1]:Math.abs(t-.6)<.03?[-1,3.5,1]:Math.abs(t-.8)<.03?[-1,3.5,-1]:Math.abs(t-1)<.03?[1,3.5,-1]:void 0}})])}},Bt,Pt,Rt,Ft].sort((function(t,r){var n=t.world.bots.length-r.world.bots.length;return 0===n?t.title>r.title?1:-1:n})),Lt=Object(d.a)((function(t){return{gridItem:{padding:t.spacing(2),textAlign:"center"}}})),Ut=function(){var t=Object(y.a)(),r=Object(v.a)(t,2),n=r[0],a=r[1],s=.55*n,f=.9*a,l=Lt(),d=Object(u.useRef)(null),x=Object(u.useState)(),M=Object(v.a)(x,2),A=M[0],V=M[1],S=Object(u.useState)(),E=Object(v.a)(S,2),k=E[0],B=E[1],C=Object(u.useState)(),I=Object(v.a)(C,2),q=I[0],D=I[1],N=Object(u.useState)(0),P=Object(v.a)(N,2),T=P[0],W=P[1],F=Object(u.useState)(0),G=Object(v.a)(F,2),R=G[0],z=G[1],J=Object(u.useState)(!1),H=Object(v.a)(J,2),L=H[0],U=H[1],X=Object(u.useState)(Ot()),Y=Object(v.a)(X,2),K=Y[0],Q=Y[1],Z=Object(u.useState)([]),$=Object(v.a)(Z,2),_=$[0],tt=$[1],rt=Object(u.useState)([]),nt=Object(v.a)(rt,2),et=nt[0],at=nt[1],ot=Object(u.useState)([]),it=Object(v.a)(ot,2),ct=it[0],ut=it[1],st=Object(u.useState)([]),ft=Object(v.a)(st,2),lt=ft[0],ht=ft[1],vt=Object(u.useState)(o.newWorld()),bt=Object(v.a)(vt,2),pt=bt[0],dt=bt[1],jt=Object(u.useState)(o.newWorld()),gt=Object(v.a)(jt,2),mt=gt[0],wt=gt[1],At=Object(u.useState)(void 0),Vt=Object(v.a)(At,2),St=Vt[0],Et=Vt[1],kt=function(t){lt[t].bots.map((function(t,r){var n;(n=_[r].position).set.apply(n,Object(h.a)(t.pos))})),lt[t].bots.map((function(t,r){K.remove(et[r]);var n=o.edgeStrength(t.pos[1]+.5);n<.01||(K.add(et[r]),yt(t.pos,e.newVec3(t.pos[0],0,t.pos[2]),.3*Math.sqrt(n))(et[r]))})),lt[t].bots.map((function(r,n){return lt[t].bots.map((function(t,a){if(!(n>=a)){K.remove(ct[n][a]);var i=o.edgeStrength(e.length(e.sub(t.pos,r.pos)));i<.01||(K.add(ct[n][a]),yt(r.pos,t.pos,.3*Math.sqrt(i))(ct[n][a]))}}))}))};return Object(u.useEffect)((function(){0!==lt.length&&(tt(lt[0].bots.map((function(t){return function(t,r){var n,e=new b.o(1,16,16);e.computeVertexNormals(),e.faces.forEach((function(t){return t.vertexColors=new Array(3).fill(!0).map((function(){return r}))}));var a=(new b.b).fromGeometry(e);delete a.attributes.uv;var o=new b.i(a,new b.j({color:r}));return o.geometry=a,(n=o.position).set.apply(n,Object(h.a)(t)),o.scale.set(.5,.5,.5),o}(t.pos,void 0===t.target(1)?new b.c(0,0,1):new b.c(0,1,0))}))),at(lt[0].bots.map((function(t){return xt(t.pos,e.newVec3(t.pos[0],0,t.pos[2]),1,new b.c(1,0,0))}))),ut(lt[0].bots.map((function(t){return lt[0].bots.map((function(r){return xt(t.pos,r.pos,1,new b.c(1,0,0))}))}))))}),[lt]),Object(u.useEffect)((function(){var t=Ot();_.map((function(r){return t.add(r)})),et.map((function(r){return t.add(r)})),ct.map((function(r,n){return r.map((function(r,e){n>=e||t.add(r)}))})),Q(t)}),[_,et,ct]),Object(u.useEffect)((function(){var t=d.current;if(t){var r=new b.l(75,s/f,.1,1e3);r.position.set(10,10,10),r.lookAt(0,0,0),B(r);var n=new b.t({antialias:!0});n.setClearColor("#000000"),n.setSize(s,f),t.appendChild(n.domElement),D(n);var e=new p.a(r,n.domElement);e.enableDamping=!0,e.dampingFactor=.5,V(e);var a=window.setInterval((function(){return W((function(t){return t+1}))}),1e3/30);return function(){window.clearInterval(a),t.removeChild(n.domElement)}}}),[d,s,f]),Object(u.useEffect)((function(){A&&A.update(),q&&k&&K&&q.render(K,k)}),[A,q,k,T,K]),Object(u.useEffect)((function(){if(0!==_.length){var t=Math.round(.1*lt.length),r=R%(2*(lt.length+t));r<t?kt(0):(r-=t)<lt.length?kt(r):(r-=lt.length)<t?kt(lt.length-1):(r-=t,kt(lt.length-1-r))}}),[R,K]),Object(u.useEffect)((function(){if(L){var t=setInterval((function(){return z((function(t){return t+1}))}),10);return function(){return clearInterval(t)}}}),[L]),Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)(j.a,{container:!0,item:!0,xs:11,children:[Object(c.jsx)(j.a,{item:!0,xs:4,style:{height:.9*window.innerHeight,overflowX:"hidden",overflowY:"scroll"},children:Object(c.jsxs)(j.a,{container:!0,direction:"column",children:[Object(c.jsx)("b",{children:"Microbots"}),Object(c.jsx)(j.a,{item:!0,className:l.gridItem,children:Object(c.jsxs)(g.a,{children:[Object(c.jsx)(m.a,{children:Object(c.jsx)(w.a,{children:Object(c.jsx)("b",{children:"Select an example"})})}),Ht.map((function(t,r){return Object(c.jsxs)(O.a,{variant:"contained",color:St===r?"primary":"default",onClick:function(){var t,n=new Mt.a(123),a=[Ht[t=r].world,o.setBots(Ht[t].world.bots.map((function(t){return{pos:void 0!==t.target&&t.target(1)||t.pos,target:t.target,weight:t.weight}})))(o.newWorld())],i=Object(v.a)(a,2),c=i[0],u=i[1];console.log(c,u);var s=function(){return e.multiplyScalar(e.newVec3(n.next()-.5,n.next()-.5,n.next()-.5),1e-4)};c.bots.map((function(t){return t.pos=e.add(t.pos,s())})),u.bots.map((function(t){return t.pos=e.add(t.pos,s())})),dt(c),wt(u),ht([c,u]),U(!1),Et(r)},children:[t.title," (",t.world.bots.length," bots)"]},r)})),Object(c.jsx)("br",{}),Object(c.jsx)("br",{})]})}),Object(c.jsx)(j.a,{item:!0,className:l.gridItem,children:Object(c.jsx)(g.a,{children:Object(c.jsxs)(m.a,{children:[Object(c.jsx)(w.a,{children:Object(c.jsx)("b",{children:"Compute the animation"})}),Object(c.jsx)(w.a,{children:Object(c.jsx)(O.a,{variant:"contained",onClick:function(){var t=Date.now();ht(i.createAnimation(pt,mt,8)),console.log((Date.now()-t)/1e3),U(!0)},children:"Generate animation"})})]})})}),Object(c.jsx)(j.a,{item:!0,className:l.gridItem,children:Object(c.jsx)(g.a,{children:Object(c.jsxs)(m.a,{children:[Object(c.jsx)(w.a,{children:Object(c.jsx)("b",{children:"Extra options"})}),Object(c.jsx)(w.a,{children:Object(c.jsxs)(O.a,{variant:"contained",onClick:function(){return z(R+1)},children:["Time: ",R]})}),Object(c.jsx)(w.a,{children:Object(c.jsxs)(O.a,{variant:"contained",onClick:function(){return U(!L)},children:["Animate: ",L?"true":"false"]})}),Object(c.jsx)(w.a,{children:Object(c.jsx)(O.a,{variant:"contained",onClick:function(){return function(){var t=document.getElementsByTagName("canvas")[0].toDataURL("image/png"),r=document.createElement("a");r.href=t.replace(/^data:image\/[^;]/,"data:application/octet-stream"),r.download="image.png",r.click()}()},children:"Save screenshot"})})]})})})]})}),Object(c.jsx)(j.a,{item:!0,xs:5,children:Object(c.jsx)("div",{ref:d})})]})})};l.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(Ut,{})}),document.getElementById("root"))}},[[50,1,2]]]);
//# sourceMappingURL=main.75b70189.chunk.js.map