{"version":3,"sources":["core/Vec3.ts","core/Mat3.ts","core/Bot.ts","core/utils.ts","core/conjugateGradientSparse.ts","core/delaunay.js","examples/arc.ts","core/World.ts","core/Animation.ts","draw.ts","examples/bigArc.ts","examples/bigCube.ts","examples/cube.ts","examples/stack.ts","examples/towers.ts","examples/index.ts","examples/targets.ts","App.tsx","index.tsx"],"names":["newVec3","x","y","z","clone","a","add","b","addEq","sub","subEq","multiplyScalar","s","dot","length","Math","sqrt","dist","normalize","dir","i","j","apply","result","newBot","config","pos","Vec3","target","weight","average","t1","t2","t","undefined","targetPrev","targetNext","timePrev","timeNext","totalTime","outerProduct","addVecMultNum","c","matMultVec","A","v","conditionVector","sum","floor","ldiv","bCopy","Array","fill","preconditioner","conditionMatrix","r","Ap","p","pOld","rsold","alpha","rsnew","cg","orient","m","Simplex","vertices","adjacent","boundary","this","lastVisited","GlueFacet","cell","index","Triangulation","simplices","interior","filter","tuple","LiftedPoint","point","triangulate","points","n","lifted","upper","l","max","sort","dpoints","dindex","u","slice","h","hull","randomSearch","Error","d","initialSimplex","o","initialCoords","initialCell","list","verts","adj","k","indexOf","triangles","useRandom","insert","incrementalConvexHull","prototype","flip","handleBoundaryDegeneracy","toVisit","cellAdj","pop","neighbor","nv","vv","push","walk","random","initIndex","outerLoop","cellVerts","prev","addPeaks","tovisit","glueFacets","indexOfN","indexOfNeg1","na","vverts","vadj","ncell","opposite","uu","nface","nptr","l1","m1","l0","min","m0","compareCells","ai","bi","cells","nc","bcell","cv","ptr","parity","newWorld","bots","setBots","world","offset","slack","setSlack","setOffset","edgeStrength","edgeStrengthGround","stiffness","stiffnessGround","Mat3","stiffnessDerivative","dim","epsilon","val","dPlus","dMinus","plus","stiffnessMatrix","con","neigh","map","sx","sy","sz","forEach","stiffnessPair","displacement","before","after","dt","f","bot","v1","acc","forceMatrix","neighbors","gradient","uBefore","uAfter","beforeBefore","afterAfter","udku","vi","stiffnessPairDerivative","vj","svisvj","diff","p1","p2","p3","p4","p5","rng","Prando","connections","tri","Object","keys","key","Number","delaunay","next","start","end","World","Bot","optimize","animation","maxIter","vel","_","iter","g","displacements","subdivide","contract","time","originalPos","dn","createAnimation","console","log","newScene","scene","Scene","AmbientLight","light","DirectionalLight","position","set","updateCylinder","from","to","radius","cylinder","orientation","Matrix4","lookAt","Vector3","Object3D","up","multiply","setRotationFromMatrix","scale","newCylinder","color","edgeGeometry","CylinderGeometry","Mesh","MeshPhongMaterial","arc","angle","PI","cos","sin","example","title","flat","examples","abs","bigArc","cube","bigCube","useStyles","makeStyles","theme","gridItem","padding","spacing","textAlign","App","useWindowSize","windowWidth","windowHeight","width","height","classes","mount","useRef","useState","controls","setControls","camera","setCamera","renderer","setRenderer","frame","setFrame","setTime","animate","setAnimate","setScene","botMeshes","setBotMeshes","groundEdgeMeshes","setGroundEdgeMeshes","edgeMeshes","setEdgeMeshes","setAnimation","worldStart","setWorldStart","worldEnd","setWorldEnd","selectedExample","setSelectedExample","updateWorld","remove","strength","useEffect","geom","SphereGeometry","computeVertexNormals","faces","face","vertexColors","bg","BufferGeometry","fromGeometry","attributes","uv","mesh","geometry","newSphere","Color","scn","row","mc","current","cam","PerspectiveCamera","ren","WebGLRenderer","antialias","setClearColor","setSize","appendChild","domElement","ctrls","OrbitControls","enableDamping","dampingFactor","window","setInterval","clearInterval","removeChild","update","render","pauseFrames","round","Grid","container","item","xs","style","innerHeight","overflowX","overflowY","direction","className","Paper","List","ListItem","Button","variant","onClick","ws","we","rand","Date","now","Animation","image","document","getElementsByTagName","toDataURL","createElement","href","replace","download","click","saveImage","ref","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.470c881a.chunk.js","sourcesContent":["export type Vec3 = [number, number, number];\n\nexport const newVec3 = (x: number, y: number, z: number): Vec3 => [x, y, z];\n\nexport const clone = (a: Vec3): Vec3 => [a[0], a[1], a[2]];\n\nexport const add = (a: Vec3, b: Vec3): Vec3 => [a[0] + b[0], a[1] + b[1], a[2] + b[2]];\n\nexport const addEq = (a: Vec3, b: Vec3): void => {\n    a[0] += b[0];\n    a[1] += b[1];\n    a[2] += b[2];\n};\n\nexport const sub = (a: Vec3, b: Vec3): Vec3 => [a[0] - b[0], a[1] - b[1], a[2] - b[2]];\n\nexport const subEq = (a: Vec3, b: Vec3): void => {\n    a[0] -= b[0];\n    a[1] -= b[1];\n    a[2] -= b[2];\n};\n\nexport const multiplyScalar = (a: Vec3, s: number): Vec3 => [a[0] * s, a[1] * s, a[2] * s];\n\nexport const dot = (a: Vec3, b: Vec3): number => a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n\nexport const length = (a: Vec3): number => Math.sqrt(dot(a, a));\n\nexport const dist = (a: Vec3, b: Vec3): number => length(sub(a, b));\n\nexport const normalize = (a: Vec3): Vec3 => multiplyScalar(a, 1 / length(a));\n\nexport const dir = (a: Vec3, b: Vec3): Vec3 => normalize(sub(a, b));\n","import * as Vec3 from \"./Vec3\";\n\nexport type Mat3 = [Vec3.Vec3, Vec3.Vec3, Vec3.Vec3];\n\nexport const newMat3 = (x: Vec3.Vec3, y: Vec3.Vec3, z: Vec3.Vec3): Mat3 => [x, y, z];\n\nexport const add = (a: Mat3, b: Mat3): void => {\n    for (let i = 0; i < 3; ++i) {\n        for (let j = 0; j < 3; ++j) {\n            a[i][j] += b[i][j];\n        }\n    }\n};\n\nexport const sub = (a: Mat3, b: Mat3): void => {\n    for (let i = 0; i < 3; ++i) {\n        for (let j = 0; j < 3; ++j) {\n            a[i][j] -= b[i][j];\n        }\n    }\n};\n\nexport const multiplyScalar = (a: Mat3, s: number): void => {\n    for (let i = 0; i < 3; ++i) {\n        for (let j = 0; j < 3; ++j) {\n            a[i][j] *= s;\n        }\n    }\n};\n\nexport const apply = (a: Mat3, b: Vec3.Vec3): Vec3.Vec3 => {\n    const result: Vec3.Vec3 = [0, 0, 0];\n    for (let i = 0; i < 3; ++i) {\n        for (let j = 0; j < 3; ++j) {\n            result[i] += a[i][j] * b[j];\n        }\n    }\n    return result;\n};\n","import * as Vec3 from \"./Vec3\";\n\ntype Target = (t: number) => Vec3.Vec3 | undefined;\n\nexport type Bot = {\n    pos: Vec3.Vec3;\n    target: Target;\n    weight: number;\n};\n\nexport const newBot = (config: { pos?: Vec3.Vec3; target?: Target; weight?: number }): Bot => ({\n    pos: config.pos || Vec3.newVec3(0, 0, 0),\n    target: config.target || (() => undefined),\n    weight: config.weight || 1\n});\n\nexport const average = (a: Bot, b: Bot, t1: number, t2: number): Bot => {\n    const t = (t1 + t2) / 2;\n    let pos = a.target(t);\n    if (pos === undefined) {\n        const dt = 0.01;\n        let targetPrev, targetNext, timePrev, timeNext;\n        for (timePrev = t; timePrev >= t1; timePrev -= dt) {\n            targetPrev = a.target(timePrev);\n            if (targetPrev !== undefined) break;\n        }\n        for (timeNext = t; timeNext <= t2; timeNext += dt) {\n            targetNext = a.target(timeNext);\n            if (targetNext !== undefined) break;\n        }\n        if (targetPrev === undefined && targetNext === undefined)\n            pos = Vec3.multiplyScalar(Vec3.add(a.pos, b.pos), 1 / 2);\n        if (targetPrev === undefined && targetNext !== undefined) {\n            const totalTime = timeNext - t1;\n            pos = Vec3.multiplyScalar(\n                Vec3.add(Vec3.multiplyScalar(a.pos, timeNext - t), Vec3.multiplyScalar(targetNext, t - t1)),\n                1 / totalTime\n            );\n        }\n        if (targetPrev !== undefined && targetNext === undefined) {\n            const totalTime = t2 - timePrev;\n            pos = Vec3.multiplyScalar(\n                Vec3.add(Vec3.multiplyScalar(targetPrev, t2 - t), Vec3.multiplyScalar(b.pos, t - timePrev)),\n                1 / totalTime\n            );\n        }\n        if (targetPrev !== undefined && targetNext !== undefined) {\n            const totalTime = timeNext - timePrev;\n            pos = Vec3.multiplyScalar(\n                Vec3.add(Vec3.multiplyScalar(targetPrev, timeNext - t), Vec3.multiplyScalar(targetNext, t - timePrev)),\n                1 / totalTime\n            );\n        }\n    }\n    return newBot({ ...a, pos: pos });\n};\n","import * as Vec3 from \"./Vec3\";\nimport * as Mat3 from \"./Mat3\";\n\nconst throwError = () => {\n    throw new Error(\"Vectors need to be the same length\");\n};\n\nexport const dot = (a: number[], b: number[]): number => {\n    if (a.length !== b.length) throwError();\n    let result = 0;\n    for (let i = 0; i < a.length; ++i) result += a[i] * b[i];\n    return result;\n};\n\nexport const outerProduct = (a: Vec3.Vec3, b: Vec3.Vec3): Mat3.Mat3 =>\n    Mat3.newMat3(\n        Vec3.newVec3(a[0] * b[0], a[0] * b[1], a[0] * b[2]),\n        Vec3.newVec3(a[1] * b[0], a[1] * b[1], a[1] * b[2]),\n        Vec3.newVec3(a[2] * b[0], a[2] * b[1], a[2] * b[2])\n    );\n\nexport const zeros = (height: number, width: number): number[][] =>\n    [...Array(height)].map(() => [...Array(width)].map(() => 0));\n","export type SparseSymmetric = [number, number][][];\n\nconst clone = (a: number[], result: number[]): void => {\n    for (let i = 0; i < a.length; ++i) result[i] = a[i];\n};\n\nconst dot = (a: number[], b: number[]): number => {\n    let result = 0;\n    for (let i = 0; i < a.length; ++i) {\n        result += a[i] * b[i];\n    }\n    return result;\n};\n\nconst addVecMultNum = (a: number[], b: number[], c: number): void => {\n    for (let i = 0; i < a.length; ++i) a[i] += b[i] * c;\n};\n\nconst matMultVec = (A: SparseSymmetric, b: number[], result: number[]): void => {\n    for (let i = 0; i < result.length; ++i) result[i] = 0;\n    for (let i = 0; i < A.length; ++i) {\n        for (let c = 0; c < A[i].length; ++c) {\n            const j = A[i][c][0];\n            const v = A[i][c][1];\n            result[i] += v * b[j];\n            if (i === j) continue;\n            result[j] += v * b[i];\n        }\n    }\n};\n\nconst cg = (A: SparseSymmetric, b: number[]): number[] => {\n    const x = Array(b.length).fill(0);\n    const r = Array(b.length);\n    clone(b, r);\n    const Ap = Array(b.length);\n    matMultVec(A, x, Ap);\n    addVecMultNum(r, Ap, -1);\n    const p = Array(r.length);\n    const pOld = Array(p.length);\n    clone(r, p);\n    let rsold = dot(r, r);\n    for (let i = 0; i < 20; ++i) {\n        matMultVec(A, p, Ap);\n        const alpha = rsold / dot(p, Ap);\n        addVecMultNum(x, p, alpha);\n        addVecMultNum(r, Ap, -alpha);\n        const rsnew = dot(r, r);\n        clone(p, pOld);\n        clone(r, p);\n        addVecMultNum(p, pOld, rsnew / rsold);\n        rsold = rsnew;\n    }\n    return x;\n};\n\nconst preconditioner = (A: SparseSymmetric, b: number[]): number[] => {\n    const sum = Array(b.length / 3).fill(0);\n    for (let i = 0; i < A.length; ++i) {\n        for (let c = 0; c < A[i].length; ++c) {\n            const [j, v] = A[i][c];\n            if (Math.floor(i / 3) !== Math.floor(j / 3)) continue;\n            sum[Math.floor(i / 3)] += v;\n            if (i === j) continue;\n            sum[Math.floor(j / 3)] += v;\n        }\n    }\n    for (let i = 0; i < sum.length; ++i) sum[i] = Math.sqrt(Math.sqrt(3 / sum[i]));\n    return sum;\n};\n\nconst conditionMatrix = (sum: number[], A: SparseSymmetric): void => {\n    for (let i = 0; i < A.length; ++i) {\n        for (let c = 0; c < A[i].length; ++c) {\n            const j = A[i][c][0];\n            A[i][c][1] *= sum[Math.floor(i / 3)];\n            A[i][c][1] *= sum[Math.floor(j / 3)];\n        }\n    }\n};\n\nconst conditionVector = (sum: number[], b: number[]): void => {\n    for (let i = 0; i < b.length; ++i) {\n        b[i] *= sum[Math.floor(i / 3)];\n    }\n};\n\nexport const ldiv = (A: SparseSymmetric, b: number[]): number[] => {\n    const bCopy = Array(b.length);\n    clone(b, bCopy);\n    const sum = preconditioner(A, bCopy);\n    conditionMatrix(sum, A);\n    conditionVector(sum, bCopy);\n    const x = cg(A, bCopy);\n    conditionVector(sum, x);\n    return x;\n};\n","const orient = m =>\n    ((m[3][1] * m[4][0] - m[4][1] * m[3][0]) * m[2][2] +\n        (m[2][1] * m[4][0] - m[4][1] * m[2][0]) * -m[3][2] +\n        (m[2][1] * m[3][0] - m[3][1] * m[2][0]) * m[4][2]) *\n        m[1][3] +\n    ((m[3][1] * m[4][0] - m[4][1] * m[3][0]) * m[1][2] +\n        (m[1][1] * m[4][0] - m[4][1] * m[1][0]) * -m[3][2] +\n        (m[1][1] * m[3][0] - m[3][1] * m[1][0]) * m[4][2]) *\n        -m[2][3] +\n    ((m[2][1] * m[4][0] - m[4][1] * m[2][0]) * m[1][2] +\n        (m[1][1] * m[4][0] - m[4][1] * m[1][0]) * -m[2][2] +\n        (m[1][1] * m[2][0] - m[2][1] * m[1][0]) * m[4][2]) *\n        m[3][3] +\n    ((m[2][1] * m[3][0] - m[3][1] * m[2][0]) * m[1][2] +\n        (m[1][1] * m[3][0] - m[3][1] * m[1][0]) * -m[2][2] +\n        (m[1][1] * m[2][0] - m[2][1] * m[1][0]) * m[3][2]) *\n        -m[4][3] +\n    ((m[3][1] * m[4][0] - m[4][1] * m[3][0]) * m[1][2] +\n        (m[1][1] * m[4][0] - m[4][1] * m[1][0]) * -m[3][2] +\n        (m[1][1] * m[3][0] - m[3][1] * m[1][0]) * m[4][2]) *\n        m[0][3] +\n    ((m[3][1] * m[4][0] - m[4][1] * m[3][0]) * m[0][2] +\n        (m[0][1] * m[4][0] - m[4][1] * m[0][0]) * -m[3][2] +\n        (m[0][1] * m[3][0] - m[3][1] * m[0][0]) * m[4][2]) *\n        -m[1][3] +\n    (((m[1][1] * m[4][0] - m[4][1] * m[1][0]) * m[0][2] +\n        (m[0][1] * m[4][0] - m[4][1] * m[0][0]) * -m[1][2] +\n        (m[0][1] * m[1][0] - m[1][1] * m[0][0]) * m[4][2]) *\n        m[3][3] +\n        ((m[1][1] * m[3][0] - m[3][1] * m[1][0]) * m[0][2] +\n            (m[0][1] * m[3][0] - m[3][1] * m[0][0]) * -m[1][2] +\n            (m[0][1] * m[1][0] - m[1][1] * m[0][0]) * m[3][2]) *\n            -m[4][3] +\n        ((m[2][1] * m[3][0] - m[3][1] * m[2][0]) * m[1][2] +\n            (m[1][1] * m[3][0] - m[3][1] * m[1][0]) * -m[2][2] +\n            (m[1][1] * m[2][0] - m[2][1] * m[1][0]) * m[3][2]) *\n            m[0][3] +\n        ((m[2][1] * m[3][0] - m[3][1] * m[2][0]) * m[0][2] +\n            (m[0][1] * m[3][0] - m[3][1] * m[0][0]) * -m[2][2] +\n            (m[0][1] * m[2][0] - m[2][1] * m[0][0]) * m[3][2]) *\n            -m[1][3] +\n        ((m[1][1] * m[3][0] - m[3][1] * m[1][0]) * m[0][2] +\n            (m[0][1] * m[3][0] - m[3][1] * m[0][0]) * -m[1][2] +\n            (m[0][1] * m[1][0] - m[1][1] * m[0][0]) * m[3][2]) *\n            m[2][3] +\n        ((m[1][1] * m[2][0] - m[2][1] * m[1][0]) * m[0][2] +\n            (m[0][1] * m[2][0] - m[2][1] * m[0][0]) * -m[1][2] +\n            (m[0][1] * m[1][0] - m[1][1] * m[0][0]) * m[2][2]) *\n            -m[3][3]) -\n    (((m[3][1] * m[4][0] - m[4][1] * m[3][0]) * m[2][2] +\n        (m[2][1] * m[4][0] - m[4][1] * m[2][0]) * -m[3][2] +\n        (m[2][1] * m[3][0] - m[3][1] * m[2][0]) * m[4][2]) *\n        m[0][3] +\n        ((m[3][1] * m[4][0] - m[4][1] * m[3][0]) * m[0][2] +\n            (m[0][1] * m[4][0] - m[4][1] * m[0][0]) * -m[3][2] +\n            (m[0][1] * m[3][0] - m[3][1] * m[0][0]) * m[4][2]) *\n            -m[2][3] +\n        (((m[2][1] * m[4][0] - m[4][1] * m[2][0]) * m[0][2] +\n            (m[0][1] * m[4][0] - m[4][1] * m[0][0]) * -m[2][2] +\n            (m[0][1] * m[2][0] - m[2][1] * m[0][0]) * m[4][2]) *\n            m[3][3] +\n            ((m[2][1] * m[3][0] - m[3][1] * m[2][0]) * m[0][2] +\n                (m[0][1] * m[3][0] - m[3][1] * m[0][0]) * -m[2][2] +\n                (m[0][1] * m[2][0] - m[2][1] * m[0][0]) * m[3][2]) *\n                -m[4][3]) +\n        (((m[2][1] * m[4][0] - m[4][1] * m[2][0]) * m[1][2] +\n            (m[1][1] * m[4][0] - m[4][1] * m[1][0]) * -m[2][2] +\n            (m[1][1] * m[2][0] - m[2][1] * m[1][0]) * m[4][2]) *\n            m[0][3] +\n            ((m[2][1] * m[4][0] - m[4][1] * m[2][0]) * m[0][2] +\n                (m[0][1] * m[4][0] - m[4][1] * m[0][0]) * -m[2][2] +\n                (m[0][1] * m[2][0] - m[2][1] * m[0][0]) * m[4][2]) *\n                -m[1][3] +\n            (((m[1][1] * m[4][0] - m[4][1] * m[1][0]) * m[0][2] +\n                (m[0][1] * m[4][0] - m[4][1] * m[0][0]) * -m[1][2] +\n                (m[0][1] * m[1][0] - m[1][1] * m[0][0]) * m[4][2]) *\n                m[2][3] +\n                ((m[1][1] * m[2][0] - m[2][1] * m[1][0]) * m[0][2] +\n                    (m[0][1] * m[2][0] - m[2][1] * m[0][0]) * -m[1][2] +\n                    (m[0][1] * m[1][0] - m[1][1] * m[0][0]) * m[2][2]) *\n                    -m[4][3])));\n\n//Ranks a pair of cells up to permutation\nfunction compareCells(a, b) {\n    const l1 = a[0] + a[1];\n    const m1 = b[0] + b[1];\n    let d = l1 + a[2] - (m1 + b[2]);\n    if (d) return d;\n    const l0 = Math.min(a[0], a[1]);\n    const m0 = Math.min(b[0], b[1]);\n    d = Math.min(l0, a[2]) - Math.min(m0, b[2]);\n    if (d) return d;\n    return Math.min(l0 + a[2], l1) - Math.min(m0 + b[2], m1);\n}\n\nfunction Simplex(vertices, adjacent, boundary) {\n    this.vertices = vertices;\n    this.adjacent = adjacent;\n    this.boundary = boundary;\n    this.lastVisited = -1;\n}\n\nSimplex.prototype.flip = function () {\n    const t = this.vertices[0];\n    this.vertices[0] = this.vertices[1];\n    this.vertices[1] = t;\n    const u = this.adjacent[0];\n    this.adjacent[0] = this.adjacent[1];\n    this.adjacent[1] = u;\n};\n\nfunction GlueFacet(vertices, cell, index) {\n    this.vertices = vertices;\n    this.cell = cell;\n    this.index = index;\n}\n\nfunction Triangulation(vertices, simplices) {\n    this.vertices = vertices;\n    this.simplices = simplices;\n    this.interior = simplices.filter(c => !c.boundary);\n    this.tuple = [...this.vertices];\n    this.orient = () => orient(this.tuple);\n}\n\n//Degenerate situation where we are on boundary, but coplanar to face\nTriangulation.prototype.handleBoundaryDegeneracy = function (cell, point) {\n    const d = 4;\n    const n = this.vertices.length - 1;\n    const tuple = this.tuple;\n    const verts = this.vertices;\n\n    //Dumb solution: Just do dfs from boundary cell until we find any peak, or terminate\n    const toVisit = [cell];\n    cell.lastVisited = -n;\n    while (toVisit.length > 0) {\n        cell = toVisit.pop();\n        const cellAdj = cell.adjacent;\n        for (let i = 0; i <= d; ++i) {\n            const neighbor = cellAdj[i];\n            if (!neighbor.boundary || neighbor.lastVisited <= -n) continue;\n            const nv = neighbor.vertices;\n            for (let j = 0; j <= d; ++j) {\n                const vv = nv[j];\n                if (vv < 0) tuple[j] = point;\n                else tuple[j] = verts[vv];\n            }\n            const o = this.orient();\n            if (o > 0) return neighbor;\n            neighbor.lastVisited = -n;\n            if (o === 0) toVisit.push(neighbor);\n        }\n    }\n    return null;\n};\n\nTriangulation.prototype.walk = function (point, random) {\n    //Alias local properties\n    const n = this.vertices.length - 1;\n    const verts = this.vertices;\n    const tuple = this.tuple;\n\n    //Compute initial jump cell\n    const initIndex = random ? (this.interior.length * Math.random()) | 0 : this.interior.length - 1;\n    let cell = this.interior[initIndex];\n\n    //Start walking\n    outerLoop: while (!cell.boundary) {\n        const cellVerts = cell.vertices;\n        const cellAdj = cell.adjacent;\n\n        for (let i = 0; i <= 4; ++i) {\n            tuple[i] = verts[cellVerts[i]];\n        }\n        cell.lastVisited = n;\n\n        //Find farthest adjacent cell\n        for (let i = 0; i <= 4; ++i) {\n            const neighbor = cellAdj[i];\n            if (neighbor.lastVisited >= n) continue;\n            const prev = tuple[i];\n            tuple[i] = point;\n            const o = this.orient();\n            tuple[i] = prev;\n            if (o < 0) {\n                cell = neighbor;\n                continue outerLoop;\n            }\n            if (!neighbor.boundary) neighbor.lastVisited = n;\n            else neighbor.lastVisited = -n;\n        }\n        return;\n    }\n\n    return cell;\n};\n\nTriangulation.prototype.addPeaks = function (point, cell) {\n    const n = this.vertices.length - 1;\n    const verts = this.vertices;\n    const tuple = this.tuple;\n    const interior = this.interior;\n    const simplices = this.simplices;\n\n    //Walking finished at boundary, time to add peaks\n    const tovisit = [cell];\n\n    //Stretch initial boundary cell into a peak\n    cell.lastVisited = n;\n    cell.vertices[cell.vertices.indexOf(-1)] = n;\n    cell.boundary = false;\n    interior.push(cell);\n\n    //Record a list of all new boundaries created by added peaks so we can glue them together when we are all done\n    const glueFacets = [];\n\n    //Do a traversal of the boundary walking outward from starting peak\n    while (tovisit.length > 0) {\n        //Pop off peak and walk over adjacent cells\n        cell = tovisit.pop();\n        const cellVerts = cell.vertices;\n        const cellAdj = cell.adjacent;\n        const indexOfN = cellVerts.indexOf(n);\n        if (indexOfN < 0) continue;\n\n        for (let i = 0; i <= 4; ++i) {\n            if (i === indexOfN) continue;\n\n            //For each boundary neighbor of the cell\n            const neighbor = cellAdj[i];\n            if (!neighbor.boundary || neighbor.lastVisited >= n) continue;\n\n            const nv = neighbor.vertices;\n\n            //Test if neighbor is a peak\n            if (neighbor.lastVisited !== -n) {\n                //Compute orientation of p relative to each boundary peak\n                let indexOfNeg1 = 0;\n                for (let j = 0; j <= 4; ++j) {\n                    if (nv[j] < 0) {\n                        indexOfNeg1 = j;\n                        tuple[j] = point;\n                    } else tuple[j] = verts[nv[j]];\n                }\n                const o = this.orient();\n\n                //Test if neighbor cell is also a peak\n                if (o > 0) {\n                    nv[indexOfNeg1] = n;\n                    neighbor.boundary = false;\n                    interior.push(neighbor);\n                    tovisit.push(neighbor);\n                    neighbor.lastVisited = n;\n                    continue;\n                }\n                neighbor.lastVisited = -n;\n            }\n\n            const na = neighbor.adjacent;\n\n            //Otherwise, replace neighbor with new face\n            const vverts = cellVerts.slice();\n            const vadj = cellAdj.slice();\n            const ncell = new Simplex(vverts, vadj, true);\n            simplices.push(ncell);\n\n            //Connect to neighbor\n            const opposite = na.indexOf(cell);\n            if (opposite < 0) continue;\n\n            na[opposite] = ncell;\n            vadj[indexOfN] = neighbor;\n\n            //Connect to cell\n            vverts[i] = -1;\n            vadj[i] = cell;\n            cellAdj[i] = ncell;\n\n            //Flip facet\n            ncell.flip();\n\n            //Add to glue list\n            for (let j = 0; j <= 4; ++j) {\n                const uu = vverts[j];\n                if (uu < 0 || uu === n) continue;\n                let nface = new Array(3);\n                let nptr = 0;\n                for (let k = 0; k <= 4; ++k) {\n                    const vv = vverts[k];\n                    if (vv < 0 || k === j) continue;\n                    nface[nptr++] = vv;\n                }\n                glueFacets.push(new GlueFacet(nface, ncell, j));\n            }\n        }\n    }\n\n    //Glue boundary facets together\n    glueFacets.sort((a, b) => compareCells(a.vertices, b.vertices));\n\n    for (let i = 0; i + 1 < glueFacets.length; i += 2) {\n        const a = glueFacets[i];\n        const b = glueFacets[i + 1];\n        const ai = a.index;\n        const bi = b.index;\n        if (ai < 0 || bi < 0) continue;\n        a.cell.adjacent[a.index] = b.cell;\n        b.cell.adjacent[b.index] = a.cell;\n    }\n};\n\nTriangulation.prototype.insert = function (point, random) {\n    //Add point\n    const verts = this.vertices;\n    verts.push(point);\n\n    let cell = this.walk(point, random);\n    if (!cell) return;\n\n    //Alias local properties\n    const tuple = this.tuple;\n\n    //Degenerate case: If point is coplanar to cell, then walk until we find a non-degenerate boundary\n    for (let i = 0; i <= 4; ++i) {\n        const vv = cell.vertices[i];\n        if (vv < 0) tuple[i] = point;\n        else tuple[i] = verts[vv];\n    }\n    const o = this.orient(tuple);\n    if (o < 0) return;\n    if (o === 0) {\n        cell = this.handleBoundaryDegeneracy(cell, point);\n        if (!cell) return;\n    }\n\n    //Add peaks\n    this.addPeaks(point, cell);\n};\n\n//Extract all boundary cells\nTriangulation.prototype.boundary = function () {\n    const d = 4;\n    const boundary = [];\n    const cells = this.simplices;\n    const nc = cells.length;\n    for (let i = 0; i < nc; ++i) {\n        const c = cells[i];\n        if (c.boundary) {\n            const bcell = new Array(d);\n            const cv = c.vertices;\n            let ptr = 0;\n            let parity = 0;\n            for (let j = 0; j <= d; ++j) {\n                if (cv[j] >= 0) {\n                    bcell[ptr++] = cv[j];\n                } else {\n                    parity = j & 1;\n                }\n            }\n            if (parity === (d & 1)) {\n                const t = bcell[0];\n                bcell[0] = bcell[1];\n                bcell[1] = t;\n            }\n            boundary.push(bcell);\n        }\n    }\n    return boundary;\n};\n\nfunction incrementalConvexHull(points, randomSearch) {\n    const n = points.length;\n    if (n === 0) {\n        throw new Error(\"Must have at least d+1 points\");\n    }\n    const d = points[0].length;\n    if (n <= d) {\n        throw new Error(\"Must input at least d+1 points\");\n    }\n\n    //FIXME: This could be degenerate, but need to select d+1 non-coplanar points to bootstrap process\n    const initialSimplex = points.slice(0, d + 1);\n\n    //Make sure initial simplex is positively oriented\n    const o = orient(initialSimplex);\n    if (o === 0) {\n        throw new Error(\"Input not in general position\");\n    }\n    const initialCoords = new Array(d + 1);\n    for (let i = 0; i <= d; ++i) {\n        initialCoords[i] = i;\n    }\n    if (o < 0) {\n        initialCoords[0] = 1;\n        initialCoords[1] = 0;\n    }\n\n    //Create initial topological index, glue pointers together (kind of messy)\n    const initialCell = new Simplex(initialCoords, new Array(d + 1), false);\n    const boundary = initialCell.adjacent;\n    const list = new Array(d + 2);\n    for (let i = 0; i <= d; ++i) {\n        const verts = initialCoords.slice();\n        for (let j = 0; j <= d; ++j) {\n            if (j === i) verts[j] = -1;\n        }\n        const t = verts[0];\n        verts[0] = verts[1];\n        verts[1] = t;\n        const cell = new Simplex(verts, new Array(d + 1), true);\n        boundary[i] = cell;\n        list[i] = cell;\n    }\n    list[d + 1] = initialCell;\n    for (let i = 0; i <= d; ++i) {\n        const verts = boundary[i].vertices;\n        const adj = boundary[i].adjacent;\n        for (let j = 0; j <= d; ++j) {\n            const v = verts[j];\n            if (v < 0) {\n                adj[j] = initialCell;\n                continue;\n            }\n            for (let k = 0; k <= d; ++k) {\n                if (boundary[k].vertices.indexOf(v) < 0) {\n                    adj[j] = boundary[k];\n                }\n            }\n        }\n    }\n\n    //Initialize triangles\n    const triangles = new Triangulation(initialSimplex, list);\n\n    //Insert remaining points\n    const useRandom = !!randomSearch;\n    for (let i = d + 1; i < n; ++i) {\n        triangles.insert(points[i], useRandom);\n    }\n\n    //Extract boundary cells\n    return triangles.boundary();\n}\n\nfunction LiftedPoint(p, i) {\n    this.point = p;\n    this.index = i;\n}\n\nfunction triangulate(points) {\n    let n = points.length;\n    if (n === 0) return [];\n\n    //Lift points, sort\n    const lifted = new Array(n);\n    let upper = 1.0;\n    for (let i = 0; i < n; ++i) {\n        const p = points[i];\n        const x = new Array(3 + 1);\n        let l = 0.0;\n        for (let j = 0; j < 3; ++j) {\n            const v = p[j];\n            x[j] = v;\n            l += v * v;\n        }\n        x[3] = l;\n        lifted[i] = new LiftedPoint(x, i);\n        upper = Math.max(l, upper);\n    }\n    lifted.sort((a, b) => {\n        for (let i = 0; i < 5; ++i) {\n            const s = b.point[i] - a.point[i];\n            if (s) return s;\n        }\n        return 0;\n    });\n\n    //Double points\n    n = lifted.length;\n\n    //Create new list of points\n    const dpoints = new Array(n + 3 + 1);\n    const dindex = new Array(n + 3 + 1);\n\n    //Add steiner points at top\n    const u = (3 + 1) * (3 + 1) * upper;\n    const y = new Array(3 + 1);\n    for (let i = 0; i <= 3; ++i) {\n        y[i] = 0.0;\n    }\n    y[3] = u;\n\n    dpoints[0] = y.slice();\n    dindex[0] = -1;\n\n    for (let i = 0; i <= 3; ++i) {\n        const x = y.slice();\n        x[i] = 1;\n        dpoints[i + 1] = x;\n        dindex[i + 1] = -1;\n    }\n\n    //Copy rest of the points over\n    for (let i = 0; i < n; ++i) {\n        const h = lifted[i];\n        dpoints[i + 3 + 1] = h.point;\n        dindex[i + 3 + 1] = h.index;\n    }\n\n    //Construct convex hull\n    let hull = incrementalConvexHull(dpoints, false);\n    hull = hull.filter(function (cell) {\n        for (let i = 0; i <= 3; ++i) {\n            const v = dindex[cell[i]];\n            if (v < 0) {\n                return false;\n            }\n            cell[i] = v;\n        }\n        return true;\n    });\n\n    for (let i = 0; i < hull.length; ++i) {\n        const h = hull[i];\n        const x = h[0];\n        h[0] = h[1];\n        h[1] = x;\n    }\n\n    return hull;\n}\n\nexport default points => {\n    const tri = triangulate(points);\n    const connections = points.map(() => ({}));\n    tri.map(t => {\n        for (let i = 0; i < 4; ++i) {\n            for (let j = i + 1; j < 4; ++j) {\n                connections[t[i]][t[j]] = true;\n                connections[t[j]][t[i]] = true;\n            }\n        }\n    });\n    return connections.map(con => Object.keys(con).map(key => Number(key)));\n};\n","import { Vec3, Bot, World } from \"../core\";\n\nconst n = 10;\n\nconst arc = [Vec3.newVec3(0, 0, 0)];\n\nfor (let i = 0; i < n; ++i) {\n    const angle = (Math.PI / 2) * (i / n);\n    arc.push(Vec3.newVec3(arc[i][0] + Math.cos(angle), arc[i][1] - Math.sin(angle), 0));\n}\n\nfor (let i = 1; i < n + 1; ++i) {\n    arc.push(Vec3.newVec3(-arc[i][0], arc[i][1], 0));\n}\n\nconst m = Math.min(...arc.map(p => p[1]));\n\narc.forEach((_, i) => (arc[i][1] = arc[i][1] - m + 0.5));\n\nconst start = [\n    ...[...Array(n + 1)].map((_, i) => Vec3.newVec3(i, 0.5, 0)),\n    ...[...Array(n)].map((_, i) => Vec3.newVec3(-i - 1, 0.5, 0))\n];\n\nconst world: World.World = {\n    bots: start.map(\n        (pos, i): Bot.Bot =>\n            Bot.newBot({\n                pos: pos,\n                target: t => {\n                    if (t > 0.9999) return arc[i];\n                },\n                weight: 0.01\n            })\n    )\n};\n\nconst example: { title: string; world: World.World } = {\n    title: \"Arc\",\n    world: world\n};\n\nexport default example;\n","import * as Vec3 from \"./Vec3\";\nimport * as Mat3 from \"./Mat3\";\nimport { outerProduct } from \"./utils\";\nimport { SparseSymmetric, ldiv } from \"./conjugateGradientSparse\";\nimport * as Bot from \"./Bot\";\nimport delaunay from \"./delaunay\";\nimport Prando from \"prando\";\n\nexport type World = { bots: Bot.Bot[] };\n\nexport const newWorld = (): World => ({ bots: [] });\n\nexport const setBots = (bots: Bot.Bot[]) => (world: World): World => {\n    world.bots = bots;\n    return world;\n};\n\nlet offset = 1.5;\nlet slack = 2;\nexport const setSlack = (s: number): void => {\n    slack = s;\n};\nexport const setOffset = (o: number): void => {\n    offset = o;\n};\nconst friction = 0.1;\n\nexport const edgeStrength = (d: number): number => {\n    if (d < offset - slack / 2) return 1;\n    if (d > offset + slack / 2) return 0;\n    return (2 * (d + slack - offset) * (offset + slack / 2 - d) ** 2) / slack ** 3;\n};\n\nexport const edgeStrengthGround = (d: number): number => edgeStrength(d) + 1e-4;\n\nconst stiffness = (d: Vec3.Vec3): Mat3.Mat3 => {\n    const l = Vec3.length(d);\n    d = Vec3.multiplyScalar(d, Math.sqrt(edgeStrength(l)) / l);\n    return outerProduct(d, d);\n};\n\nconst stiffnessGround = (d: Vec3.Vec3): Mat3.Mat3 => {\n    const result = outerProduct(d, d);\n    Mat3.multiplyScalar(result, edgeStrengthGround(Vec3.length(d)) / Vec3.dot(d, d));\n    return result;\n};\n\nconst stiffnessDerivative = (dim: number, d: Vec3.Vec3): Mat3.Mat3 => {\n    const epsilon = 0.00001;\n    const val = d[dim];\n    const dPlus = Vec3.clone(d);\n    dPlus[dim] = val + epsilon;\n    const dMinus = Vec3.clone(d);\n    dMinus[dim] = val - epsilon;\n    const plus = stiffness(dPlus);\n    const minus = stiffness(dMinus);\n    Mat3.sub(plus, minus);\n    Mat3.multiplyScalar(plus, 1 / (2 * epsilon));\n    return plus;\n};\n\nconst stiffnessPair = (a: Bot.Bot, b: Bot.Bot): Mat3.Mat3 => {\n    const d = Vec3.sub(b.pos, a.pos);\n    return stiffness(d);\n};\n\nconst stiffnessPairDerivative = (a: Bot.Bot, dim: number, b: Bot.Bot): Mat3.Mat3 =>\n    stiffnessDerivative(dim, Vec3.sub(a.pos, b.pos));\n\nconst stiffnessMatrix = (world: World, con: number[][], neigh: number[][]): SparseSymmetric => {\n    const result: SparseSymmetric = [...Array(world.bots.length * 3)].map(() => []);\n    for (let i = 0; i < world.bots.length; ++i) {\n        const sx = stiffnessGround(Vec3.newVec3(world.bots[i].pos[1] + 0.5, 0, 0));\n        const sy = stiffnessGround(Vec3.newVec3(0, world.bots[i].pos[1] + 0.5, 0));\n        const sz = stiffnessGround(Vec3.newVec3(0, 0, world.bots[i].pos[1] + 0.5));\n        for (let k = 0; k < 3; ++k) {\n            for (let l = k; l < 3; ++l) {\n                result[3 * i + k].push([3 * i + l, (sx[k][l] + sz[k][l]) * friction + sy[k][l]]);\n            }\n        }\n    }\n    for (let i = 0; i < world.bots.length; ++i) {\n        neigh[i].forEach(j => {\n            const s = stiffnessPair(world.bots[i], world.bots[j]);\n            for (let k = 0; k < 3; ++k) {\n                for (let l = 0; l < 3; ++l) {\n                    result[3 * i + k].push([3 * j + l, -s[k][l]]);\n                    if (k > l) continue;\n                    result[3 * i + k][l - k][1] += s[k][l];\n                    result[3 * j + k][l - k][1] += s[k][l];\n                }\n            }\n        });\n    }\n    return result;\n};\n\nconst forceMatrix = (before: World, after: World, dt: number, world: World): number[] => {\n    const result = [...Array(world.bots.length * 3)].map(() => 0);\n    world.bots.forEach((bot, i) => {\n        for (let j = 0; j < 3; ++j) {\n            const v1 = (world.bots[i].pos[j] - before.bots[i].pos[j]) / dt;\n            const v2 = (after.bots[i].pos[j] - world.bots[i].pos[j]) / dt;\n            const acc = (v2 - v1) / dt;\n            result[3 * i + j] = ((j === 1 ? -1 : 0) - acc) * bot.weight;\n        }\n    });\n    return result;\n};\n\nexport const displacement = (\n    before: World,\n    after: World,\n    dt: number,\n    world: World,\n    con: number[][],\n    neigh: number[][]\n): number[] => {\n    const f = forceMatrix(before, after, dt, world);\n    const k = stiffnessMatrix(world, con, neigh);\n    return ldiv(k, f);\n};\n\nexport const neighbors = (world: World, con: number[][], n: number): number[] =>\n    con[n]\n        .filter(i => i > n)\n        .filter(i => {\n            const d = Vec3.dist(world.bots[n].pos, world.bots[i].pos);\n            return d < offset + slack / 2;\n        });\n\nexport const gradient = (\n    uBefore: number[],\n    u: number[],\n    uAfter: number[],\n    beforeBefore: World,\n    before: World,\n    after: World,\n    afterAfter: World,\n    dt: number,\n    world: World,\n    neigh: number[][]\n): Vec3.Vec3[] => {\n    const udku = [...Array(world.bots.length)].map(() => [0, 1, 2].map(() => 0));\n    for (let i = 0; i < world.bots.length; ++i) {\n        for (let dim = 0; dim < 3; ++dim) {\n            const sx = stiffnessDerivative(dim, Vec3.newVec3(world.bots[i].pos[1] + 0.5, 0, 0));\n            Mat3.multiplyScalar(sx, friction);\n            const sy = stiffnessDerivative(dim, Vec3.newVec3(0, world.bots[i].pos[1] + 0.5, 0));\n            const sz = stiffnessDerivative(dim, Vec3.newVec3(0, 0, world.bots[i].pos[1] + 0.5));\n            Mat3.multiplyScalar(sz, friction);\n            const vi = Vec3.newVec3(u[3 * i], u[3 * i + 1], u[3 * i + 2]);\n            Mat3.add(sx, sy);\n            Mat3.add(sx, sz);\n            const d = Vec3.dot(vi, Mat3.apply(sx, vi));\n            udku[i][dim] += d;\n            neigh[i].forEach(j => {\n                const s = stiffnessPairDerivative(world.bots[i], dim, world.bots[j]);\n                const vj = Vec3.newVec3(u[3 * j], u[3 * j + 1], u[3 * j + 2]);\n                Vec3.subEq(vj, vi);\n                const svisvj = Mat3.apply(s, vj);\n                const diff = Vec3.dot(vj, svisvj);\n                udku[i][dim] += diff;\n                udku[j][dim] -= diff;\n            });\n        }\n    }\n    const result = [...Array(world.bots.length)].map(() => Vec3.newVec3(0, 0, 0));\n    for (let i = 0; i < world.bots.length; ++i) {\n        for (let dim = 0; dim < 3; ++dim) {\n            result[i][dim] =\n                -udku[i][dim] + 2 * ((-uBefore[3 * i + dim] + 2 * u[3 * i + dim] - uAfter[3 * i + dim]) / dt ** 2);\n        }\n    }\n    const overlapPenalty = 1000;\n    for (let i = 0; i < world.bots.length; ++i) {\n        if (world.bots[i].pos[1] > 0.5) continue;\n        const l = world.bots[i].pos[1] + 0.5;\n        result[i][1] += 2 * overlapPenalty * (2 * (l - 2));\n    }\n    for (let i = 0; i < world.bots.length; ++i) {\n        neigh[i].forEach(j => {\n            let d = Vec3.sub(world.bots[j].pos, world.bots[i].pos);\n            const l = Vec3.length(d);\n            if (l > 1) return;\n            d = Vec3.multiplyScalar(d, overlapPenalty * ((2 * (l - 2)) / l));\n            Vec3.subEq(result[i], d);\n            Vec3.addEq(result[j], d);\n        });\n    }\n    for (let i = 0; i < world.bots.length; ++i) {\n        const p1 = Vec3.multiplyScalar(beforeBefore.bots[i].pos, 2);\n        const p2 = Vec3.multiplyScalar(before.bots[i].pos, -8);\n        const p3 = Vec3.multiplyScalar(world.bots[i].pos, 12);\n        const p4 = Vec3.multiplyScalar(after.bots[i].pos, -8);\n        const p5 = Vec3.multiplyScalar(afterAfter.bots[i].pos, 2);\n        Vec3.addEq(p1, p2);\n        Vec3.addEq(p1, p3);\n        Vec3.addEq(p1, p4);\n        Vec3.addEq(p1, p5);\n        Vec3.addEq(result[i], Vec3.multiplyScalar(p1, 100 / dt ** 4));\n    }\n    return result;\n};\n\nconst rng = new Prando(123);\n\nconst rand = () => Vec3.multiplyScalar(Vec3.newVec3(rng.next() - 0.5, rng.next() - 0.5, rng.next() - 0.5), 0.1);\n\nexport const connections = (world: World): number[][] => delaunay(world.bots.map(bot => Vec3.add(bot.pos, rand())));\n","import * as Vec3 from \"./Vec3\";\nimport * as Bot from \"./Bot\";\nimport * as World from \"./World\";\n\nconst average = (start: World.World, end: World.World, t1: number, t2: number): World.World => {\n    const result = World.newWorld();\n    result.bots = start.bots.map((b, i) => Bot.average(b, end.bots[i], t1, t2));\n    return result;\n};\n\nconst gradient = (\n    animation: World.World[],\n    dt: number,\n    connections: number[][][],\n    neighbors: number[][][]\n): Vec3.Vec3[][] => {\n    const result = [...Array(animation.length)].map(() =>\n        [...Array(animation[0].bots.length)].map(() => Vec3.newVec3(0, 0, 0))\n    );\n    const displacements = animation.map(() => [...Array(3 * animation[0].bots.length)].map(() => 0));\n    for (let i = 0; i < animation.length; ++i) {\n        const before = animation[Math.max(i - 1, 0)];\n        const after = animation[Math.min(i + 1, animation.length - 1)];\n        displacements[i] = World.displacement(before, after, dt, animation[i], connections[i], neighbors[i]);\n    }\n    for (let i = 1; i < animation.length; ++i) {\n        const beforeBefore = animation[Math.max(i - 2, 0)];\n        const before = animation[i - 1];\n        const after = animation[Math.min(i + 1, animation.length - 1)];\n        const afterAfter = animation[Math.min(i + 2, animation.length - 1)];\n        result[i] = World.gradient(\n            displacements[i - 1],\n            displacements[i],\n            displacements[Math.min(i + 1, animation.length - 1)],\n            beforeBefore,\n            before,\n            after,\n            afterAfter,\n            dt,\n            animation[i],\n            neighbors[i]\n        );\n    }\n    return result;\n};\n\nconst optimize = (animation: World.World[], dt: number): void => {\n    const n = 20;\n    const maxIter = Math.floor(n / animation.length);\n    if (maxIter === 0) return;\n    const acc = 1 / animation.length;\n    const vel = animation.map(world => world.bots.map(() => Vec3.newVec3(0, 0, 0)));\n    const connections = animation.map(world => World.connections(world));\n    const neighbors = animation.map((world, i) => world.bots.map((_, j) => World.neighbors(world, connections[i], j)));\n    for (let iter = 0; iter < maxIter; ++iter) {\n        World.setOffset(1 + 5 / ((1 + iter / maxIter) * animation.length));\n        let g = gradient(animation, dt, connections, neighbors);\n        g = g.map(world => world.map(v => Vec3.multiplyScalar(v, -acc / (1e-4 + Vec3.length(v)))));\n        animation.map((world, i) =>\n            world.bots.map((bot, j) => {\n                const target = bot.target(i / (animation.length - 1));\n                if (target !== undefined) {\n                    bot.pos = target;\n                    return;\n                }\n                vel[i][j] = Vec3.add(vel[i][j], g[i][j]);\n                vel[i][j] = Vec3.multiplyScalar(vel[i][j], 0.9);\n                bot.pos = Vec3.add(bot.pos, vel[i][j]);\n            })\n        );\n    }\n};\n\nconst subdivide = (animation: World.World[]): World.World[] => {\n    const result = [...Array(animation.length * 2 - 1)];\n    for (let i = 0; i < animation.length; ++i) result[2 * i] = animation[i];\n    for (let i = 1; i < result.length - 1; i += 2)\n        result[i] = average(result[i - 1], result[i + 1], (i - 1) / (result.length - 1), (i + 1) / (result.length - 1));\n    return result;\n};\n\nconst contract = (animation: World.World[]): void => {\n    const n = 50;\n    const maxIter = Math.floor(n / animation.length);\n    if (maxIter === 0) return;\n    const connections = animation.map(world => World.connections(world));\n    for (let iter = 0; iter < maxIter; ++iter) {\n        for (let time = 1; time < animation.length - 1; ++time) {\n            const beforeBefore = animation[Math.max(time - 2, 0)];\n            const before = animation[time - 1];\n            const world = animation[time];\n            const after = animation[time + 1];\n            const afterAfter = animation[Math.min(time + 2, animation.length - 1)];\n            const originalPos = world.bots.map((bot, i) => {\n                const p1 = Vec3.multiplyScalar(beforeBefore.bots[i].pos, -1);\n                const p2 = Vec3.multiplyScalar(before.bots[i].pos, 4);\n                const p4 = Vec3.multiplyScalar(after.bots[i].pos, 4);\n                const p5 = Vec3.multiplyScalar(afterAfter.bots[i].pos, -1);\n                Vec3.addEq(p1, p2);\n                Vec3.addEq(p1, p4);\n                Vec3.addEq(p1, p5);\n                return Vec3.multiplyScalar(p1, 1 / 6);\n            });\n            world.bots.map(a => {\n                a.pos[1] += 0.01 * (0.5 - a.pos[1]);\n            });\n            world.bots.map((a, i) => {\n                connections[time][i].map(j => {\n                    if (i >= j) return;\n                    const b = world.bots[j];\n                    const d = Vec3.sub(b.pos, a.pos);\n                    const l = Vec3.length(d);\n                    const l1 = l - 1;\n                    const dn = Vec3.multiplyScalar(\n                        d,\n                        ((l1 > 0 ? 0.2 / (connections[time][i].length + connections[time][j].length) : 1) * l1) / l\n                    );\n                    const m = a.weight + b.weight;\n                    Vec3.addEq(a.pos, Vec3.multiplyScalar(dn, b.weight / m));\n                    Vec3.subEq(b.pos, Vec3.multiplyScalar(dn, a.weight / m));\n                });\n            });\n            world.bots.map((bot, i) => {\n                const target = bot.target(time / (animation.length - 1));\n                if (target !== undefined) {\n                    bot.pos = target;\n                    return;\n                }\n                const w = 0.1;\n                bot.pos = Vec3.multiplyScalar(bot.pos, w);\n                Vec3.addEq(bot.pos, Vec3.multiplyScalar(originalPos[i], 1 - w));\n            });\n        }\n    }\n};\n\nexport const createAnimation = (before: World.World, after: World.World, n: number): World.World[] => {\n    let result = [before, after];\n    let dt = 100;\n    for (let i = 0; i < n; ++i) {\n        console.log(`${i} subdivisions`);\n        dt /= 2;\n        result = subdivide(result);\n        contract(result);\n        optimize(result, dt);\n    }\n    console.log(\"done\");\n    return result;\n};\n","import {\n    Vector3,\n    Scene,\n    AmbientLight,\n    DirectionalLight,\n    Matrix4,\n    SphereGeometry,\n    Color,\n    BufferGeometry,\n    Mesh,\n    MeshPhongMaterial,\n    CylinderGeometry,\n    Object3D\n} from \"three\";\nimport * as Vec3 from \"./core/Vec3\";\n\nexport const newScene = (): Scene => {\n    const scene = new Scene();\n    scene.add(new AmbientLight(0xffffff, 0.4));\n    const light = new DirectionalLight(0xffffff, 0.4);\n    light.position.set(0, 1, 0);\n    scene.add(light);\n    return scene;\n};\n\nexport const newSphere = (pos: Vec3.Vec3, color: Color): Mesh => {\n    const geom = new SphereGeometry(1, 16, 16);\n    geom.computeVertexNormals();\n    geom.faces.forEach(face => (face.vertexColors = new Array(3).fill(true).map(() => color)));\n    const bg = new BufferGeometry().fromGeometry(geom);\n    delete bg.attributes.uv;\n    const mesh = new Mesh(bg, new MeshPhongMaterial({ color: color }));\n    mesh.geometry = bg;\n    mesh.position.set(...pos);\n    mesh.scale.set(0.5, 0.5, 0.5);\n    return mesh;\n};\n\nexport const updateCylinder = (from: Vec3.Vec3, to: Vec3.Vec3, radius: number) => (cylinder: Mesh): Mesh => {\n    const orientation = new Matrix4();\n    orientation.lookAt(new Vector3(...from), new Vector3(...to), new Object3D().up);\n    orientation.multiply(new Matrix4().set(1, 0, 0, 0, 0, 0, 1, 0, 0, -1, 0, 0, 0, 0, 0, 1));\n    cylinder.setRotationFromMatrix(orientation);\n    cylinder.scale.set(radius, Vec3.length(Vec3.sub(to, from)), radius);\n    const pos = Vec3.multiplyScalar(Vec3.add(from, to), 1 / 2);\n    cylinder.position.set(pos[0], pos[1], pos[2]);\n    return cylinder;\n};\n\nexport const newCylinder = (from: Vec3.Vec3, to: Vec3.Vec3, radius: number, color: Color): Mesh => {\n    const edgeGeometry = new CylinderGeometry(1, 1, 1, 8, 1);\n    const cylinder = new Mesh(edgeGeometry, new MeshPhongMaterial({ color: color }));\n    return updateCylinder(from, to, radius)(cylinder);\n};\n","import { Vec3, Bot, World } from \"../core\";\n\nconst n = 20;\n\nconst arc = [Vec3.newVec3(0, 0, 0)];\n\nfor (let i = 0; i < n; ++i) {\n    const angle = (Math.PI / 2) * (i / n);\n    arc.push(Vec3.newVec3(arc[i][0] + Math.cos(angle), arc[i][1] - Math.sin(angle), 0));\n}\n\nfor (let i = 1; i < n + 1; ++i) {\n    arc.push(Vec3.newVec3(-arc[i][0], arc[i][1], 0));\n}\n\nconst m = Math.min(...arc.map(p => p[1]));\n\narc.forEach((_, i) => (arc[i][1] = arc[i][1] - m + 0.5));\n\nconst start = [\n    ...[...Array(n + 1)].map((_, i) => Vec3.newVec3(i, 0.5, 0)),\n    ...[...Array(n)].map((_, i) => Vec3.newVec3(-i - 1, 0.5, 0))\n];\n\nconst world: World.World = {\n    bots: start.map(\n        (pos, i): Bot.Bot =>\n            Bot.newBot({\n                pos: pos,\n                target: t => {\n                    if (t > 0.9999) return arc[i];\n                },\n                weight: 0.01\n            })\n    )\n};\n\nconst example: { title: string; world: World.World } = {\n    title: \"Big arc\",\n    world: world\n};\n\nexport default example;\n","import { Vec3, Bot, World } from \"../core\";\n\nconst start = [...Array(8)].map((_, i) => [...Array(8)].map((_, j) => Vec3.newVec3(i - 3.5, 0.5, j - 3.5))).flat();\nconst end = [...Array(4)]\n    .map((_, i) => [...Array(4)].map((_, j) => [...Array(4)].map((_, k) => Vec3.newVec3(i - 1.5, k + 0.5, j - 1.5))))\n    .flat()\n    .flat();\n\nconst world: World.World = {\n    bots: start.map(\n        (pos, i): Bot.Bot =>\n            Bot.newBot({\n                pos: pos,\n                target: t => {\n                    if (t > 0.9999) return end[i];\n                },\n                weight: 0.01\n            })\n    )\n};\n\nconst example: { title: string; world: World.World } = {\n    title: \"Big cube\",\n    world: world\n};\n\nexport default example;\n","import { Vec3, Bot, World } from \"../core\";\n\nconst start: Vec3.Vec3[] = [\n    [-0.5, 0.5, -0.5],\n    [0.5, 0.5, -0.5],\n    [0.5, 0.5, 0.5],\n    [-0.5, 0.5, 0.5],\n    [-0.5, 1.5, -0.5],\n    [0.5, 1.5, -0.5],\n    [0.5, 1.5, 0.5],\n    [-0.5, 1.5, 0.5],\n    [-0.5, 2.5, -0.5],\n    [0.5, 2.5, -0.5],\n    [0.5, 2.5, 0.5],\n    [-0.5, 2.5, 0.5],\n    [-0.5, 3.5, -0.5],\n    [0.5, 3.5, -0.5],\n    [0.5, 3.5, 0.5],\n    [-0.5, 3.5, 0.5]\n];\nconst end: Vec3.Vec3[] = [\n    [-1.5, 0.5, -1.5],\n    [-0.5, 0.5, -1.5],\n    [0.5, 0.5, -1.5],\n    [1.5, 0.5, -1.5],\n    [-1.5, 0.5, -0.5],\n    [-0.5, 0.5, -0.5],\n    [0.5, 0.5, -0.5],\n    [1.5, 0.5, -0.5],\n    [-1.5, 0.5, 0.5],\n    [-0.5, 0.5, 0.5],\n    [0.5, 0.5, 0.5],\n    [1.5, 0.5, 0.5],\n    [-1.5, 0.5, 1.5],\n    [-0.5, 0.5, 1.5],\n    [0.5, 0.5, 1.5],\n    [1.5, 0.5, 1.5]\n];\n\nconst world: World.World = {\n    bots: start.map(\n        (pos, i): Bot.Bot =>\n            Bot.newBot({\n                pos: pos,\n                target: t => {\n                    if (t > 0.9999) return end[i];\n                },\n                weight: 0.01\n            })\n    )\n};\n\nconst example: { title: string; world: World.World } = {\n    title: \"Cube\",\n    world: world\n};\n\nexport default example;\n","import { Bot, World } from \"../core\";\n\nconst world: World.World = {\n    bots: [\n        ...[...Array(5)].map(\n            (_, i): Bot.Bot =>\n                Bot.newBot({\n                    pos: [i, 0.5, 0],\n                    target: t => {\n                        if (t > 0.9999) return [0, 0.5 + i, 0];\n                    },\n                    weight: 0.1\n                })\n        )\n    ]\n};\n\nconst example: { title: string; world: World.World } = {\n    title: \"Stack\",\n    world: world\n};\n\nexport default example;\n","import { Vec3, Bot, World } from \"../core\";\n\nconst start: Vec3.Vec3[] = [\n    [2, 0.5, 0],\n    [2, 1.5, 0],\n    [2, 2.5, 0],\n    [2, 3.5, 0],\n    [2, 4.5, 0],\n    [-2, 0.5, 0],\n    [-2, 1.5, 0],\n    [-2, 2.5, 0],\n    [-2, 3.5, 0],\n    [-2, 4.5, 0],\n    [2, 5.5, 0]\n];\nconst end: Vec3.Vec3[] = [\n    [2, 0.5, 0],\n    [2, 1.5, 0],\n    [2, 2.5, 0],\n    [2, 3.5, 0],\n    [2, 4.5, 0],\n    [-2, 0.5, 0],\n    [-2, 1.5, 0],\n    [-2, 2.5, 0],\n    [-2, 3.5, 0],\n    [-2, 4.5, 0],\n    [-2, 5.5, 0]\n];\n\nconst world: World.World = {\n    bots: start.map(\n        (pos, i): Bot.Bot =>\n            Bot.newBot({\n                pos: pos,\n                target: t => {\n                    if (t > 0.9999) return end[i];\n                },\n                weight: 0.02\n            })\n    )\n};\n\nconst example: { title: string; world: World.World } = {\n    title: \"Towers\",\n    world: world\n};\n\nexport default example;\n","import { Bot, World } from \"../core\";\nimport arc from \"./arc\";\nimport bigArc from \"./bigArc\";\nimport bigCube from \"./bigCube\";\nimport cube from \"./cube\";\nimport stack from \"./stack\";\nimport towers from \"./towers\";\nimport targets from \"./targets\";\n\nexport const examples = [stack, towers, targets, arc, bigArc, cube, bigCube].sort((a, b) => {\n    const d = a.world.bots.length - b.world.bots.length;\n    if (d === 0) return a.title > b.title ? 1 : -1;\n    return d;\n});\n\nexport default (index: number): [World.World, World.World] => [\n    examples[index].world,\n    World.setBots(\n        examples[index].world.bots.map((bot: Bot.Bot) => {\n            return {\n                pos: bot.target !== undefined ? bot.target(1) || bot.pos : bot.pos,\n                target: bot.target,\n                weight: bot.weight\n            };\n        })\n    )(World.newWorld())\n];\n","import { Bot, World } from \"../core\";\n\nconst world: World.World = {\n    bots: [\n        ...[...Array(9)].map((_, i): Bot.Bot => Bot.newBot({ pos: [i, 0.5, 0], weight: 0.001 })),\n        Bot.newBot({\n            pos: [4.5, 0.5, 4],\n            target: t => {\n                if (Math.abs(t - 0.4) < 0.03) return [1, 3.5, 1];\n                if (Math.abs(t - 0.6) < 0.03) return [-1, 3.5, 1];\n                if (Math.abs(t - 0.8) < 0.03) return [-1, 3.5, -1];\n                if (Math.abs(t - 1) < 0.03) return [1, 3.5, -1];\n            }\n        })\n    ]\n};\n\nconst example: { title: string; world: World.World } = {\n    title: \"Targets\",\n    world: world\n};\n\nexport default example;\n","import React, { FC, useEffect, useRef, useState } from \"react\";\nimport { PerspectiveCamera, WebGLRenderer, Color, Mesh } from \"three\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\nimport { Grid, Paper, makeStyles, List, ListItem, Button } from \"@material-ui/core\";\nimport { useWindowSize } from \"@react-hook/window-size\";\nimport { Vec3, World, Animation } from \"./core\";\nimport { newScene, newSphere, newCylinder, updateCylinder } from \"./draw\";\nimport Prando from \"prando\";\nimport loadExample, { examples } from \"./examples\";\n\nconst useStyles = makeStyles(theme => ({\n    gridItem: {\n        padding: theme.spacing(2),\n        textAlign: \"center\"\n    }\n}));\n\nconst saveImage = () => {\n    const canvas = document.getElementsByTagName(\"canvas\")[0];\n    const image = canvas.toDataURL(\"image/png\");\n    const a = document.createElement(\"a\");\n    a.href = image.replace(/^data:image\\/[^;]/, \"data:application/octet-stream\");\n    a.download = \"image.png\";\n    a.click();\n};\n\nconst App: FC = () => {\n    const [windowWidth, windowHeight] = useWindowSize();\n    const width = windowWidth * 0.55;\n    const height = windowHeight * 0.9;\n    const fov = 75;\n    const classes = useStyles();\n    const mount = useRef<HTMLDivElement>(null);\n    const [controls, setControls] = useState<OrbitControls>();\n    const [camera, setCamera] = useState<PerspectiveCamera>();\n    const [renderer, setRenderer] = useState<WebGLRenderer>();\n    const [frame, setFrame] = useState(0);\n    const [time, setTime] = useState(0);\n    const [animate, setAnimate] = useState(false);\n    const [scene, setScene] = useState(newScene());\n    const [botMeshes, setBotMeshes] = useState<Mesh[]>([]);\n    const [groundEdgeMeshes, setGroundEdgeMeshes] = useState<Mesh[]>([]);\n    const [edgeMeshes, setEdgeMeshes] = useState<Mesh[][]>([]);\n    const [animation, setAnimation] = useState<World.World[]>([]);\n    const [worldStart, setWorldStart] = useState<World.World>(World.newWorld());\n    const [worldEnd, setWorldEnd] = useState<World.World>(World.newWorld());\n    const [selectedExample, setSelectedExample] = useState<number | undefined>(undefined);\n\n    const updateWorld = (time: number) => {\n        animation[time].bots.map((bot, i) => {\n            botMeshes[i].position.set(...bot.pos);\n        });\n        animation[time].bots.map((bot, i) => {\n            scene.remove(groundEdgeMeshes[i]);\n            const strength = World.edgeStrength(bot.pos[1] + 0.5);\n            if (strength < 0.01) return;\n            scene.add(groundEdgeMeshes[i]);\n            updateCylinder(\n                bot.pos,\n                Vec3.newVec3(bot.pos[0], 0, bot.pos[2]),\n                Math.sqrt(strength) * 0.3\n            )(groundEdgeMeshes[i]);\n        });\n        animation[time].bots.map((from, i) =>\n            animation[time].bots.map((to, j) => {\n                if (i >= j) return;\n                scene.remove(edgeMeshes[i][j]);\n                const strength = World.edgeStrength(Vec3.length(Vec3.sub(to.pos, from.pos)));\n                if (strength < 0.01) return;\n                scene.add(edgeMeshes[i][j]);\n                updateCylinder(from.pos, to.pos, Math.sqrt(strength) * 0.3)(edgeMeshes[i][j]);\n            })\n        );\n    };\n\n    useEffect(() => {\n        if (animation.length === 0) return;\n        setBotMeshes(\n            animation[0].bots.map(bot =>\n                newSphere(bot.pos, bot.target(1) === undefined ? new Color(0, 0, 1) : new Color(0, 1, 0))\n            )\n        );\n        setGroundEdgeMeshes(\n            animation[0].bots.map(bot =>\n                newCylinder(bot.pos, Vec3.newVec3(bot.pos[0], 0, bot.pos[2]), 1, new Color(1, 0, 0))\n            )\n        );\n        setEdgeMeshes(\n            animation[0].bots.map(a => animation[0].bots.map(b => newCylinder(a.pos, b.pos, 1, new Color(1, 0, 0))))\n        );\n    }, [animation]);\n\n    useEffect(() => {\n        const scn = newScene();\n        botMeshes.map(mesh => scn.add(mesh));\n        groundEdgeMeshes.map(mesh => scn.add(mesh));\n        edgeMeshes.map((row, i) =>\n            row.map((mesh, j) => {\n                if (i >= j) return;\n                scn.add(mesh);\n            })\n        );\n        setScene(scn);\n    }, [botMeshes, groundEdgeMeshes, edgeMeshes]);\n\n    useEffect(() => {\n        const mc = mount.current;\n        if (!mc) return;\n        // Camera\n        const cam = new PerspectiveCamera(fov, width / height, 0.1, 1000);\n        cam.position.set(10, 10, 10);\n        cam.lookAt(0, 0, 0);\n        setCamera(cam);\n        // Renderer\n        const ren = new WebGLRenderer({ antialias: true });\n        ren.setClearColor(\"#000000\");\n        ren.setSize(width, height);\n        mc.appendChild(ren.domElement);\n        setRenderer(ren);\n        // Controls\n        const ctrls = new OrbitControls(cam, ren.domElement);\n        ctrls.enableDamping = true;\n        ctrls.dampingFactor = 0.5;\n        setControls(ctrls);\n        // Animate\n        const t = window.setInterval(() => setFrame(frame => frame + 1), 1000 / 30);\n        return () => {\n            window.clearInterval(t);\n            mc.removeChild(ren.domElement);\n        };\n    }, [mount, width, height]);\n\n    useEffect(() => {\n        if (controls) controls.update();\n        if (renderer && camera && scene) renderer.render(scene, camera);\n    }, [controls, renderer, camera, frame, scene]);\n\n    useEffect(() => {\n        if (botMeshes.length === 0) return;\n        const pauseFrac = 0.1;\n        const pauseFrames = Math.round(pauseFrac * animation.length);\n        let t = time % (2 * (animation.length + pauseFrames));\n        if (t < pauseFrames) {\n            updateWorld(0);\n            return;\n        }\n        t -= pauseFrames;\n        if (t < animation.length) {\n            updateWorld(t);\n            return;\n        }\n        t -= animation.length;\n        if (t < pauseFrames) {\n            updateWorld(animation.length - 1);\n            return;\n        }\n        t -= pauseFrames;\n        updateWorld(animation.length - 1 - t);\n    }, [time, scene]);\n\n    useEffect(() => {\n        if (!animate) return;\n        const t = setInterval(() => setTime(time => time + 1), 10);\n        return () => clearInterval(t);\n    }, [animate]);\n\n    return (\n        <>\n            <Grid container item xs={11}>\n                <Grid\n                    item\n                    xs={4}\n                    style={{ height: window.innerHeight * 0.9, overflowX: \"hidden\", overflowY: \"scroll\" }}>\n                    <Grid container direction=\"column\">\n                        <b>Microbots</b>\n                        <Grid item className={classes.gridItem}>\n                            <Paper>\n                                <List>\n                                    <ListItem>\n                                        <b>Select an example</b>\n                                    </ListItem>\n                                </List>\n                                {examples.map((example, i) => (\n                                    <Button\n                                        key={i}\n                                        variant=\"contained\"\n                                        color={selectedExample === i ? \"primary\" : \"default\"}\n                                        onClick={() => {\n                                            const rng = new Prando(123);\n                                            const [ws, we] = loadExample(i);\n                                            console.log(ws, we);\n                                            const rand = () =>\n                                                Vec3.multiplyScalar(\n                                                    Vec3.newVec3(rng.next() - 0.5, rng.next() - 0.5, rng.next() - 0.5),\n                                                    0.0001\n                                                );\n                                            ws.bots.map(bot => (bot.pos = Vec3.add(bot.pos, rand())));\n                                            we.bots.map(bot => (bot.pos = Vec3.add(bot.pos, rand())));\n                                            setWorldStart(ws);\n                                            setWorldEnd(we);\n                                            setAnimation([ws, we]);\n                                            setAnimate(false);\n                                            setSelectedExample(i);\n                                        }}>\n                                        {example.title} ({example.world.bots.length} bots)\n                                    </Button>\n                                ))}\n                                <br />\n                                <br />\n                            </Paper>\n                        </Grid>\n                        <Grid item className={classes.gridItem}>\n                            <Paper>\n                                <List>\n                                    <ListItem>\n                                        <b>Compute the animation</b>\n                                    </ListItem>\n                                    <ListItem>\n                                        <Button\n                                            variant=\"contained\"\n                                            onClick={() => {\n                                                const t = Date.now();\n                                                setAnimation(Animation.createAnimation(worldStart, worldEnd, 8));\n                                                console.log((Date.now() - t) / 1000);\n                                                setAnimate(true);\n                                            }}>\n                                            Generate animation\n                                        </Button>\n                                    </ListItem>\n                                </List>\n                            </Paper>\n                        </Grid>\n                        <Grid item className={classes.gridItem}>\n                            <Paper>\n                                <List>\n                                    <ListItem>\n                                        <b>Extra options</b>\n                                    </ListItem>\n                                    <ListItem>\n                                        <Button variant=\"contained\" onClick={() => setTime(time + 1)}>\n                                            Time: {time}\n                                        </Button>\n                                    </ListItem>\n                                    <ListItem>\n                                        <Button variant=\"contained\" onClick={() => setAnimate(!animate)}>\n                                            Animate: {animate ? \"true\" : \"false\"}\n                                        </Button>\n                                    </ListItem>\n                                    <ListItem>\n                                        <Button variant=\"contained\" onClick={() => saveImage()}>\n                                            Save screenshot\n                                        </Button>\n                                    </ListItem>\n                                </List>\n                            </Paper>\n                        </Grid>\n                    </Grid>\n                </Grid>\n                <Grid item xs={5}>\n                    <div ref={mount} />\n                </Grid>\n            </Grid>\n        </>\n    );\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n);\n"],"sourceRoot":""}